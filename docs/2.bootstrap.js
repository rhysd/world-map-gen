(window.webpackJsonp=window.webpackJsonp||[]).push([[2],{1:function(t,n,e){"use strict";e.r(n);var r=e(2),i=e(30);class o{constructor(t){this.canvas=t,this.ctx=this.canvas.getContext("2d")}render(t){const n=window.devicePixelRatio||1,e=this.canvas.getBoundingClientRect();this.canvas.width=e.width*n,this.canvas.height=e.height*n,this.ctx.clearRect(0,0,this.canvas.width,this.canvas.height),this.ctx.beginPath();const r=t.width(),i=t.height(),o=this.canvas.width/r,s=this.canvas.height/i,c=o>s?s:o,u=new Map,d=new Map;for(let n=0;n<r;n++)for(let e=0;e<i;e++){const r=t.at(n,e),i=r.kind;let o=u.get(i);if(void 0===o&&void 0!==(o=r.color_code())&&u.set(i,o),this.ctx.fillStyle=o,this.ctx.fillRect(n*c,e*c,c,c),!d.has(i)){const t=r.legend();d.set(i,{text:t,color:o})}}return this.ctx.stroke(),{legends:d}}}var s=e(32);class c{constructor(t){this.canvas=t}render(t){const n=window.devicePixelRatio||1,e=this.canvas.getBoundingClientRect();this.canvas.width=e.width*n,this.canvas.height=e.height*n;const i=t.width(),o=t.height(),c=this.determineCellSize(i,o),u=new s.Point(this.canvas.width/2,c+198),d=new s.PixelView(this.canvas,u),a=new Map,h=new Map,l=new Map;let f=null;function w(t,n,e){const r=function(t,n){const e=h.get(t);if(void 0!==e)return e;let r=n.rgb_color();void 0===r&&(r=16777215);const i=(new s.CubeColor).getByHorizontalColor(r);return h.set(t,i),l.set(t,{text:n.legend(),color:n.color_code()}),i}(t,e),i=c+2*n,o=new s.CubeDimension(c,c,i);return new s.Cube(o,r,!1)}function g(t){const n=t.kind,e=t.altitude;if(l.has(n)||l.set(n,{text:t.legend(),color:t.color_code()}),n===r.b.Top)return null===f&&(f=w(n,e,t)),f;if(n===r.b.Town||n===r.b.Path)return w(n,e,t);const i=a.get(e);if(void 0!==i)return i;const o=w(n,e,t);return a.set(e,o),o}for(let n=0;n<i;n++)for(let e=0;e<o;e++){const r=g(t.at(n,e)),i=new s.Point3D(n*c,e*c,0);d.renderObject(r,i)}return{legends:l}}determineCellSize(t,n){const e=n+t,r=(this.canvas.height-200)/e*2,i=this.canvas.width/e*2/Math.sqrt(3);let o=Math.floor(r>i?i:r);return o%2==1&&o--,o>6?o:6}}(new class{constructor(){this.generator=r.a.new(),this.currentBoard=null,this.screen=null;const t=document.getElementById("dimension-selector"),n=t[t.selectedIndex];this.dim=n.value,t.addEventListener("change",this.onVisualizationChange.bind(this)),this.widthInput=document.getElementById("width-input"),this.heightInput=document.getElementById("height-input"),this.screenRoot=document.getElementById("screen-root"),this.initRenderer(),this.paintButton=document.getElementById("paint-button"),this.paintButton.addEventListener("click",()=>{this.render()}),this.legends=document.getElementById("legends"),this.downloadJSONButton=document.getElementById("download-json-button"),this.downloadJSONButton.addEventListener("click",this.onDownloadJSON.bind(this)),this.downloadPNGButton=document.getElementById("download-png-button"),this.downloadPNGButton.addEventListener("click",this.onDownloadPNG.bind(this))}render(){this.paintButton.textContent="Painting...";for(const t of[this.paintButton,this.downloadJSONButton,this.downloadPNGButton])t.classList.add("disabled");window.setTimeout(()=>{const t=Date.now(),[n,e]=this.getSize(),r=this.generator.gen_auto(n,e),i=this.renderer.render(r);this.legends.innerHTML="";const o=Array.from(i.legends.keys());o.sort();for(const t of o){const n=i.legends.get(t),e=document.createElement("div");e.className="legend";const r=document.createElement("div");r.className="legend-color",r.style.backgroundColor=n.color||"none",e.appendChild(r);const o=document.createElement("div");o.className="legend-name",o.textContent=n.text,e.appendChild(o),this.legends.appendChild(e)}this.currentBoard=r;for(const t of[this.paintButton,this.downloadJSONButton,this.downloadPNGButton])t.classList.remove("disabled");this.paintButton.textContent="Generate",console.log("Consumed:",Date.now()-t)},0)}getSize(){const t=parseInt(this.widthInput.value,10),n=parseInt(this.heightInput.value,10);if(!isNaN(t)&&!isNaN(n))return[t,n];if("3d"===this.dim)return[120,120];const e=this.screenRoot.getBoundingClientRect();if(isNaN(t)){if(isNaN(n)){const t=(e.height>e.width?e.height:e.width)/200;return[Math.floor(e.width/t),Math.floor(e.height/t)]}{const t=e.height/n;return[Math.floor(e.width/t),n]}}{const n=e.width/t;return[t,Math.floor(e.height/n)]}}initRenderer(){const t=this.screenRoot.firstChild;switch(null!==t&&this.screenRoot.removeChild(t),this.currentBoard=null,this.screen=document.createElement("canvas"),this.screen.className="screen",this.screenRoot.appendChild(this.screen),this.dim){case"2d":this.renderer=new o(this.screen);break;case"3d":this.renderer=new c(this.screen);break;default:throw new Error(`Unknown context ${this.dim}`)}}onDownloadJSON(t){if(null===this.currentBoard)return;const n=new Blob([this.currentBoard.as_json()],{type:"text/plain;charset=utf-8"});Object(i.saveAs)(n,"board.json")}onDownloadPNG(t){null!==this.screen&&this.screen.toBlob(t=>Object(i.saveAs)(t,"board.png"))}onVisualizationChange(t){const n=t.target,e=n[n.selectedIndex].value;this.dim!==e&&(this.dim=e,this.initRenderer(),this.render())}}).render()},2:function(t,n,e){"use strict";e.d(n,"b",function(){return l}),e.d(n,"g",function(){return p}),e.d(n,"c",function(){return m}),e.d(n,"j",function(){return b}),e.d(n,"d",function(){return B}),e.d(n,"e",function(){return N}),e.d(n,"f",function(){return y}),e.d(n,"i",function(){return C}),e.d(n,"h",function(){return x}),e.d(n,"k",function(){return E}),e.d(n,"l",function(){return k}),e.d(n,"n",function(){return O}),e.d(n,"a",function(){return P}),e.d(n,"m",function(){return M});var r=e(45);let i=new TextDecoder("utf-8"),o=null;function s(){return null!==o&&o.buffer===r.t.buffer||(o=new Uint8Array(r.t.buffer)),o}function c(t,n){return i.decode(s().subarray(t,t+n))}let u=null;function d(){return null===u&&(u=r.i()),u}let a=null;function h(){return null!==a&&a.buffer===r.t.buffer||(a=new Uint32Array(r.t.buffer)),a}const l=Object.freeze({Sea:0,Mountain:1,Forest:2,Plain:3,Town:4,Top:5,Highland:6,DeepSea:7,Path:8}),f=(Object.freeze({Low:0,Middle:1,High:2}),new Array(32));f.fill(void 0),f.push(void 0,null,!0,!1);let w=f.length;function g(t){w===f.length&&f.push(f.length+1);const n=w;return w=f[n],f[n]=t,n}function p(t,n){let e=c(t,n);return g(new Function(e))}function v(t){return f[t]}function m(t,n){return g(v(t).call(v(n)))}function b(t){return g(v(t).self)}function B(t){return g(v(t).crypto)}function N(t){return g(v(t).getRandomValues)}function _(t,n){return s().subarray(t/1,t/1+n)}function y(t,n,e){let r=_(n,e);v(t).getRandomValues(r)}function C(t,n){let r=c(t,n);return g(e(46)(r))}function x(t,n,e){let r=_(n,e);v(t).randomFillSync(r)}function E(t){return void 0===v(t)?1:0}function k(t,n){return v(t)===v(n)?1:0}function O(t,n){throw new Error(c(t,n))}class R{static __wrap(t){const n=Object.create(R.prototype);return n.ptr=t,n}free(){const t=this.ptr;this.ptr=0,function(t){r.a(t)}(t)}width(){return r.m(this.ptr)>>>0}height(){return r.l(this.ptr)>>>0}at(t,n){return I.__wrap(r.k(this.ptr,t,n))}as_json(){const t=d();r.j(t,this.ptr);const n=h(),e=n[t/4],i=n[t/4+1];if(0===e)return;const o=c(e,i).slice();return r.h(e,1*i),o}}class I{static __wrap(t){const n=Object.create(I.prototype);return n.ptr=t,n}free(){const t=this.ptr;this.ptr=0,function(t){r.b(t)}(t)}get kind(){return r.e(this.ptr)}set kind(t){return r.g(this.ptr,t)}get altitude(){return r.d(this.ptr)}set altitude(t){return r.f(this.ptr,t)}color_code(){const t=d();r.n(t,this.ptr);const n=h(),e=n[t/4],i=n[t/4+1];if(0===e)return;const o=c(e,i).slice();return r.h(e,1*i),o}rgb_color(){const t=d();r.p(t,this.ptr);const n=h()[t/4],e=h()[t/4+1];return 0===n?void 0:e}legend(){const t=d();r.o(t,this.ptr);const n=h(),e=n[t/4],i=n[t/4+1],o=c(e,i).slice();return r.h(e,1*i),o}}class P{static __wrap(t){const n=Object.create(P.prototype);return n.ptr=t,n}free(){const t=this.ptr;this.ptr=0,function(t){r.c(t)}(t)}static new(){return P.__wrap(r.s())}gen_auto(t,n){return R.__wrap(r.r(this.ptr,t,n))}gen(t,n,e){return R.__wrap(r.q(this.ptr,t,n,e))}}function M(t){var n;(n=t)<36||(f[n]=w,w=n)}},45:function(t,n,e){"use strict";var r=e.w[t.i];t.exports=r;e(2);r.u()},46:function(t,n){function e(t){var n=new Error("Cannot find module '"+t+"'");throw n.code="MODULE_NOT_FOUND",n}e.keys=function(){return[]},e.resolve=e,t.exports=e,e.id=46}}]);
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIndlYnBhY2s6Ly8vLi8yZC50cyIsIndlYnBhY2s6Ly8vLi8zZC50cyIsIndlYnBhY2s6Ly8vLi9pbmRleC50cyIsIndlYnBhY2s6Ly8vLi4vcGtnL3dvcmxkX21hcF9nZW4uanMiLCJ3ZWJwYWNrOi8vLy4uL3BrZyBzeW5jIl0sIm5hbWVzIjpbIlJlbmRlcmVyMkQiLCJbb2JqZWN0IE9iamVjdF0iLCJjYW52YXMiLCJ0aGlzIiwiY3R4IiwiZ2V0Q29udGV4dCIsImJvYXJkIiwiZHByIiwid2luZG93IiwiZGV2aWNlUGl4ZWxSYXRpbyIsInJlY3QiLCJnZXRCb3VuZGluZ0NsaWVudFJlY3QiLCJ3aWR0aCIsImhlaWdodCIsImNsZWFyUmVjdCIsImJlZ2luUGF0aCIsImNlbGxXaWR0aCIsImNlbGxIZWlnaHQiLCJjZWxsU2l6ZSIsImNvbG9ycyIsIk1hcCIsImxlZ2VuZHMiLCJ4IiwieSIsImNlbGwiLCJhdCIsImtpbmQiLCJjb2xvciIsImdldCIsInVuZGVmaW5lZCIsImNvbG9yX2NvZGUiLCJzZXQiLCJmaWxsU3R5bGUiLCJmaWxsUmVjdCIsImhhcyIsInRleHQiLCJsZWdlbmQiLCJzdHJva2UiLCJfM2RfUmVuZGVyZXIzRCIsImRldGVybWluZUNlbGxTaXplIiwicG9pbnQiLCJvYmVsaXNrIiwicGl4ZWxWaWV3IiwiY2FjaGUiLCJ0b3BDdWJlIiwiY2FsY0N1YmUiLCJhbHQiLCJjYWNoZWQiLCJyZ2IiLCJyZ2JfY29sb3IiLCJnZXRCeUhvcml6b250YWxDb2xvciIsImtpbmRDb2xvciIsInoiLCJkaW0iLCJjdWJlQXQiLCJhbHRpdHVkZSIsIndvcmxkX21hcF9nZW4iLCJUb3AiLCJUb3duIiwiUGF0aCIsImN1YmUiLCJwdCIsInJlbmRlck9iamVjdCIsImJvdGgiLCJmcm9tSGVpZ2h0IiwiZnJvbVdpZHRoIiwiTWF0aCIsInNxcnQiLCJmbG9vciIsImdlbmVyYXRvciIsIm5ldyIsImN1cnJlbnRCb2FyZCIsInNjcmVlbiIsInNlbGVjdG9yIiwiZG9jdW1lbnQiLCJnZXRFbGVtZW50QnlJZCIsIm9wdGlvbiIsInNlbGVjdGVkSW5kZXgiLCJ2YWx1ZSIsImFkZEV2ZW50TGlzdGVuZXIiLCJvblZpc3VhbGl6YXRpb25DaGFuZ2UiLCJiaW5kIiwid2lkdGhJbnB1dCIsImhlaWdodElucHV0Iiwic2NyZWVuUm9vdCIsImluaXRSZW5kZXJlciIsInBhaW50QnV0dG9uIiwicmVuZGVyIiwiZG93bmxvYWRKU09OQnV0dG9uIiwib25Eb3dubG9hZEpTT04iLCJkb3dubG9hZFBOR0J1dHRvbiIsIm9uRG93bmxvYWRQTkciLCJ0ZXh0Q29udGVudCIsImJ0biIsImNsYXNzTGlzdCIsImFkZCIsInNldFRpbWVvdXQiLCJzdGFydCIsIkRhdGUiLCJub3ciLCJnZXRTaXplIiwiZ2VuX2F1dG8iLCJyZW5kZXJlZCIsInJlbmRlcmVyIiwiaW5uZXJIVE1MIiwibmFtZXMiLCJBcnJheSIsImZyb20iLCJrZXlzIiwic29ydCIsIm5hbWUiLCJpdGVtIiwiY3JlYXRlRWxlbWVudCIsImNsYXNzTmFtZSIsInN0eWxlIiwiYmFja2dyb3VuZENvbG9yIiwiYXBwZW5kQ2hpbGQiLCJsYWJlbCIsInJlbW92ZSIsImNvbnNvbGUiLCJsb2ciLCJwYXJzZUludCIsImlzTmFOIiwiY2VsbFBpeCIsInByZXYiLCJmaXJzdENoaWxkIiwicmVtb3ZlQ2hpbGQiLCJFcnJvciIsIl8iLCJibG9iIiwiQmxvYiIsImFzX2pzb24iLCJ0eXBlIiwiT2JqZWN0IiwiRmlsZVNhdmVyX21pbiIsInRvQmxvYiIsImIiLCJldmVudCIsInRhcmdldCIsIl9fd2VicGFja19yZXF1aXJlX18iLCJkIiwiX193ZWJwYWNrX2V4cG9ydHNfXyIsIkxhbmRLaW5kIiwiX193YmdfbmV3XzNhNzQ2ZjI2MTk3MDVhZGQiLCJfX3diZ19jYWxsX2Y1NGQzYTZkYWRiMTk5Y2EiLCJfX3diZ19zZWxmX2FjMzc5ZTc4MGEwZDhiOTQiLCJfX3diZ19jcnlwdG9fMWU0MzAyYjg1ZDRmNjRhMiIsIl9fd2JnX2dldFJhbmRvbVZhbHVlc18xYjRiYTE0NDE2MmE1YzllIiwiX193YmdfZ2V0UmFuZG9tVmFsdWVzXzFlZjExZTg4OGU1MjI4ZTkiLCJfX3diZ19yZXF1aXJlXzY0NjFiMWU5YTBkN2MzNGEiLCJfX3diZ19yYW5kb21GaWxsU3luY18xYjUyYzg0ODIzNzRjNTViIiwiX193YmluZGdlbl9pc191bmRlZmluZWQiLCJfX3diaW5kZ2VuX2pzdmFsX2VxIiwiX193YmluZGdlbl90aHJvdyIsIkdlbmVyYXRvciIsIl9fd2JpbmRnZW5fb2JqZWN0X2Ryb3BfcmVmIiwiX3dvcmxkX21hcF9nZW5fYmdfX1dFQlBBQ0tfSU1QT1JURURfTU9EVUxFXzBfXyIsImNhY2hlZFRleHREZWNvZGVyIiwiVGV4dERlY29kZXIiLCJjYWNoZWdldFVpbnQ4TWVtb3J5IiwiZ2V0VWludDhNZW1vcnkiLCJidWZmZXIiLCJVaW50OEFycmF5IiwiZ2V0U3RyaW5nRnJvbVdhc20iLCJwdHIiLCJsZW4iLCJkZWNvZGUiLCJzdWJhcnJheSIsImNhY2hlZEdsb2JhbEFyZ3VtZW50UHRyIiwiZ2xvYmFsQXJndW1lbnRQdHIiLCJjYWNoZWdldFVpbnQzMk1lbW9yeSIsImdldFVpbnQzMk1lbW9yeSIsIlVpbnQzMkFycmF5IiwiZnJlZXplIiwiU2VhIiwiTW91bnRhaW4iLCJGb3Jlc3QiLCJQbGFpbiIsIkhpZ2hsYW5kIiwiRGVlcFNlYSIsImhlYXAiLCJMb3ciLCJNaWRkbGUiLCJIaWdoIiwiZmlsbCIsInB1c2giLCJoZWFwX25leHQiLCJsZW5ndGgiLCJhZGRIZWFwT2JqZWN0Iiwib2JqIiwiaWR4IiwiYXJnMCIsImFyZzEiLCJ2YXJnMCIsIkZ1bmN0aW9uIiwiZ2V0T2JqZWN0IiwiY2FsbCIsInNlbGYiLCJjcnlwdG8iLCJnZXRSYW5kb21WYWx1ZXMiLCJnZXRBcnJheVU4RnJvbVdhc20iLCJhcmcyIiwidmFyZzEiLCJyYW5kb21GaWxsU3luYyIsImkiLCJhIiwiQm9hcmQiLCJjcmVhdGUiLCJwcm90b3R5cGUiLCJmcmVlQm9hcmQiLCJDZWxsIiwiX193cmFwIiwicmV0cHRyIiwibWVtIiwicnVzdHB0ciIsInJ1c3RsZW4iLCJyZWFsUmV0Iiwic2xpY2UiLCJmcmVlQ2VsbCIsInByZXNlbnQiLCJmcmVlR2VuZXJhdG9yIiwicmVzIiwid2VicGFja0VtcHR5Q29udGV4dCIsInJlcSIsImUiLCJjb2RlIiwicmVzb2x2ZSIsIm1vZHVsZSIsImV4cG9ydHMiLCJpZCJdLCJtYXBwaW5ncyI6ImtIQUdlLE1BQU1BLEVBSWpCQyxZQUFZQyxHQUNSQyxLQUFLRCxPQUFTQSxFQUNkQyxLQUFLQyxJQUFNRCxLQUFLRCxPQUFPRyxXQUFXLE1BRy9CSixPQUFPSyxHQUNWLE1BQU1DLEVBQU1DLE9BQU9DLGtCQUFvQixFQUNqQ0MsRUFBT1AsS0FBS0QsT0FBT1Msd0JBQ3pCUixLQUFLRCxPQUFPVSxNQUFRRixFQUFLRSxNQUFRTCxFQUNqQ0osS0FBS0QsT0FBT1csT0FBU0gsRUFBS0csT0FBU04sRUFHbkNKLEtBQUtDLElBQUlVLFVBQVUsRUFBRyxFQUFHWCxLQUFLRCxPQUFPVSxNQUFPVCxLQUFLRCxPQUFPVyxRQUV4RFYsS0FBS0MsSUFBSVcsWUFFVCxNQUFNSCxFQUFRTixFQUFNTSxRQUNkQyxFQUFTUCxFQUFNTyxTQUNmRyxFQUFZYixLQUFLRCxPQUFPVSxNQUFRQSxFQUNoQ0ssRUFBYWQsS0FBS0QsT0FBT1csT0FBU0EsRUFDbENLLEVBQVdGLEVBQVlDLEVBQWFBLEVBQWFELEVBRWpERyxFQUFTLElBQUlDLElBQ2JDLEVBQVUsSUFBSUQsSUFDcEIsSUFBSyxJQUFJRSxFQUFJLEVBQUdBLEVBQUlWLEVBQU9VLElBQ3ZCLElBQUssSUFBSUMsRUFBSSxFQUFHQSxFQUFJVixFQUFRVSxJQUFLLENBQzdCLE1BQU1DLEVBQU9sQixFQUFNbUIsR0FBR0gsRUFBR0MsR0FDbkJHLEVBQU9GLEVBQUtFLEtBQ2xCLElBQUlDLEVBQVFSLEVBQU9TLElBQUlGLEdBU3ZCLFFBUmNHLElBQVZGLFFBRWNFLEtBRGRGLEVBQVFILEVBQUtNLGVBRVRYLEVBQU9ZLElBQUlMLEVBQU1DLEdBR3pCeEIsS0FB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QUFBLEtBRUEsTUFEQUMsRUFBQUMsS0FBQSxtQkFDQUQsRUFFQUYsRUFBQWxILEtBQUEsV0FBdUMsVUFDdkNrSCxFQUFBSSxRQUFBSixFQUNBSyxFQUFBQyxRQUFBTixFQUNBQSxFQUFBTyxHQUFBIiwiZmlsZSI6IjIuYm9vdHN0cmFwLmpzIiwic291cmNlc0NvbnRlbnQiOlsiaW1wb3J0IHsgQm9hcmQgfSBmcm9tICd3b3JsZC1tYXAtZ2VuJztcbmltcG9ydCB7IFJlbmRlcmVyLCBSZW5kZXJlZCwgTGVnZW5kIH0gZnJvbSAnLi9yZW5kZXJlcic7XG5cbmV4cG9ydCBkZWZhdWx0IGNsYXNzIFJlbmRlcmVyMkQgaW1wbGVtZW50cyBSZW5kZXJlciB7XG4gICAgcHJpdmF0ZSBjYW52YXM6IEhUTUxDYW52YXNFbGVtZW50O1xuICAgIHByaXZhdGUgY3R4OiBDYW52YXNSZW5kZXJpbmdDb250ZXh0MkQ7XG5cbiAgICBjb25zdHJ1Y3RvcihjYW52YXM6IEhUTUxDYW52YXNFbGVtZW50KSB7XG4gICAgICAgIHRoaXMuY2FudmFzID0gY2FudmFzO1xuICAgICAgICB0aGlzLmN0eCA9IHRoaXMuY2FudmFzLmdldENvbnRleHQoJzJkJykhO1xuICAgIH1cblxuICAgIHB1YmxpYyByZW5kZXIoYm9hcmQ6IEJvYXJkKTogUmVuZGVyZWQge1xuICAgICAgICBjb25zdCBkcHIgPSB3aW5kb3cuZGV2aWNlUGl4ZWxSYXRpbyB8fCAxO1xuICAgICAgICBjb25zdCByZWN0ID0gdGhpcy5jYW52YXMuZ2V0Qm91bmRpbmdDbGllbnRSZWN0KCk7XG4gICAgICAgIHRoaXMuY2FudmFzLndpZHRoID0gcmVjdC53aWR0aCAqIGRwcjtcbiAgICAgICAgdGhpcy5jYW52YXMuaGVpZ2h0ID0gcmVjdC5oZWlnaHQgKiBkcHI7XG5cbiAgICAgICAgLy8gQ2xlYXIgYXQgZmlyc3RcbiAgICAgICAgdGhpcy5jdHguY2xlYXJSZWN0KDAsIDAsIHRoaXMuY2FudmFzLndpZHRoLCB0aGlzLmNhbnZhcy5oZWlnaHQpO1xuXG4gICAgICAgIHRoaXMuY3R4LmJlZ2luUGF0aCgpO1xuXG4gICAgICAgIGNvbnN0IHdpZHRoID0gYm9hcmQud2lkdGgoKTtcbiAgICAgICAgY29uc3QgaGVpZ2h0ID0gYm9hcmQuaGVpZ2h0KCk7XG4gICAgICAgIGNvbnN0IGNlbGxXaWR0aCA9IHRoaXMuY2FudmFzLndpZHRoIC8gd2lkdGg7XG4gICAgICAgIGNvbnN0IGNlbGxIZWlnaHQgPSB0aGlzLmNhbnZhcy5oZWlnaHQgLyBoZWlnaHQ7XG4gICAgICAgIGNvbnN0IGNlbGxTaXplID0gY2VsbFdpZHRoID4gY2VsbEhlaWdodCA/IGNlbGxIZWlnaHQgOiBjZWxsV2lkdGg7XG5cbiAgICAgICAgY29uc3QgY29sb3JzID0gbmV3IE1hcDxudW1iZXIsIHN0cmluZz4oKTtcbiAgICAgICAgY29uc3QgbGVnZW5kcyA9IG5ldyBNYXA8bnVtYmVyLCBMZWdlbmQ+KCk7XG4gICAgICAgIGZvciAobGV0IHggPSAwOyB4IDwgd2lkdGg7IHgrKykge1xuICAgICAgICAgICAgZm9yIChsZXQgeSA9IDA7IHkgPCBoZWlnaHQ7IHkrKykge1xuICAgICAgICAgICAgICAgIGNvbnN0IGNlbGwgPSBib2FyZC5hdCh4LCB5KTtcbiAgICAgICAgICAgICAgICBjb25zdCBraW5kID0gY2VsbC5raW5kO1xuICAgICAgICAgICAgICAgIGxldCBjb2xvciA9IGNvbG9ycy5nZXQoa2luZCk7XG4gICAgICAgICAgICAgICAgaWYgKGNvbG9yID09PSB1bmRlZmluZWQpIHtcbiAgICAgICAgICAgICAgICAgICAgY29sb3IgPSBjZWxsLmNvbG9yX2NvZGUoKTtcbiAgICAgICAgICAgICAgICAgICAgaWYgKGNvbG9yICE9PSB1bmRlZmluZWQpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIGNvbG9ycy5zZXQoa2luZCwgY29sb3IpO1xuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIHRoaXMuY3R4LmZpbGxTdHlsZSA9IGNvbG9yO1xuICAgICAgICAgICAgICAgIHRoaXMuY3R4LmZpbGxSZWN0KHggKiBjZWxsU2l6ZSwgeSAqIGNlbGxTaXplLCBjZWxsU2l6ZSwgY2VsbFNpemUpO1xuICAgICAgICAgICAgICAgIGlmICghbGVnZW5kcy5oYXMoa2luZCkpIHtcbiAgICAgICAgICAgICAgICAgICAgY29uc3QgdGV4dCA9IGNlbGwubGVnZW5kKCk7XG4gICAgICAgICAgICAgICAgICAgIGxlZ2VuZHMuc2V0KGtpbmQsIHsgdGV4dCwgY29sb3IgfSk7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfVxuICAgICAgICB9XG5cbiAgICAgICAgdGhpcy5jdHguc3Ryb2tlKCk7XG5cbiAgICAgICAgcmV0dXJuIHsgbGVnZW5kcyB9O1xuICAgIH1cbn1cbiIsImltcG9ydCB7IFBvaW50M0QsIFBvaW50LCBDdWJlRGltZW5zaW9uLCBDdWJlQ29sb3IsIEN1YmUsIFBpeGVsVmlldyB9IGZyb20gJ29iZWxpc2suanMnO1xuaW1wb3J0IHsgTGFuZEtpbmQsIEJvYXJkLCBDZWxsIH0gZnJvbSAnd29ybGQtbWFwLWdlbic7XG5pbXBvcnQgeyBSZW5kZXJlciwgUmVuZGVyZWQsIExlZ2VuZCB9IGZyb20gJy4vcmVuZGVyZXInO1xuXG5leHBvcnQgZGVmYXVsdCBjbGFzcyBSZW5kZXJlcjNEIGltcGxlbWVudHMgUmVuZGVyZXIge1xuICAgIHByaXZhdGUgY2FudmFzOiBIVE1MQ2FudmFzRWxlbWVudDtcblxuICAgIGNvbnN0cnVjdG9yKGNhbnZhczogSFRNTENhbnZhc0VsZW1lbnQpIHtcbiAgICAgICAgdGhpcy5jYW52YXMgPSBjYW52YXM7XG4gICAgfVxuXG4gICAgcHVibGljIHJlbmRlcihib2FyZDogQm9hcmQpOiBSZW5kZXJlZCB7XG4gICAgICAgIGNvbnN0IGRwciA9IHdpbmRvdy5kZXZpY2VQaXhlbFJhdGlvIHx8IDE7XG4gICAgICAgIGNvbnN0IHJlY3QgPSB0aGlzLmNhbnZhcy5nZXRCb3VuZGluZ0NsaWVudFJlY3QoKTtcbiAgICAgICAgdGhpcy5jYW52YXMud2lkdGggPSByZWN0LndpZHRoICogZHByO1xuICAgICAgICB0aGlzLmNhbnZhcy5oZWlnaHQgPSByZWN0LmhlaWdodCAqIGRwcjtcblxuICAgICAgICBjb25zdCB3aWR0aCA9IGJvYXJkLndpZHRoKCk7XG4gICAgICAgIGNvbnN0IGhlaWdodCA9IGJvYXJkLmhlaWdodCgpO1xuICAgICAgICBjb25zdCBjZWxsU2l6ZSA9IHRoaXMuZGV0ZXJtaW5lQ2VsbFNpemUod2lkdGgsIGhlaWdodCk7XG5cbiAgICAgICAgY29uc3QgcG9pbnQgPSBuZXcgUG9pbnQodGhpcy5jYW52YXMud2lkdGggLyAyLCBjZWxsU2l6ZSArIDk5ICogMik7XG4gICAgICAgIGNvbnN0IHBpeGVsVmlldyA9IG5ldyBQaXhlbFZpZXcodGhpcy5jYW52YXMsIHBvaW50KTtcblxuICAgICAgICBjb25zdCBjYWNoZSA9IG5ldyBNYXA8bnVtYmVyLCBDdWJlPigpOyAvLyBBbHRpdHVkZSAtPiBDdWJlXG4gICAgICAgIGNvbnN0IGNvbG9ycyA9IG5ldyBNYXA8bnVtYmVyLCBDdWJlQ29sb3I+KCk7IC8vIGtpbmQgLT4gQ3ViZUNvbG9yXG4gICAgICAgIGNvbnN0IGxlZ2VuZHMgPSBuZXcgTWFwPG51bWJlciwgTGVnZW5kPigpOyAvLyBraW5kIC0+IExlZ2VuZFxuICAgICAgICBsZXQgdG9wQ3ViZTogQ3ViZSB8IG51bGwgPSBudWxsO1xuXG4gICAgICAgIGZ1bmN0aW9uIGtpbmRDb2xvcihraW5kOiBMYW5kS2luZCwgY2VsbDogQ2VsbCk6IEN1YmVDb2xvciB7XG4gICAgICAgICAgICBjb25zdCBjYWNoZWQgPSBjb2xvcnMuZ2V0KGtpbmQpO1xuICAgICAgICAgICAgaWYgKGNhY2hlZCAhPT0gdW5kZWZpbmVkKSB7XG4gICAgICAgICAgICAgICAgcmV0dXJuIGNhY2hlZDtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGxldCByZ2IgPSBjZWxsLnJnYl9jb2xvcigpO1xuICAgICAgICAgICAgaWYgKHJnYiA9PT0gdW5kZWZpbmVkKSB7XG4gICAgICAgICAgICAgICAgcmdiID0gMHhmZmZmZmY7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBjb25zdCBjb2xvciA9IG5ldyBDdWJlQ29sb3IoKS5nZXRCeUhvcml6b250YWxDb2xvcihyZ2IpO1xuICAgICAgICAgICAgY29sb3JzLnNldChraW5kLCBjb2xvcik7XG5cbiAgICAgICAgICAgIC8vIFJlbWVtYmVyIGxlZ2VuZCBvZiB0aGUga2luZCBhbHNvXG4gICAgICAgICAgICBsZWdlbmRzLnNldChraW5kLCB7IHRleHQ6IGNlbGwubGVnZW5kKCksIGNvbG9yOiBjZWxsLmNvbG9yX2NvZGUoKSB9KTtcblxuICAgICAgICAgICAgcmV0dXJuIGNvbG9yO1xuICAgICAgICB9XG5cbiAgICAgICAgZnVuY3Rpb24gY2FsY0N1YmUoa2luZDogTGFuZEtpbmQsIGFsdDogbnVtYmVyLCBjZWxsOiBDZWxsKTogQ3ViZSB7XG4gICAgICAgICAgICBjb25zdCBjb2xvciA9IGtpbmRDb2xvcihraW5kLCBjZWxsKTtcbiAgICAgICAgICAgIGNvbnN0IHogPSBjZWxsU2l6ZSArIGFsdCAqIDI7XG4gICAgICAgICAgICBjb25zdCBkaW0gPSBuZXcgQ3ViZURpbWVuc2lvbihjZWxsU2l6ZSwgY2VsbFNpemUsIHopO1xuICAgICAgICAgICAgcmV0dXJuIG5ldyBDdWJlKGRpbSwgY29sb3IsIC8qYm9yZGVyOiovIGZhbHNlKTtcbiAgICAgICAgfVxuXG4gICAgICAgIGZ1bmN0aW9uIGN1YmVBdChjZWxsOiBDZWxsKTogQ3ViZSB7XG4gICAgICAgICAgICBjb25zdCBraW5kID0gY2VsbC5raW5kO1xuICAgICAgICAgICAgY29uc3QgYWx0ID0gY2VsbC5hbHRpdHVkZTtcblxuICAgICAgICAgICAgaWYgKCFsZWdlbmRzLmhhcyhraW5kKSkge1xuICAgICAgICAgICAgICAgIC8vIFJlbWVtYmVyIGxlZ2VuZCBvZiB0aGUga2luZCBhbHNvXG4gICAgICAgICAgICAgICAgbGVnZW5kcy5zZXQoa2luZCwgeyB0ZXh0OiBjZWxsLmxlZ2VuZCgpLCBjb2xvcjogY2VsbC5jb2xvcl9jb2RlKCkgfSk7XG4gICAgICAgICAgICB9XG5cbiAgICAgICAgICAgIGlmIChraW5kID09PSBMYW5kS2luZC5Ub3ApIHtcbiAgICAgICAgICAgICAgICBpZiAodG9wQ3ViZSA9PT0gbnVsbCkge1xuICAgICAgICAgICAgICAgICAgICB0b3BDdWJlID0gY2FsY0N1YmUoa2luZCwgYWx0LCBjZWxsKTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgcmV0dXJuIHRvcEN1YmU7XG4gICAgICAgICAgICB9XG5cbiAgICAgICAgICAgIGlmIChraW5kID09PSBMYW5kS2luZC5Ub3duIHx8IGtpbmQgPT09IExhbmRLaW5kLlBhdGgpIHtcbiAgICAgICAgICAgICAgICByZXR1cm4gY2FsY0N1YmUoa2luZCwgYWx0LCBjZWxsKTtcbiAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgY29uc3QgY2FjaGVkID0gY2FjaGUuZ2V0KGFsdCk7XG4gICAgICAgICAgICBpZiAoY2FjaGVkICE9PSB1bmRlZmluZWQpIHtcbiAgICAgICAgICAgICAgICByZXR1cm4gY2FjaGVkO1xuICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICBjb25zdCBjdWJlID0gY2FsY0N1YmUoa2luZCwgYWx0LCBjZWxsKTtcbiAgICAgICAgICAgIGNhY2hlLnNldChhbHQsIGN1YmUpO1xuICAgICAgICAgICAgcmV0dXJuIGN1YmU7XG4gICAgICAgIH1cblxuICAgICAgICBmb3IgKGxldCB4ID0gMDsgeCA8IHdpZHRoOyB4KyspIHtcbiAgICAgICAgICAgIGZvciAobGV0IHkgPSAwOyB5IDwgaGVpZ2h0OyB5KyspIHtcbiAgICAgICAgICAgICAgICBjb25zdCBjdWJlID0gY3ViZUF0KGJvYXJkLmF0KHgsIHkpKTtcbiAgICAgICAgICAgICAgICBjb25zdCBwdCA9IG5ldyBQb2ludDNEKHggKiBjZWxsU2l6ZSwgeSAqIGNlbGxTaXplLCAwKTtcbiAgICAgICAgICAgICAgICBwaXhlbFZpZXcucmVuZGVyT2JqZWN0KGN1YmUsIHB0KTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuXG4gICAgICAgIHJldHVybiB7XG4gICAgICAgICAgICBsZWdlbmRzLFxuICAgICAgICB9O1xuICAgIH1cblxuICAgIHByaXZhdGUgZGV0ZXJtaW5lQ2VsbFNpemUod2lkdGg6IG51bWJlciwgaGVpZ2h0OiBudW1iZXIpIHtcbiAgICAgICAgY29uc3QgYm90aCA9IGhlaWdodCArIHdpZHRoO1xuICAgICAgICBjb25zdCBmcm9tSGVpZ2h0ID0gKCh0aGlzLmNhbnZhcy5oZWlnaHQgLSAyMDApIC8gYm90aCkgKiAyO1xuICAgICAgICBjb25zdCBmcm9tV2lkdGggPSAoKHRoaXMuY2FudmFzLndpZHRoIC8gYm90aCkgKiAyKSAvIE1hdGguc3FydCgzKTtcbiAgICAgICAgbGV0IGNlbGxTaXplID0gTWF0aC5mbG9vcihmcm9tSGVpZ2h0ID4gZnJvbVdpZHRoID8gZnJvbVdpZHRoIDogZnJvbUhlaWdodCk7XG4gICAgICAgIGlmIChjZWxsU2l6ZSAlIDIgPT09IDEpIHtcbiAgICAgICAgICAgIGNlbGxTaXplLS07XG4gICAgICAgIH1cbiAgICAgICAgcmV0dXJuIGNlbGxTaXplID4gNiA/IGNlbGxTaXplIDogNjtcbiAgICB9XG59XG4iLCJpbXBvcnQgeyBHZW5lcmF0b3IsIEJvYXJkIH0gZnJvbSAnd29ybGQtbWFwLWdlbic7XG5pbXBvcnQgeyBzYXZlQXMgfSBmcm9tICdmaWxlLXNhdmVyJztcbmltcG9ydCBSZW5kZXJlcjJEIGZyb20gJy4vMmQnO1xuaW1wb3J0IFJlbmRlcmVyM0QgZnJvbSAnLi8zZCc7XG5pbXBvcnQgeyBSZW5kZXJlciB9IGZyb20gJy4vcmVuZGVyZXInO1xuXG5jb25zdCBhcHAgPSBuZXcgY2xhc3Mge1xuICAgIHByaXZhdGUgZ2VuZXJhdG9yOiBHZW5lcmF0b3I7XG4gICAgcHJpdmF0ZSBkaW06IHN0cmluZztcbiAgICBwcml2YXRlIGN1cnJlbnRCb2FyZDogQm9hcmQgfCBudWxsO1xuICAgIHByaXZhdGUgd2lkdGhJbnB1dDogSFRNTElucHV0RWxlbWVudDtcbiAgICBwcml2YXRlIGhlaWdodElucHV0OiBIVE1MSW5wdXRFbGVtZW50O1xuICAgIHByaXZhdGUgc2NyZWVuUm9vdDogSFRNTEVsZW1lbnQ7XG4gICAgcHJpdmF0ZSBwYWludEJ1dHRvbjogSFRNTEJ1dHRvbkVsZW1lbnQ7XG4gICAgcHJpdmF0ZSBsZWdlbmRzOiBIVE1MRWxlbWVudDtcbiAgICBwcml2YXRlIHJlbmRlcmVyOiBSZW5kZXJlcjtcbiAgICBwcml2YXRlIGRvd25sb2FkSlNPTkJ1dHRvbjogSFRNTEJ1dHRvbkVsZW1lbnQ7XG4gICAgcHJpdmF0ZSBkb3dubG9hZFBOR0J1dHRvbjogSFRNTEJ1dHRvbkVsZW1lbnQ7XG4gICAgcHJpdmF0ZSBzY3JlZW46IEhUTUxDYW52YXNFbGVtZW50IHwgbnVsbDtcblxuICAgIGNvbnN0cnVjdG9yKCkge1xuICAgICAgICB0aGlzLmdlbmVyYXRvciA9IEdlbmVyYXRvci5uZXcoKTtcbiAgICAgICAgdGhpcy5jdXJyZW50Qm9hcmQgPSBudWxsO1xuICAgICAgICB0aGlzLnNjcmVlbiA9IG51bGw7XG5cbiAgICAgICAgY29uc3Qgc2VsZWN0b3IgPSBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgnZGltZW5zaW9uLXNlbGVjdG9yJykgYXMgSFRNTFNlbGVjdEVsZW1lbnQ7XG4gICAgICAgIGNvbnN0IG9wdGlvbiA9IHNlbGVjdG9yW3NlbGVjdG9yLnNlbGVjdGVkSW5kZXhdIGFzIEhUTUxPcHRpb25FbGVtZW50O1xuICAgICAgICB0aGlzLmRpbSA9IG9wdGlvbi52YWx1ZTtcbiAgICAgICAgc2VsZWN0b3IuYWRkRXZlbnRMaXN0ZW5lcignY2hhbmdlJywgdGhpcy5vblZpc3VhbGl6YXRpb25DaGFuZ2UuYmluZCh0aGlzKSk7XG5cbiAgICAgICAgdGhpcy53aWR0aElucHV0ID0gZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoJ3dpZHRoLWlucHV0JykgYXMgSFRNTElucHV0RWxlbWVudDtcbiAgICAgICAgdGhpcy5oZWlnaHRJbnB1dCA9IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCdoZWlnaHQtaW5wdXQnKSBhcyBIVE1MSW5wdXRFbGVtZW50O1xuICAgICAgICB0aGlzLnNjcmVlblJvb3QgPSBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgnc2NyZWVuLXJvb3QnKSBhcyBIVE1MRWxlbWVudDtcblxuICAgICAgICB0aGlzLmluaXRSZW5kZXJlcigpO1xuXG4gICAgICAgIHRoaXMucGFpbnRCdXR0b24gPSBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgncGFpbnQtYnV0dG9uJykgYXMgSFRNTEJ1dHRvbkVsZW1lbnQ7XG4gICAgICAgIHRoaXMucGFpbnRCdXR0b24uYWRkRXZlbnRMaXN0ZW5lcignY2xpY2snLCAoKSA9PiB7XG4gICAgICAgICAgICB0aGlzLnJlbmRlcigpO1xuICAgICAgICB9KTtcblxuICAgICAgICB0aGlzLmxlZ2VuZHMgPSBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgnbGVnZW5kcycpIGFzIEhUTUxFbGVtZW50O1xuXG4gICAgICAgIHRoaXMuZG93bmxvYWRKU09OQnV0dG9uID0gZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoJ2Rvd25sb2FkLWpzb24tYnV0dG9uJykgYXMgSFRNTEJ1dHRvbkVsZW1lbnQ7XG4gICAgICAgIHRoaXMuZG93bmxvYWRKU09OQnV0dG9uLmFkZEV2ZW50TGlzdGVuZXIoJ2NsaWNrJywgdGhpcy5vbkRvd25sb2FkSlNPTi5iaW5kKHRoaXMpKTtcblxuICAgICAgICB0aGlzLmRvd25sb2FkUE5HQnV0dG9uID0gZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoJ2Rvd25sb2FkLXBuZy1idXR0b24nKSBhcyBIVE1MQnV0dG9uRWxlbWVudDtcbiAgICAgICAgdGhpcy5kb3dubG9hZFBOR0J1dHRvbi5hZGRFdmVudExpc3RlbmVyKCdjbGljaycsIHRoaXMub25Eb3dubG9hZFBORy5iaW5kKHRoaXMpKTtcbiAgICB9XG5cbiAgICBwdWJsaWMgcmVuZGVyKCkge1xuICAgICAgICAvLyBUT0RPOiBMb2FkaW5nIGluZGljYXRvciBjYW5ub3QgYmUgZGlzcGxheWVkIHNpbmNlIG1hcCBnZW5lcmF0aW9uIGlzIHJ1biBpbiBtYWluIHRocmVhZC5cbiAgICAgICAgLy8gV2hlbiBtYXAgc2l6ZSBpcyB2ZXJ5IGxhcmdlIGFuZCBpdCBjb25zdW1lcyB0aW1lLCBDUFUgY29yZSBpcyBhbHNvIGNvbnN1bWVkIGZvciBtYWluIHRocmVhZC5cbiAgICAgICAgLy8gSW4gdGhlIGNhc2UsIG5vIGFuaW1hdGlvbiBpcyBhY3R1YWxseSByZW5kZXJlZC5cbiAgICAgICAgLy8gVG8gcHJldmVudCB0aGlzLCBtYXAgZ2VuZXJhdGlvbiBtdXN0IGJlIHJ1biBpbiBhbm90aGVyIHRocmVhZCBhbmQgUnVzdCBjYW4gZG8gaXQuXG5cbiAgICAgICAgLy8gdGhpcy5wYWludEJ1dHRvbi5jbGFzc0xpc3QuYWRkKCdpcy1sb2FkaW5nJyk7XG4gICAgICAgIHRoaXMucGFpbnRCdXR0b24udGV4dENvbnRlbnQgPSAnUGFpbnRpbmcuLi4nO1xuICAgICAgICBmb3IgKGNvbnN0IGJ0biBvZiBbdGhpcy5wYWludEJ1dHRvbiwgdGhpcy5kb3dubG9hZEpTT05CdXR0b24sIHRoaXMuZG93bmxvYWRQTkdCdXR0b25dKSB7XG4gICAgICAgICAgICBidG4uY2xhc3NMaXN0LmFkZCgnZGlzYWJsZWQnKTtcbiAgICAgICAgfVxuXG4gICAgICAgIC8vIFdhaXQgbmV4dCB0aWNrIHRvIGNoYW5nZSB0ZXh0XG4gICAgICAgIHdpbmRvdy5zZXRUaW1lb3V0KCgpID0+IHtcbiAgICAgICAgICAgIGNvbnN0IHN0YXJ0ID0gRGF0ZS5ub3coKTtcbiAgICAgICAgICAgIGNvbnN0IFt3aWR0aCwgaGVpZ2h0XSA9IHRoaXMuZ2V0U2l6ZSgpO1xuICAgICAgICAgICAgY29uc3QgYm9hcmQgPSB0aGlzLmdlbmVyYXRvci5nZW5fYXV0byh3aWR0aCwgaGVpZ2h0KTtcbiAgICAgICAgICAgIGNvbnN0IHJlbmRlcmVkID0gdGhpcy5yZW5kZXJlci5yZW5kZXIoYm9hcmQpO1xuXG4gICAgICAgICAgICB0aGlzLmxlZ2VuZHMuaW5uZXJIVE1MID0gJyc7XG4gICAgICAgICAgICBjb25zdCBuYW1lcyA9IEFycmF5LmZyb20ocmVuZGVyZWQubGVnZW5kcy5rZXlzKCkpO1xuICAgICAgICAgICAgbmFtZXMuc29ydCgpO1xuICAgICAgICAgICAgZm9yIChjb25zdCBuYW1lIG9mIG5hbWVzKSB7XG4gICAgICAgICAgICAgICAgY29uc3QgbGVnZW5kID0gcmVuZGVyZWQubGVnZW5kcy5nZXQobmFtZSkhO1xuICAgICAgICAgICAgICAgIGNvbnN0IGl0ZW0gPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KCdkaXYnKTtcbiAgICAgICAgICAgICAgICBpdGVtLmNsYXNzTmFtZSA9ICdsZWdlbmQnO1xuXG4gICAgICAgICAgICAgICAgY29uc3QgY29sb3IgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KCdkaXYnKTtcbiAgICAgICAgICAgICAgICBjb2xvci5jbGFzc05hbWUgPSAnbGVnZW5kLWNvbG9yJztcbiAgICAgICAgICAgICAgICBjb2xvci5zdHlsZS5iYWNrZ3JvdW5kQ29sb3IgPSBsZWdlbmQuY29sb3IgfHwgJ25vbmUnO1xuICAgICAgICAgICAgICAgIGl0ZW0uYXBwZW5kQ2hpbGQoY29sb3IpO1xuXG4gICAgICAgICAgICAgICAgY29uc3QgbGFiZWwgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KCdkaXYnKTtcbiAgICAgICAgICAgICAgICBsYWJlbC5jbGFzc05hbWUgPSAnbGVnZW5kLW5hbWUnO1xuICAgICAgICAgICAgICAgIGxhYmVsLnRleHRDb250ZW50ID0gbGVnZW5kLnRleHQ7XG4gICAgICAgICAgICAgICAgaXRlbS5hcHBlbmRDaGlsZChsYWJlbCk7XG5cbiAgICAgICAgICAgICAgICB0aGlzLmxlZ2VuZHMuYXBwZW5kQ2hpbGQoaXRlbSk7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICB0aGlzLmN1cnJlbnRCb2FyZCA9IGJvYXJkO1xuXG4gICAgICAgICAgICAvLyB0aGlzLnBhaW50QnV0dG9uLmNsYXNzTGlzdC5yZW1vdmUoJ2lzLWxvYWRpbmcnKTtcbiAgICAgICAgICAgIGZvciAoY29uc3QgYnRuIG9mIFt0aGlzLnBhaW50QnV0dG9uLCB0aGlzLmRvd25sb2FkSlNPTkJ1dHRvbiwgdGhpcy5kb3dubG9hZFBOR0J1dHRvbl0pIHtcbiAgICAgICAgICAgICAgICBidG4uY2xhc3NMaXN0LnJlbW92ZSgnZGlzYWJsZWQnKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIHRoaXMucGFpbnRCdXR0b24udGV4dENvbnRlbnQgPSAnR2VuZXJhdGUnO1xuICAgICAgICAgICAgY29uc29sZS5sb2coJ0NvbnN1bWVkOicsIERhdGUubm93KCkgLSBzdGFydCk7XG4gICAgICAgIH0sIDApO1xuICAgIH1cblxuICAgIHByaXZhdGUgZ2V0U2l6ZSgpIHtcbiAgICAgICAgY29uc3Qgd2lkdGggPSBwYXJzZUludCh0aGlzLndpZHRoSW5wdXQudmFsdWUsIDEwKTtcbiAgICAgICAgY29uc3QgaGVpZ2h0ID0gcGFyc2VJbnQodGhpcy5oZWlnaHRJbnB1dC52YWx1ZSwgMTApO1xuICAgICAgICBpZiAoIWlzTmFOKHdpZHRoKSAmJiAhaXNOYU4oaGVpZ2h0KSkge1xuICAgICAgICAgICAgcmV0dXJuIFt3aWR0aCwgaGVpZ2h0XTtcbiAgICAgICAgfVxuXG4gICAgICAgIGlmICh0aGlzLmRpbSA9PT0gJzNkJykge1xuICAgICAgICAgICAgcmV0dXJuIFsxMjAsIDEyMF07XG4gICAgICAgIH1cblxuICAgICAgICBjb25zdCByZWN0ID0gdGhpcy5zY3JlZW5Sb290LmdldEJvdW5kaW5nQ2xpZW50UmVjdCgpO1xuXG4gICAgICAgIGlmICghaXNOYU4od2lkdGgpKSB7XG4gICAgICAgICAgICAvLyBOb3RlOiBoZWlnaHQgaXMgTmFOXG4gICAgICAgICAgICBjb25zdCBjZWxsUGl4ID0gcmVjdC53aWR0aCAvIHdpZHRoO1xuICAgICAgICAgICAgcmV0dXJuIFt3aWR0aCwgTWF0aC5mbG9vcihyZWN0LmhlaWdodCAvIGNlbGxQaXgpXTtcbiAgICAgICAgfSBlbHNlIGlmICghaXNOYU4oaGVpZ2h0KSkge1xuICAgICAgICAgICAgLy8gTm90ZTogd2lkdGggaXMgTmFOXG4gICAgICAgICAgICBjb25zdCBjZWxsUGl4ID0gcmVjdC5oZWlnaHQgLyBoZWlnaHQ7XG4gICAgICAgICAgICByZXR1cm4gW01hdGguZmxvb3IocmVjdC53aWR0aCAvIGNlbGxQaXgpLCBoZWlnaHRdO1xuICAgICAgICB9IC8qIGxvbmdlciBzaWRlIGxlbmd0aCBpcyAyMDAgY2VsbHMgYnkgZGVmYXVsdCAqLyBlbHNlIHtcbiAgICAgICAgICAgIGNvbnN0IG1heCA9IHJlY3QuaGVpZ2h0ID4gcmVjdC53aWR0aCA/IHJlY3QuaGVpZ2h0IDogcmVjdC53aWR0aDtcbiAgICAgICAgICAgIGNvbnN0IGNlbGxQaXggPSBtYXggLyAyMDA7XG4gICAgICAgICAgICByZXR1cm4gW01hdGguZmxvb3IocmVjdC53aWR0aCAvIGNlbGxQaXgpLCBNYXRoLmZsb29yKHJlY3QuaGVpZ2h0IC8gY2VsbFBpeCldO1xuICAgICAgICB9XG4gICAgfVxuXG4gICAgcHJpdmF0ZSBpbml0UmVuZGVyZXIoKSB7XG4gICAgICAgIGNvbnN0IHByZXYgPSB0aGlzLnNjcmVlblJvb3QuZmlyc3RDaGlsZDtcbiAgICAgICAgaWYgKHByZXYgIT09IG51bGwpIHtcbiAgICAgICAgICAgIHRoaXMuc2NyZWVuUm9vdC5yZW1vdmVDaGlsZChwcmV2KTtcbiAgICAgICAgfVxuICAgICAgICB0aGlzLmN1cnJlbnRCb2FyZCA9IG51bGw7XG4gICAgICAgIHRoaXMuc2NyZWVuID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudCgnY2FudmFzJyk7XG4gICAgICAgIHRoaXMuc2NyZWVuLmNsYXNzTmFtZSA9ICdzY3JlZW4nO1xuICAgICAgICB0aGlzLnNjcmVlblJvb3QuYXBwZW5kQ2hpbGQodGhpcy5zY3JlZW4pO1xuXG4gICAgICAgIHN3aXRjaCAodGhpcy5kaW0pIHtcbiAgICAgICAgICAgIGNhc2UgJzJkJzpcbiAgICAgICAgICAgICAgICB0aGlzLnJlbmRlcmVyID0gbmV3IFJlbmRlcmVyMkQodGhpcy5zY3JlZW4pO1xuICAgICAgICAgICAgICAgIGJyZWFrO1xuICAgICAgICAgICAgY2FzZSAnM2QnOlxuICAgICAgICAgICAgICAgIHRoaXMucmVuZGVyZXIgPSBuZXcgUmVuZGVyZXIzRCh0aGlzLnNjcmVlbik7XG4gICAgICAgICAgICAgICAgYnJlYWs7XG4gICAgICAgICAgICBkZWZhdWx0OlxuICAgICAgICAgICAgICAgIHRocm93IG5ldyBFcnJvcihgVW5rbm93biBjb250ZXh0ICR7dGhpcy5kaW19YCk7XG4gICAgICAgIH1cbiAgICB9XG5cbiAgICBwcml2YXRlIG9uRG93bmxvYWRKU09OKF86IEV2ZW50KSB7XG4gICAgICAgIGlmICh0aGlzLmN1cnJlbnRCb2FyZCA9PT0gbnVsbCkge1xuICAgICAgICAgICAgcmV0dXJuO1xuICAgICAgICB9XG4gICAgICAgIGNvbnN0IGJsb2IgPSBuZXcgQmxvYihbdGhpcy5jdXJyZW50Qm9hcmQuYXNfanNvbigpXSwgeyB0eXBlOiAndGV4dC9wbGFpbjtjaGFyc2V0PXV0Zi04JyB9KTtcbiAgICAgICAgc2F2ZUFzKGJsb2IsICdib2FyZC5qc29uJyk7XG4gICAgfVxuXG4gICAgcHJpdmF0ZSBvbkRvd25sb2FkUE5HKF86IEV2ZW50KSB7XG4gICAgICAgIGlmICh0aGlzLnNjcmVlbiA9PT0gbnVsbCkge1xuICAgICAgICAgICAgcmV0dXJuO1xuICAgICAgICB9XG4gICAgICAgIHRoaXMuc2NyZWVuLnRvQmxvYigoYjogQmxvYikgPT4gc2F2ZUFzKGIsICdib2FyZC5wbmcnKSk7XG4gICAgfVxuXG4gICAgcHJpdmF0ZSBvblZpc3VhbGl6YXRpb25DaGFuZ2UoZXZlbnQ6IEV2ZW50KSB7XG4gICAgICAgIGNvbnN0IHNlbGVjdG9yID0gZXZlbnQudGFyZ2V0IGFzIEhUTUxTZWxlY3RFbGVtZW50O1xuICAgICAgICBjb25zdCBvcHRpb24gPSBzZWxlY3RvcltzZWxlY3Rvci5zZWxlY3RlZEluZGV4XSBhcyBIVE1MT3B0aW9uRWxlbWVudDtcbiAgICAgICAgY29uc3QgZGltID0gb3B0aW9uLnZhbHVlO1xuICAgICAgICBpZiAodGhpcy5kaW0gPT09IGRpbSkge1xuICAgICAgICAgICAgcmV0dXJuO1xuICAgICAgICB9XG4gICAgICAgIHRoaXMuZGltID0gZGltO1xuICAgICAgICB0aGlzLmluaXRSZW5kZXJlcigpO1xuICAgICAgICB0aGlzLnJlbmRlcigpO1xuICAgIH1cbn0oKTtcblxuYXBwLnJlbmRlcigpO1xuIiwiaW1wb3J0ICogYXMgd2FzbSBmcm9tICcuL3dvcmxkX21hcF9nZW5fYmcnO1xuXG5sZXQgY2FjaGVkVGV4dERlY29kZXIgPSBuZXcgVGV4dERlY29kZXIoJ3V0Zi04Jyk7XG5cbmxldCBjYWNoZWdldFVpbnQ4TWVtb3J5ID0gbnVsbDtcbmZ1bmN0aW9uIGdldFVpbnQ4TWVtb3J5KCkge1xuICAgIGlmIChjYWNoZWdldFVpbnQ4TWVtb3J5ID09PSBudWxsIHx8IGNhY2hlZ2V0VWludDhNZW1vcnkuYnVmZmVyICE9PSB3YXNtLm1lbW9yeS5idWZmZXIpIHtcbiAgICAgICAgY2FjaGVnZXRVaW50OE1lbW9yeSA9IG5ldyBVaW50OEFycmF5KHdhc20ubWVtb3J5LmJ1ZmZlcik7XG4gICAgfVxuICAgIHJldHVybiBjYWNoZWdldFVpbnQ4TWVtb3J5O1xufVxuXG5mdW5jdGlvbiBnZXRTdHJpbmdGcm9tV2FzbShwdHIsIGxlbikge1xuICAgIHJldHVybiBjYWNoZWRUZXh0RGVjb2Rlci5kZWNvZGUoZ2V0VWludDhNZW1vcnkoKS5zdWJhcnJheShwdHIsIHB0ciArIGxlbikpO1xufVxuXG5sZXQgY2FjaGVkR2xvYmFsQXJndW1lbnRQdHIgPSBudWxsO1xuZnVuY3Rpb24gZ2xvYmFsQXJndW1lbnRQdHIoKSB7XG4gICAgaWYgKGNhY2hlZEdsb2JhbEFyZ3VtZW50UHRyID09PSBudWxsKSB7XG4gICAgICAgIGNhY2hlZEdsb2JhbEFyZ3VtZW50UHRyID0gd2FzbS5fX3diaW5kZ2VuX2dsb2JhbF9hcmd1bWVudF9wdHIoKTtcbiAgICB9XG4gICAgcmV0dXJuIGNhY2hlZEdsb2JhbEFyZ3VtZW50UHRyO1xufVxuXG5sZXQgY2FjaGVnZXRVaW50MzJNZW1vcnkgPSBudWxsO1xuZnVuY3Rpb24gZ2V0VWludDMyTWVtb3J5KCkge1xuICAgIGlmIChjYWNoZWdldFVpbnQzMk1lbW9yeSA9PT0gbnVsbCB8fCBjYWNoZWdldFVpbnQzMk1lbW9yeS5idWZmZXIgIT09IHdhc20ubWVtb3J5LmJ1ZmZlcikge1xuICAgICAgICBjYWNoZWdldFVpbnQzMk1lbW9yeSA9IG5ldyBVaW50MzJBcnJheSh3YXNtLm1lbW9yeS5idWZmZXIpO1xuICAgIH1cbiAgICByZXR1cm4gY2FjaGVnZXRVaW50MzJNZW1vcnk7XG59XG4vKipcbiogUmVwcmVzZW50cyB0aGUga2luZCBvZiBjZWxsLiBgcHJlc2V0KClgIG1ldGhvZCByZXR1cm5zIGEgcHJlc2V0IGNlbGwgY29uc3RhbnRzIGZvclxuKiB0aGUga2luZC5cbiovXG5leHBvcnQgY29uc3QgTGFuZEtpbmQgPSBPYmplY3QuZnJlZXplKHsgU2VhOjAsTW91bnRhaW46MSxGb3Jlc3Q6MixQbGFpbjozLFRvd246NCxUb3A6NSxIaWdobGFuZDo2LERlZXBTZWE6NyxQYXRoOjgsIH0pO1xuLyoqXG4qIFJlc29sdXRpb24gb2YgdGhlIGJvYXJkLlxuKi9cbmV4cG9ydCBjb25zdCBSZXNvbHV0aW9uID0gT2JqZWN0LmZyZWV6ZSh7IExvdzowLE1pZGRsZToxLEhpZ2g6MiwgfSk7XG5cbmNvbnN0IGhlYXAgPSBuZXcgQXJyYXkoMzIpO1xuXG5oZWFwLmZpbGwodW5kZWZpbmVkKTtcblxuaGVhcC5wdXNoKHVuZGVmaW5lZCwgbnVsbCwgdHJ1ZSwgZmFsc2UpO1xuXG5sZXQgaGVhcF9uZXh0ID0gaGVhcC5sZW5ndGg7XG5cbmZ1bmN0aW9uIGFkZEhlYXBPYmplY3Qob2JqKSB7XG4gICAgaWYgKGhlYXBfbmV4dCA9PT0gaGVhcC5sZW5ndGgpIGhlYXAucHVzaChoZWFwLmxlbmd0aCArIDEpO1xuICAgIGNvbnN0IGlkeCA9IGhlYXBfbmV4dDtcbiAgICBoZWFwX25leHQgPSBoZWFwW2lkeF07XG5cbiAgICBoZWFwW2lkeF0gPSBvYmo7XG4gICAgcmV0dXJuIGlkeDtcbn1cblxuZXhwb3J0IGZ1bmN0aW9uIF9fd2JnX25ld18zYTc0NmYyNjE5NzA1YWRkKGFyZzAsIGFyZzEpIHtcbiAgICBsZXQgdmFyZzAgPSBnZXRTdHJpbmdGcm9tV2FzbShhcmcwLCBhcmcxKTtcbiAgICByZXR1cm4gYWRkSGVhcE9iamVjdChuZXcgRnVuY3Rpb24odmFyZzApKTtcbn1cblxuZnVuY3Rpb24gZ2V0T2JqZWN0KGlkeCkgeyByZXR1cm4gaGVhcFtpZHhdOyB9XG5cbmV4cG9ydCBmdW5jdGlvbiBfX3diZ19jYWxsX2Y1NGQzYTZkYWRiMTk5Y2EoYXJnMCwgYXJnMSkge1xuICAgIHJldHVybiBhZGRIZWFwT2JqZWN0KGdldE9iamVjdChhcmcwKS5jYWxsKGdldE9iamVjdChhcmcxKSkpO1xufVxuXG5leHBvcnQgZnVuY3Rpb24gX193Ymdfc2VsZl9hYzM3OWU3ODBhMGQ4Yjk0KGFyZzApIHtcbiAgICByZXR1cm4gYWRkSGVhcE9iamVjdChnZXRPYmplY3QoYXJnMCkuc2VsZik7XG59XG5cbmV4cG9ydCBmdW5jdGlvbiBfX3diZ19jcnlwdG9fMWU0MzAyYjg1ZDRmNjRhMihhcmcwKSB7XG4gICAgcmV0dXJuIGFkZEhlYXBPYmplY3QoZ2V0T2JqZWN0KGFyZzApLmNyeXB0byk7XG59XG5cbmV4cG9ydCBmdW5jdGlvbiBfX3diZ19nZXRSYW5kb21WYWx1ZXNfMWI0YmExNDQxNjJhNWM5ZShhcmcwKSB7XG4gICAgcmV0dXJuIGFkZEhlYXBPYmplY3QoZ2V0T2JqZWN0KGFyZzApLmdldFJhbmRvbVZhbHVlcyk7XG59XG5cbmZ1bmN0aW9uIGdldEFycmF5VThGcm9tV2FzbShwdHIsIGxlbikge1xuICAgIHJldHVybiBnZXRVaW50OE1lbW9yeSgpLnN1YmFycmF5KHB0ciAvIDEsIHB0ciAvIDEgKyBsZW4pO1xufVxuXG5leHBvcnQgZnVuY3Rpb24gX193YmdfZ2V0UmFuZG9tVmFsdWVzXzFlZjExZTg4OGU1MjI4ZTkoYXJnMCwgYXJnMSwgYXJnMikge1xuICAgIGxldCB2YXJnMSA9IGdldEFycmF5VThGcm9tV2FzbShhcmcxLCBhcmcyKTtcbiAgICBnZXRPYmplY3QoYXJnMCkuZ2V0UmFuZG9tVmFsdWVzKHZhcmcxKTtcbn1cblxuZXhwb3J0IGZ1bmN0aW9uIF9fd2JnX3JlcXVpcmVfNjQ2MWIxZTlhMGQ3YzM0YShhcmcwLCBhcmcxKSB7XG4gICAgbGV0IHZhcmcwID0gZ2V0U3RyaW5nRnJvbVdhc20oYXJnMCwgYXJnMSk7XG4gICAgcmV0dXJuIGFkZEhlYXBPYmplY3QocmVxdWlyZSh2YXJnMCkpO1xufVxuXG5leHBvcnQgZnVuY3Rpb24gX193YmdfcmFuZG9tRmlsbFN5bmNfMWI1MmM4NDgyMzc0YzU1YihhcmcwLCBhcmcxLCBhcmcyKSB7XG4gICAgbGV0IHZhcmcxID0gZ2V0QXJyYXlVOEZyb21XYXNtKGFyZzEsIGFyZzIpO1xuICAgIGdldE9iamVjdChhcmcwKS5yYW5kb21GaWxsU3luYyh2YXJnMSk7XG59XG5cbmV4cG9ydCBmdW5jdGlvbiBfX3diaW5kZ2VuX2lzX3VuZGVmaW5lZChpKSB7IHJldHVybiBnZXRPYmplY3QoaSkgPT09IHVuZGVmaW5lZCA/IDEgOiAwOyB9XG5cbmV4cG9ydCBmdW5jdGlvbiBfX3diaW5kZ2VuX2pzdmFsX2VxKGEsIGIpIHsgcmV0dXJuIGdldE9iamVjdChhKSA9PT0gZ2V0T2JqZWN0KGIpID8gMSA6IDA7IH1cblxuZXhwb3J0IGZ1bmN0aW9uIF9fd2JpbmRnZW5fdGhyb3cocHRyLCBsZW4pIHtcbiAgICB0aHJvdyBuZXcgRXJyb3IoZ2V0U3RyaW5nRnJvbVdhc20ocHRyLCBsZW4pKTtcbn1cblxuZnVuY3Rpb24gZnJlZUJvYXJkKHB0cikge1xuXG4gICAgd2FzbS5fX3diZ19ib2FyZF9mcmVlKHB0cik7XG59XG4vKipcbiogUmVwcmVzZW50cyBvbmUgYm9hcmQgZ2VuZXJhdGVkIGJ5IHJhbmRvbSBtYXAgZ2VuZXJhdG9yLlxuKi9cbmV4cG9ydCBjbGFzcyBCb2FyZCB7XG5cbiAgICBzdGF0aWMgX193cmFwKHB0cikge1xuICAgICAgICBjb25zdCBvYmogPSBPYmplY3QuY3JlYXRlKEJvYXJkLnByb3RvdHlwZSk7XG4gICAgICAgIG9iai5wdHIgPSBwdHI7XG5cbiAgICAgICAgcmV0dXJuIG9iajtcbiAgICB9XG5cbiAgICBmcmVlKCkge1xuICAgICAgICBjb25zdCBwdHIgPSB0aGlzLnB0cjtcbiAgICAgICAgdGhpcy5wdHIgPSAwO1xuICAgICAgICBmcmVlQm9hcmQocHRyKTtcbiAgICB9XG5cbiAgICAvKipcbiAgICAqIFJldHVybnMgd2lkdGggYXMgbnVtYmVyIG9mIGNlbGxzIGluIG51bWJlclxuICAgICogQHJldHVybnMge251bWJlcn1cbiAgICAqL1xuICAgIHdpZHRoKCkge1xuICAgICAgICByZXR1cm4gd2FzbS5ib2FyZF93aWR0aCh0aGlzLnB0cikgPj4+IDA7XG4gICAgfVxuICAgIC8qKlxuICAgICogUmV0dXJucyBoZWlnaHQgYXMgbnVtYmVyIG9mIGNlbGxzIGluIG51bWJlclxuICAgICogQHJldHVybnMge251bWJlcn1cbiAgICAqL1xuICAgIGhlaWdodCgpIHtcbiAgICAgICAgcmV0dXJuIHdhc20uYm9hcmRfaGVpZ2h0KHRoaXMucHRyKSA+Pj4gMDtcbiAgICB9XG4gICAgLyoqXG4gICAgKiBSZXR1cm5zIGNlbGwgYXQgcG9zaXRpb24gKHgsIHkpLlxuICAgICogQHBhcmFtIHtudW1iZXJ9IHhcbiAgICAqIEBwYXJhbSB7bnVtYmVyfSB5XG4gICAgKiBAcmV0dXJucyB7Q2VsbH1cbiAgICAqL1xuICAgIGF0KHgsIHkpIHtcbiAgICAgICAgcmV0dXJuIENlbGwuX193cmFwKHdhc20uYm9hcmRfYXQodGhpcy5wdHIsIHgsIHkpKTtcbiAgICB9XG4gICAgLyoqXG4gICAgKiBSZXR1cm5zIGEgYm9hcmQgYnkgc2VyaWFsaXppbmcgYXMgSlNPTi4gT24gZmFpbHVyZSwgaXQgcmV0dXJucyBgTm9uZWAgKGB1bmRlZmluZWRgIGluXG4gICAgKiBKYXZhU2NyaXB0KVxuICAgICogQHJldHVybnMge3N0cmluZ31cbiAgICAqL1xuICAgIGFzX2pzb24oKSB7XG4gICAgICAgIGNvbnN0IHJldHB0ciA9IGdsb2JhbEFyZ3VtZW50UHRyKCk7XG4gICAgICAgIHdhc20uYm9hcmRfYXNfanNvbihyZXRwdHIsIHRoaXMucHRyKTtcbiAgICAgICAgY29uc3QgbWVtID0gZ2V0VWludDMyTWVtb3J5KCk7XG4gICAgICAgIGNvbnN0IHJ1c3RwdHIgPSBtZW1bcmV0cHRyIC8gNF07XG4gICAgICAgIGNvbnN0IHJ1c3RsZW4gPSBtZW1bcmV0cHRyIC8gNCArIDFdO1xuICAgICAgICBpZiAocnVzdHB0ciA9PT0gMCkgcmV0dXJuO1xuICAgICAgICBjb25zdCByZWFsUmV0ID0gZ2V0U3RyaW5nRnJvbVdhc20ocnVzdHB0ciwgcnVzdGxlbikuc2xpY2UoKTtcbiAgICAgICAgd2FzbS5fX3diaW5kZ2VuX2ZyZWUocnVzdHB0ciwgcnVzdGxlbiAqIDEpO1xuICAgICAgICByZXR1cm4gcmVhbFJldDtcblxuICAgIH1cbn1cblxuZnVuY3Rpb24gZnJlZUNlbGwocHRyKSB7XG5cbiAgICB3YXNtLl9fd2JnX2NlbGxfZnJlZShwdHIpO1xufVxuLyoqXG4qIFJlcHJlc2VudHMgb25lIGNlbGwgaW4gYm9hcmQuIEluIGNvbnRyYXN0IHRvIGBsYW5kOjpMYW5kYCwgaXQgb25seSBjb250YWlucyBpdHMgbGFuZCBraW5kIGFuZFxuKiBhbHRpdHVkZSBpbiBvcmRlciB0byByZWR1Y2UgdG90YWwgbWVtb3J5IHNpemUuXG4qL1xuZXhwb3J0IGNsYXNzIENlbGwge1xuXG4gICAgc3RhdGljIF9fd3JhcChwdHIpIHtcbiAgICAgICAgY29uc3Qgb2JqID0gT2JqZWN0LmNyZWF0ZShDZWxsLnByb3RvdHlwZSk7XG4gICAgICAgIG9iai5wdHIgPSBwdHI7XG5cbiAgICAgICAgcmV0dXJuIG9iajtcbiAgICB9XG5cbiAgICBmcmVlKCkge1xuICAgICAgICBjb25zdCBwdHIgPSB0aGlzLnB0cjtcbiAgICAgICAgdGhpcy5wdHIgPSAwO1xuICAgICAgICBmcmVlQ2VsbChwdHIpO1xuICAgIH1cblxuICAgIC8qKlxuICAgICogS2luZCBmb3IgdGhlIGNlbGwgKFNlYSwgRm9yZXN0LCBNb3VudGFpbiwgLi4uKVxuICAgICogQHJldHVybnMge251bWJlcn1cbiAgICAqL1xuICAgIGdldCBraW5kKCkge1xuICAgICAgICByZXR1cm4gd2FzbS5fX3diZ19nZXRfY2VsbF9raW5kKHRoaXMucHRyKTtcbiAgICB9XG4gICAgc2V0IGtpbmQoYXJnMCkge1xuICAgICAgICByZXR1cm4gd2FzbS5fX3diZ19zZXRfY2VsbF9raW5kKHRoaXMucHRyLCBhcmcwKTtcbiAgICB9XG4gICAgLyoqXG4gICAgKiBBbHRpdHVkZSBvZiB0aGUgY2VsbCBpbiAwLi45OVxuICAgICogQHJldHVybnMge251bWJlcn1cbiAgICAqL1xuICAgIGdldCBhbHRpdHVkZSgpIHtcbiAgICAgICAgcmV0dXJuIHdhc20uX193YmdfZ2V0X2NlbGxfYWx0aXR1ZGUodGhpcy5wdHIpO1xuICAgIH1cbiAgICBzZXQgYWx0aXR1ZGUoYXJnMCkge1xuICAgICAgICByZXR1cm4gd2FzbS5fX3diZ19zZXRfY2VsbF9hbHRpdHVkZSh0aGlzLnB0ciwgYXJnMCk7XG4gICAgfVxuICAgIC8qKlxuICAgICogUmV0dXJucyBjb2xvciBjb2RlIG9mIGxhbmQgYXMgYCNycmdnYmJgIGZvcm1hdCBzdHJpbmcgZnJvbSBsYW5kIGtpbmQuXG4gICAgKiBXaGVuIG5vIGNvbG9yIGlzIHNldCwgcmV0dXJucyBgTm9uZWAuIEl0IG1lYW5zIGB1bmRlZmluZWRgIGluIEphdmFTY3JpcHQgc2lkZS5cbiAgICAqIEByZXR1cm5zIHtzdHJpbmd9XG4gICAgKi9cbiAgICBjb2xvcl9jb2RlKCkge1xuICAgICAgICBjb25zdCByZXRwdHIgPSBnbG9iYWxBcmd1bWVudFB0cigpO1xuICAgICAgICB3YXNtLmNlbGxfY29sb3JfY29kZShyZXRwdHIsIHRoaXMucHRyKTtcbiAgICAgICAgY29uc3QgbWVtID0gZ2V0VWludDMyTWVtb3J5KCk7XG4gICAgICAgIGNvbnN0IHJ1c3RwdHIgPSBtZW1bcmV0cHRyIC8gNF07XG4gICAgICAgIGNvbnN0IHJ1c3RsZW4gPSBtZW1bcmV0cHRyIC8gNCArIDFdO1xuICAgICAgICBpZiAocnVzdHB0ciA9PT0gMCkgcmV0dXJuO1xuICAgICAgICBjb25zdCByZWFsUmV0ID0gZ2V0U3RyaW5nRnJvbVdhc20ocnVzdHB0ciwgcnVzdGxlbikuc2xpY2UoKTtcbiAgICAgICAgd2FzbS5fX3diaW5kZ2VuX2ZyZWUocnVzdHB0ciwgcnVzdGxlbiAqIDEpO1xuICAgICAgICByZXR1cm4gcmVhbFJldDtcblxuICAgIH1cbiAgICAvKipcbiAgICAqIFJldHVybnMgUkdCIGNvbG9yIGFzIHUzMi4gMH44IGJpdHMgZm9yIEIsIDl+MTYgYml0cyBmb3IgRywgMTd+MjQgYml0cyBmb3IgUi5cbiAgICAqIFdoZW4gbm8gY29sb3IgaXMgc2V0LCByZXR1cm5zIGBOb25lYC4gSXQgbWVhbnMgYHVuZGVmaW5lZGAgaW4gSmF2YVNjcmlwdCBzaWRlLlxuICAgICogQHJldHVybnMge251bWJlciB8IHVuZGVmaW5lZH1cbiAgICAqL1xuICAgIHJnYl9jb2xvcigpIHtcbiAgICAgICAgY29uc3QgcmV0cHRyID0gZ2xvYmFsQXJndW1lbnRQdHIoKTtcblxuICAgICAgICB3YXNtLmNlbGxfcmdiX2NvbG9yKHJldHB0ciwgdGhpcy5wdHIpO1xuICAgICAgICBjb25zdCBwcmVzZW50ID0gZ2V0VWludDMyTWVtb3J5KClbcmV0cHRyIC8gNF07XG4gICAgICAgIGNvbnN0IHZhbHVlID0gZ2V0VWludDMyTWVtb3J5KClbcmV0cHRyIC8gNCArIDFdO1xuICAgICAgICByZXR1cm4gcHJlc2VudCA9PT0gMCA/IHVuZGVmaW5lZCA6IHZhbHVlO1xuXG4gICAgfVxuICAgIC8qKlxuICAgICogUmV0dXJucyBsZWdlbmQgb2YgbGFuZCBhcyBzdHJpbmcgZnJvbSBsYW5kIGtpbmQuXG4gICAgKiBAcmV0dXJucyB7c3RyaW5nfVxuICAgICovXG4gICAgbGVnZW5kKCkge1xuICAgICAgICBjb25zdCByZXRwdHIgPSBnbG9iYWxBcmd1bWVudFB0cigpO1xuICAgICAgICB3YXNtLmNlbGxfbGVnZW5kKHJldHB0ciwgdGhpcy5wdHIpO1xuICAgICAgICBjb25zdCBtZW0gPSBnZXRVaW50MzJNZW1vcnkoKTtcbiAgICAgICAgY29uc3QgcnVzdHB0ciA9IG1lbVtyZXRwdHIgLyA0XTtcbiAgICAgICAgY29uc3QgcnVzdGxlbiA9IG1lbVtyZXRwdHIgLyA0ICsgMV07XG5cbiAgICAgICAgY29uc3QgcmVhbFJldCA9IGdldFN0cmluZ0Zyb21XYXNtKHJ1c3RwdHIsIHJ1c3RsZW4pLnNsaWNlKCk7XG4gICAgICAgIHdhc20uX193YmluZGdlbl9mcmVlKHJ1c3RwdHIsIHJ1c3RsZW4gKiAxKTtcbiAgICAgICAgcmV0dXJuIHJlYWxSZXQ7XG5cbiAgICB9XG59XG5cbmZ1bmN0aW9uIGZyZWVHZW5lcmF0b3IocHRyKSB7XG5cbiAgICB3YXNtLl9fd2JnX2dlbmVyYXRvcl9mcmVlKHB0cik7XG59XG4vKipcbiogUmVwcmVzZW50cyByYW5kb20gbWFwIGdlbmVyYXRvci4gSW4gY29udHJhc3QgdG8gYGdlbjo6UmFuZG9tQm9hcmRHZW5gLCBpdCBvbmx5IHByb3ZpZGVzIGxpbWl0ZWRcbiogZnVuY3Rpb25hbGl0eS4gSXQgY2Fubm90IGJlIGluaXRpYWxpemVkIHdpdGggc3BlY2lmaWMgc2VlZC4gQW5kIG1hcCByZXNvbHV0aW9uIGlzIGFsd2F5cyBkZXRlY3RlZFxuKiBmcm9tIGl0cyBzaXplLlxuKi9cbmV4cG9ydCBjbGFzcyBHZW5lcmF0b3Ige1xuXG4gICAgc3RhdGljIF9fd3JhcChwdHIpIHtcbiAgICAgICAgY29uc3Qgb2JqID0gT2JqZWN0LmNyZWF0ZShHZW5lcmF0b3IucHJvdG90eXBlKTtcbiAgICAgICAgb2JqLnB0ciA9IHB0cjtcblxuICAgICAgICByZXR1cm4gb2JqO1xuICAgIH1cblxuICAgIGZyZWUoKSB7XG4gICAgICAgIGNvbnN0IHB0ciA9IHRoaXMucHRyO1xuICAgICAgICB0aGlzLnB0ciA9IDA7XG4gICAgICAgIGZyZWVHZW5lcmF0b3IocHRyKTtcbiAgICB9XG5cbiAgICAvKipcbiAgICAqIENyZWF0ZSBhIG5ldyBnZW5lcmF0b3IgaW5zdGFuY2UgaW5pdGlhbGl6ZWQgd2l0aCB0aHJlYWQtZGVmYXVsdCByYW5kb20gbnVtYmVyIGdlbmVyYXRvci5cbiAgICAqIE5vIHNlZWRhYmxlIFJORyBpcyBwcm92aWRlZCBmb3IgV2FzbSBpbnRlcmZhY2UgZm9yIG5vdy5cbiAgICAqIEByZXR1cm5zIHtHZW5lcmF0b3J9XG4gICAgKi9cbiAgICBzdGF0aWMgbmV3KCkge1xuICAgICAgICByZXR1cm4gR2VuZXJhdG9yLl9fd3JhcCh3YXNtLmdlbmVyYXRvcl9uZXcoKSk7XG4gICAgfVxuICAgIC8qKlxuICAgICogR2VuZXJhdGVzIHJhbmRvbSBtYXAgYm9hcmQgd2l0aCBnaXZlbiB3aWR0aCBhbmQgaGVpZ2h0LiBQYXJhbWV0ZXJzIGFyZSBpbiBudW1iZXIgb2YgY2VsbHMuXG4gICAgKiBAcGFyYW0ge251bWJlcn0gd2lkdGhcbiAgICAqIEBwYXJhbSB7bnVtYmVyfSBoZWlnaHRcbiAgICAqIEByZXR1cm5zIHtCb2FyZH1cbiAgICAqL1xuICAgIGdlbl9hdXRvKHdpZHRoLCBoZWlnaHQpIHtcbiAgICAgICAgcmV0dXJuIEJvYXJkLl9fd3JhcCh3YXNtLmdlbmVyYXRvcl9nZW5fYXV0byh0aGlzLnB0ciwgd2lkdGgsIGhlaWdodCkpO1xuICAgIH1cbiAgICAvKipcbiAgICAqIEdlbmVyYXRlcyByYW5kb20gbWFwIGJvYXJkIHdpdGggZ2l2ZW4gcmVzb2x1dGlvbiwgd2lkdGggYW5kIGhlaWdodC4gV2lkdGggYW5kIGhlaWdodCBhcmVcbiAgICAqIGluIG51bWJlciBvZiBjZWxscy5cbiAgICAqIEBwYXJhbSB7bnVtYmVyfSByZXNcbiAgICAqIEBwYXJhbSB7bnVtYmVyfSB3aWR0aFxuICAgICogQHBhcmFtIHtudW1iZXJ9IGhlaWdodFxuICAgICogQHJldHVybnMge0JvYXJkfVxuICAgICovXG4gICAgZ2VuKHJlcywgd2lkdGgsIGhlaWdodCkge1xuICAgICAgICByZXR1cm4gQm9hcmQuX193cmFwKHdhc20uZ2VuZXJhdG9yX2dlbih0aGlzLnB0ciwgcmVzLCB3aWR0aCwgaGVpZ2h0KSk7XG4gICAgfVxufVxuXG5mdW5jdGlvbiBkcm9wT2JqZWN0KGlkeCkge1xuICAgIGlmIChpZHggPCAzNikgcmV0dXJuO1xuICAgIGhlYXBbaWR4XSA9IGhlYXBfbmV4dDtcbiAgICBoZWFwX25leHQgPSBpZHg7XG59XG5cbmV4cG9ydCBmdW5jdGlvbiBfX3diaW5kZ2VuX29iamVjdF9kcm9wX3JlZihpKSB7IGRyb3BPYmplY3QoaSk7IH1cblxuIiwiZnVuY3Rpb24gd2VicGFja0VtcHR5Q29udGV4dChyZXEpIHtcblx0dmFyIGUgPSBuZXcgRXJyb3IoXCJDYW5ub3QgZmluZCBtb2R1bGUgJ1wiICsgcmVxICsgXCInXCIpO1xuXHRlLmNvZGUgPSAnTU9EVUxFX05PVF9GT1VORCc7XG5cdHRocm93IGU7XG59XG53ZWJwYWNrRW1wdHlDb250ZXh0LmtleXMgPSBmdW5jdGlvbigpIHsgcmV0dXJuIFtdOyB9O1xud2VicGFja0VtcHR5Q29udGV4dC5yZXNvbHZlID0gd2VicGFja0VtcHR5Q29udGV4dDtcbm1vZHVsZS5leHBvcnRzID0gd2VicGFja0VtcHR5Q29udGV4dDtcbndlYnBhY2tFbXB0eUNvbnRleHQuaWQgPSA0NjsiXSwic291cmNlUm9vdCI6IiJ9