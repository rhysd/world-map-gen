(window.webpackJsonp=window.webpackJsonp||[]).push([[2],{1:function(t,e,n){"use strict";n.r(e);var r=n(2),i=n(30);class o{constructor(t){this.canvas=document.createElement("canvas"),this.canvas.className="screen",t.appendChild(this.canvas),this.ctx=this.canvas.getContext("2d")}render(t){const e=window.devicePixelRatio||1,n=this.canvas.getBoundingClientRect();this.canvas.width=n.width*e,this.canvas.height=n.height*e,this.ctx.clearRect(0,0,this.canvas.width,this.canvas.height),this.ctx.beginPath();const r=t.width(),i=t.height(),o=this.canvas.width/r,s=this.canvas.height/i,c=new Map,a=new Map;for(let e=0;e<r;e++)for(let n=0;n<i;n++){const r=t.at(e,n),i=r.kind;let u=c.get(i);if(void 0===u&&void 0!==(u=r.color_code())&&c.set(i,u),this.ctx.fillStyle=u,this.ctx.fillRect(e*o,n*s,o,s),!a.has(i)){const t=r.legend();a.set(i,{text:t,color:u})}}return this.ctx.stroke(),{legends:a}}}var s=n(32);class c{constructor(t){this.canvas=document.createElement("canvas"),this.canvas.className="screen",t.appendChild(this.canvas)}determineCellSize(t,e){const n=e+t,r=(this.canvas.height-200)/n*2,i=this.canvas.width/n*2/Math.sqrt(3);let o=Math.floor(r>i?i:r);return o%2==1&&o--,o>6?o:6}render(t){const e=window.devicePixelRatio||1,n=this.canvas.getBoundingClientRect();this.canvas.width=n.width*e,this.canvas.height=n.height*e;const i=t.width(),o=t.height(),c=this.determineCellSize(i,o),a=new s.Point(this.canvas.width/2,c+198),u=new s.PixelView(this.canvas,a),d=new Map,h=new Map,l=new Map;function f(t,e,n){const r=function(t,e){const n=h.get(t);if(void 0!==n)return n;let r=e.rgb_color();void 0===r&&(r=16777215);const i=(new s.CubeColor).getByHorizontalColor(r);return h.set(t,i),l.set(t,{text:e.legend(),color:e.color_code()}),i}(t,n),i=c+2*e,o=new s.CubeDimension(c,c,i);return new s.Cube(o,r,!1)}function w(t){const e=t.kind,n=t.altitude;if(l.has(e)||l.set(e,{text:t.legend(),color:t.color_code()}),e===r.b.Town||e===r.b.Path)return f(e,n,t);const i=d.get(n);if(void 0!==i)return i;const o=f(e,n,t);return d.set(n,o),o}for(let e=0;e<i;e++)for(let n=0;n<o;n++){const r=w(t.at(e,n)),i=new s.Point3D(e*c,n*c,0);u.renderObject(r,i)}return{legends:l}}}(new class{constructor(){this.generator=r.a.new(),this.currentBoard=null;const t=document.getElementById("dimension-selector"),e=t[t.selectedIndex];this.dim=e.value,t.addEventListener("change",this.onVisualizationChange.bind(this)),this.widthInput=document.getElementById("width-input"),this.heightInput=document.getElementById("height-input"),this.screenRoot=document.getElementById("screen-root"),this.initRenderer(),this.paintButton=document.getElementById("paint-button"),this.paintButton.addEventListener("click",()=>{this.render()}),this.legends=document.getElementById("legends"),this.downloadJSONButton=document.getElementById("download-json-button"),this.downloadJSONButton.addEventListener("click",this.onDownloadJSON.bind(this))}getSize(){const t=parseInt(this.widthInput.value,10),e=parseInt(this.heightInput.value,10);if(!isNaN(t)&&!isNaN(e))return[t,e];if("3d"===this.dim)return[120,120];const n=this.screenRoot.getBoundingClientRect();if(isNaN(t)){if(isNaN(e)){const t=(n.height>n.width?n.height:n.width)/200;return[Math.floor(n.width/t),Math.floor(n.height/t)]}{const t=n.height/e;return[Math.floor(n.width/t),e]}}{const e=n.width/t;return[t,Math.floor(n.height/e)]}}initRenderer(){const t=this.screenRoot.firstChild;switch(null!==t&&this.screenRoot.removeChild(t),this.currentBoard=null,this.dim){case"2d":this.renderer=new o(this.screenRoot);break;case"3d":this.renderer=new c(this.screenRoot);break;default:throw new Error(`Unknown context ${this.dim}`)}}onDownloadJSON(t){if(null===this.currentBoard)return;const e=new Blob([this.currentBoard.as_json()],{type:"text/plain;charset=utf-8"});Object(i.saveAs)(e,"board.json")}onVisualizationChange(t){const e=t.target,n=e[e.selectedIndex].value;this.dim!==n&&(this.dim=n,this.initRenderer(),this.render())}render(){this.paintButton.textContent="Painting...",this.paintButton.classList.add("disabled"),this.downloadJSONButton.classList.add("disabled"),window.setTimeout(()=>{const t=Date.now(),[e,n]=this.getSize(),r=this.generator.gen_auto(e,n),i=this.renderer.render(r);this.legends.innerHTML="";for(const t of i.legends.values()){const e=document.createElement("div");e.className="legend";const n=document.createElement("div");n.className="legend-color",n.style.backgroundColor=t.color||"none",e.appendChild(n);const r=document.createElement("div");r.className="legend-name",r.textContent=t.text,e.appendChild(r),this.legends.appendChild(e)}this.currentBoard=r,this.paintButton.classList.remove("disabled"),this.paintButton.textContent="Generate",this.downloadJSONButton.classList.remove("disabled"),console.log("Consumed:",Date.now()-t)},0)}}).render()},2:function(t,e,n){"use strict";n.d(e,"b",function(){return l}),n.d(e,"g",function(){return g}),n.d(e,"c",function(){return m}),n.d(e,"j",function(){return b}),n.d(e,"d",function(){return B}),n.d(e,"e",function(){return C}),n.d(e,"f",function(){return x}),n.d(e,"i",function(){return y}),n.d(e,"h",function(){return N}),n.d(e,"m",function(){return E}),n.d(e,"k",function(){return R}),n.d(e,"l",function(){return k}),n.d(e,"a",function(){return M}),n.d(e,"n",function(){return S});var r=n(45);let i=new TextDecoder("utf-8"),o=null;function s(){return null!==o&&o.buffer===r.t.buffer||(o=new Uint8Array(r.t.buffer)),o}function c(t,e){return i.decode(s().subarray(t,t+e))}let a=null;function u(){return null===a&&(a=r.i()),a}let d=null;function h(){return null!==d&&d.buffer===r.t.buffer||(d=new Uint32Array(r.t.buffer)),d}Object.freeze({Low:0,Middle:1,High:2});const l=Object.freeze({Sea:0,Mountain:1,Forest:2,Plain:3,Town:4,Top:5,Highland:6,DeepSea:7,Path:8}),f=new Array(32);f.fill(void 0),f.push(void 0,null,!0,!1);let w=f.length;function p(t){w===f.length&&f.push(f.length+1);const e=w;return w=f[e],f[e]=t,e}function g(t,e){let n=c(t,e);return p(new Function(n))}function v(t){return f[t]}function m(t,e){return p(v(t).call(v(e)))}function b(t){return p(v(t).self)}function B(t){return p(v(t).crypto)}function C(t){return p(v(t).getRandomValues)}function _(t,e){return s().subarray(t/1,t/1+e)}function x(t,e,n){let r=_(e,n);v(t).getRandomValues(r)}function y(t,e){let r=c(t,e);return p(n(46)(r))}function N(t,e,n){let r=_(e,n);v(t).randomFillSync(r)}function E(t){var e;(e=t)<36||(f[e]=w,w=e)}function R(t){return void 0===v(t)?1:0}function k(t,e){return v(t)===v(e)?1:0}class O{static __wrap(t){const e=Object.create(O.prototype);return e.ptr=t,e}free(){const t=this.ptr;this.ptr=0,function(t){r.a(t)}(t)}width(){return r.m(this.ptr)}height(){return r.l(this.ptr)}at(t,e){return I.__wrap(r.k(this.ptr,t,e))}as_json(){const t=u();r.j(t,this.ptr);const e=h(),n=e[t/4],i=e[t/4+1];if(0===n)return;const o=c(n,i).slice();return r.h(n,1*i),o}}class I{static __wrap(t){const e=Object.create(I.prototype);return e.ptr=t,e}free(){const t=this.ptr;this.ptr=0,function(t){r.b(t)}(t)}get kind(){return r.e(this.ptr)}set kind(t){return r.g(this.ptr,t)}get altitude(){return r.d(this.ptr)}set altitude(t){return r.f(this.ptr,t)}color_code(){const t=u();r.n(t,this.ptr);const e=h(),n=e[t/4],i=e[t/4+1];if(0===n)return;const o=c(n,i).slice();return r.h(n,1*i),o}rgb_color(){const t=u();r.p(t,this.ptr);const e=h()[t/4],n=h()[t/4+1];return 0===e?void 0:n}legend(){const t=u();r.o(t,this.ptr);const e=h(),n=e[t/4],i=e[t/4+1],o=c(n,i).slice();return r.h(n,1*i),o}}class M{static __wrap(t){const e=Object.create(M.prototype);return e.ptr=t,e}free(){const t=this.ptr;this.ptr=0,function(t){r.c(t)}(t)}static new(){return M.__wrap(r.s())}gen_auto(t,e){return O.__wrap(r.r(this.ptr,t,e))}gen(t,e,n){return O.__wrap(r.q(this.ptr,t,e,n))}}function S(t,e){throw new Error(c(t,e))}},45:function(t,e,n){"use strict";var r=n.w[t.i];t.exports=r;n(2);r.u()},46:function(t,e){function n(t){var e=new Error("Cannot find module '"+t+"'");throw e.code="MODULE_NOT_FOUND",e}n.keys=function(){return[]},n.resolve=n,t.exports=n,n.id=46}}]);
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIndlYnBhY2s6Ly8vLi8yZC50cyIsIndlYnBhY2s6Ly8vLi8zZC50cyIsIndlYnBhY2s6Ly8vLi9pbmRleC50cyIsIndlYnBhY2s6Ly8vLi4vcGtnL3dvcmxkX21hcF9nZW4uanMiLCJ3ZWJwYWNrOi8vLy4uL3BrZyBzeW5jIl0sIm5hbWVzIjpbIlJlbmRlcmVyMkQiLCJbb2JqZWN0IE9iamVjdF0iLCJyb290IiwidGhpcyIsImNhbnZhcyIsImRvY3VtZW50IiwiY3JlYXRlRWxlbWVudCIsImNsYXNzTmFtZSIsImFwcGVuZENoaWxkIiwiY3R4IiwiZ2V0Q29udGV4dCIsImJvYXJkIiwiZHByIiwid2luZG93IiwiZGV2aWNlUGl4ZWxSYXRpbyIsInJlY3QiLCJnZXRCb3VuZGluZ0NsaWVudFJlY3QiLCJ3aWR0aCIsImhlaWdodCIsImNsZWFyUmVjdCIsImJlZ2luUGF0aCIsImNlbGxXaWR0aCIsImNlbGxIZWlnaHQiLCJjb2xvcnMiLCJNYXAiLCJsZWdlbmRzIiwieCIsInkiLCJjZWxsIiwiYXQiLCJraW5kIiwiY29sb3IiLCJnZXQiLCJ1bmRlZmluZWQiLCJjb2xvcl9jb2RlIiwic2V0IiwiZmlsbFN0eWxlIiwiZmlsbFJlY3QiLCJoYXMiLCJ0ZXh0IiwibGVnZW5kIiwic3Ryb2tlIiwiXzNkX1JlbmRlcmVyM0QiLCJib3RoIiwiZnJvbUhlaWdodCIsImZyb21XaWR0aCIsIk1hdGgiLCJzcXJ0IiwiY2VsbFNpemUiLCJmbG9vciIsImRldGVybWluZUNlbGxTaXplIiwicG9pbnQiLCJvYmVsaXNrIiwicGl4ZWxWaWV3IiwiY2FjaGUiLCJjYWxjQ3ViZSIsImFsdCIsImNhY2hlZCIsInJnYiIsInJnYl9jb2xvciIsImdldEJ5SG9yaXpvbnRhbENvbG9yIiwia2luZENvbG9yIiwiZGltIiwiY3ViZUF0IiwiYWx0aXR1ZGUiLCJ3b3JsZF9tYXBfZ2VuIiwiVG93biIsIlBhdGgiLCJjdWJlIiwicHQiLCJyZW5kZXJPYmplY3QiLCJnZW5lcmF0b3IiLCJuZXciLCJjdXJyZW50Qm9hcmQiLCJzZWxlY3RvciIsImdldEVsZW1lbnRCeUlkIiwib3B0aW9uIiwic2VsZWN0ZWRJbmRleCIsInZhbHVlIiwiYWRkRXZlbnRMaXN0ZW5lciIsIm9uVmlzdWFsaXphdGlvbkNoYW5nZSIsImJpbmQiLCJ3aWR0aElucHV0IiwiaGVpZ2h0SW5wdXQiLCJzY3JlZW5Sb290IiwiaW5pdFJlbmRlcmVyIiwicGFpbnRCdXR0b24iLCJyZW5kZXIiLCJkb3dubG9hZEpTT05CdXR0b24iLCJvbkRvd25sb2FkSlNPTiIsInBhcnNlSW50IiwiaXNOYU4iLCJjZWxsUGl4IiwicHJldiIsImZpcnN0Q2hpbGQiLCJyZW1vdmVDaGlsZCIsInJlbmRlcmVyIiwiRXJyb3IiLCJfIiwiYmxvYiIsIkJsb2IiLCJhc19qc29uIiwidHlwZSIsIk9iamVjdCIsIkZpbGVTYXZlcl9taW4iLCJldmVudCIsInRhcmdldCIsInRleHRDb250ZW50IiwiY2xhc3NMaXN0IiwiYWRkIiwic2V0VGltZW91dCIsInN0YXJ0IiwiRGF0ZSIsIm5vdyIsImdldFNpemUiLCJnZW5fYXV0byIsInJlbmRlcmVkIiwiaW5uZXJIVE1MIiwidmFsdWVzIiwiaXRlbSIsInN0eWxlIiwiYmFja2dyb3VuZENvbG9yIiwibmFtZSIsInJlbW92ZSIsImNvbnNvbGUiLCJsb2ciLCJfX3dlYnBhY2tfcmVxdWlyZV9fIiwiZCIsIl9fd2VicGFja19leHBvcnRzX18iLCJMYW5kS2luZCIsIl9fd2JnX25ld19iYzg5MGRmM2U1ZTZhOTFkIiwiX193YmdfY2FsbF9lMTViNmFhMGM2ZDNjOTNmIiwiX193Ymdfc2VsZl85NWFkM2YxY2RkZDVhY2NjIiwiX193YmdfY3J5cHRvX2M5M2NjNWExNDdlMzU0MjIiLCJfX3diZ19nZXRSYW5kb21WYWx1ZXNfNThiNDY0MTZlYTdhMzNhMiIsIl9fd2JnX2dldFJhbmRvbVZhbHVlc19hM2EzYzJkZDU0OTRmZDM5IiwiX193YmdfcmVxdWlyZV8zNmE4OTVmMGE0ZWEwNTI5IiwiX193YmdfcmFuZG9tRmlsbFN5bmNfZjljYjc1MzFkOWMwYjE0NCIsIl9fd2JpbmRnZW5fb2JqZWN0X2Ryb3BfcmVmIiwiX193YmluZGdlbl9pc191bmRlZmluZWQiLCJfX3diaW5kZ2VuX2pzdmFsX2VxIiwiR2VuZXJhdG9yIiwiX193YmluZGdlbl90aHJvdyIsIl93b3JsZF9tYXBfZ2VuX2JnX19XRUJQQUNLX0lNUE9SVEVEX01PRFVMRV8wX18iLCJjYWNoZWRUZXh0RGVjb2RlciIsIlRleHREZWNvZGVyIiwiY2FjaGVnZXRVaW50OE1lbW9yeSIsImdldFVpbnQ4TWVtb3J5IiwiYnVmZmVyIiwiVWludDhBcnJheSIsImdldFN0cmluZ0Zyb21XYXNtIiwicHRyIiwibGVuIiwiZGVjb2RlIiwic3ViYXJyYXkiLCJjYWNoZWRHbG9iYWxBcmd1bWVudFB0ciIsImdsb2JhbEFyZ3VtZW50UHRyIiwiY2FjaGVnZXRVaW50MzJNZW1vcnkiLCJnZXRVaW50MzJNZW1vcnkiLCJVaW50MzJBcnJheSIsImZyZWV6ZSIsIkxvdyIsIk1pZGRsZSIsIkhpZ2giLCJTZWEiLCJNb3VudGFpbiIsIkZvcmVzdCIsIlBsYWluIiwiVG9wIiwiSGlnaGxhbmQiLCJEZWVwU2VhIiwiaGVhcCIsIkFycmF5IiwiZmlsbCIsInB1c2giLCJoZWFwX25leHQiLCJsZW5ndGgiLCJhZGRIZWFwT2JqZWN0Iiwib2JqIiwiaWR4IiwiYXJnMCIsImFyZzEiLCJ2YXJnMCIsIkZ1bmN0aW9uIiwiZ2V0T2JqZWN0IiwiY2FsbCIsInNlbGYiLCJjcnlwdG8iLCJnZXRSYW5kb21WYWx1ZXMiLCJnZXRBcnJheVU4RnJvbVdhc20iLCJhcmcyIiwidmFyZzEiLCJyYW5kb21GaWxsU3luYyIsImkiLCJhIiwiYiIsIkJvYXJkIiwiY3JlYXRlIiwicHJvdG90eXBlIiwiZnJlZUJvYXJkIiwiQ2VsbCIsIl9fd3JhcCIsInJldHB0ciIsIm1lbSIsInJ1c3RwdHIiLCJydXN0bGVuIiwicmVhbFJldCIsInNsaWNlIiwiZnJlZUNlbGwiLCJwcmVzZW50IiwiZnJlZUdlbmVyYXRvciIsIndlYnBhY2tFbXB0eUNvbnRleHQiLCJyZXEiLCJlIiwiY29kZSIsImtleXMiLCJyZXNvbHZlIiwibW9kdWxlIiwiZXhwb3J0cyIsImlkIl0sIm1hcHBpbmdzIjoia0hBR2UsTUFBTUEsRUFJakJDLFlBQVlDLEdBQ1JDLEtBQUtDLE9BQVNDLFNBQVNDLGNBQWMsVUFDckNILEtBQUtDLE9BQU9HLFVBQVksU0FDeEJMLEVBQUtNLFlBQVlMLEtBQUtDLFFBRXRCRCxLQUFLTSxJQUFNTixLQUFLQyxPQUFPTSxXQUFXLE1BR3RDVCxPQUFPVSxHQUNILE1BQU1DLEVBQU1DLE9BQU9DLGtCQUFvQixFQUNqQ0MsRUFBT1osS0FBS0MsT0FBT1ksd0JBQ3pCYixLQUFLQyxPQUFPYSxNQUFRRixFQUFLRSxNQUFRTCxFQUNqQ1QsS0FBS0MsT0FBT2MsT0FBU0gsRUFBS0csT0FBU04sRUFHbkNULEtBQUtNLElBQUlVLFVBQVUsRUFBRyxFQUFHaEIsS0FBS0MsT0FBT2EsTUFBT2QsS0FBS0MsT0FBT2MsUUFFeERmLEtBQUtNLElBQUlXLFlBRVQsTUFBTUgsRUFBUU4sRUFBTU0sUUFDZEMsRUFBU1AsRUFBTU8sU0FDZkcsRUFBWWxCLEtBQUtDLE9BQU9hLE1BQVFBLEVBQ2hDSyxFQUFhbkIsS0FBS0MsT0FBT2MsT0FBU0EsRUFFbENLLEVBQVMsSUFBSUMsSUFDYkMsRUFBVSxJQUFJRCxJQUNwQixJQUFLLElBQUlFLEVBQUksRUFBR0EsRUFBSVQsRUFBT1MsSUFDdkIsSUFBSyxJQUFJQyxFQUFJLEVBQUdBLEVBQUlULEVBQVFTLElBQUssQ0FDN0IsTUFBTUMsRUFBT2pCLEVBQU1rQixHQUFHSCxFQUFHQyxHQUNuQkcsRUFBT0YsRUFBS0UsS0FDbEIsSUFBSUMsRUFBUVIsRUFBT1MsSUFBSUYsR0FTdkIsUUFSY0csSUFBVkYsUUFFY0UsS0FEZEYsRUFBUUgsRUFBS00sZUFFVFgsRUFBT1ksSUFBSUwsRUFBTUMsR0FHekI1QixLQUFLTSxJQUFJMkIsVUFBWUwsRUFDckI1QixLQUFLTSxJQUFJNEIsU0FBU1gsRUFBSUwsRUFBV00sRUFBSUws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U0FBQUEsR0FFSVIsRUFBQSxFQUF5QlEsR0FtQjdCMkQsQ0FBQTNELEdBTUF0SixhQUNBLE9BQUE0SSxFQUFBNEQsT0FBZ0MxRCxFQUFBLEtBUWhDOUksU0FBQW1MLEVBQUFDLEdBQ0EsT0FBQWUsRUFBQUssT0FBNEIxRCxFQUFBLEVBQXVCNUksS0FBQW9KLElBQUE2QixFQUFBQyxJQVVuRHBMLElBQUFtTCxFQUFBQyxFQUFBUyxHQUNBLE9BQUFNLEVBQUFLLE9BQTRCMUQsRUFBQSxFQUFrQjVJLEtBQUFvSixJQUFBNkIsRUFBQUMsRUFBQVMsS0FJdkMsU0FBQWhELEVBQUFTLEVBQUFDLEdBQ1AsVUFBQXZELE1BQUFxRCxFQUFBQyxFQUFBQyw4RkNwVUEsU0FBQTJELEVBQUFDLEdBQ0EsSUFBQUMsRUFBQSxJQUFBcEgsTUFBQSx1QkFBQW1ILEVBQUEsS0FFQSxNQURBQyxFQUFBQyxLQUFBLG1CQUNBRCxFQUVBRixFQUFBSSxLQUFBLFdBQXVDLFVBQ3ZDSixFQUFBSyxRQUFBTCxFQUNBTSxFQUFBQyxRQUFBUCxFQUNBQSxFQUFBUSxHQUFBIiwiZmlsZSI6IjIuYm9vdHN0cmFwLmpzIiwic291cmNlc0NvbnRlbnQiOlsiaW1wb3J0IHsgQm9hcmQgfSBmcm9tICd3b3JsZC1tYXAtZ2VuJztcbmltcG9ydCB7IFJlbmRlcmVyLCBSZW5kZXJlZCwgTGVnZW5kIH0gZnJvbSAnLi9yZW5kZXJlcic7XG5cbmV4cG9ydCBkZWZhdWx0IGNsYXNzIFJlbmRlcmVyMkQgaW1wbGVtZW50cyBSZW5kZXJlciB7XG4gICAgY2FudmFzOiBIVE1MQ2FudmFzRWxlbWVudDtcbiAgICBjdHg6IENhbnZhc1JlbmRlcmluZ0NvbnRleHQyRDtcblxuICAgIGNvbnN0cnVjdG9yKHJvb3Q6IEhUTUxFbGVtZW50KSB7XG4gICAgICAgIHRoaXMuY2FudmFzID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudCgnY2FudmFzJyk7XG4gICAgICAgIHRoaXMuY2FudmFzLmNsYXNzTmFtZSA9ICdzY3JlZW4nO1xuICAgICAgICByb290LmFwcGVuZENoaWxkKHRoaXMuY2FudmFzKTtcblxuICAgICAgICB0aGlzLmN0eCA9IHRoaXMuY2FudmFzLmdldENvbnRleHQoJzJkJykhO1xuICAgIH1cblxuICAgIHJlbmRlcihib2FyZDogQm9hcmQpOiBSZW5kZXJlZCB7XG4gICAgICAgIGNvbnN0IGRwciA9IHdpbmRvdy5kZXZpY2VQaXhlbFJhdGlvIHx8IDE7XG4gICAgICAgIGNvbnN0IHJlY3QgPSB0aGlzLmNhbnZhcy5nZXRCb3VuZGluZ0NsaWVudFJlY3QoKTtcbiAgICAgICAgdGhpcy5jYW52YXMud2lkdGggPSByZWN0LndpZHRoICogZHByO1xuICAgICAgICB0aGlzLmNhbnZhcy5oZWlnaHQgPSByZWN0LmhlaWdodCAqIGRwcjtcblxuICAgICAgICAvLyBDbGVhciBhdCBmaXJzdFxuICAgICAgICB0aGlzLmN0eC5jbGVhclJlY3QoMCwgMCwgdGhpcy5jYW52YXMud2lkdGgsIHRoaXMuY2FudmFzLmhlaWdodCk7XG5cbiAgICAgICAgdGhpcy5jdHguYmVnaW5QYXRoKCk7XG5cbiAgICAgICAgY29uc3Qgd2lkdGggPSBib2FyZC53aWR0aCgpO1xuICAgICAgICBjb25zdCBoZWlnaHQgPSBib2FyZC5oZWlnaHQoKTtcbiAgICAgICAgY29uc3QgY2VsbFdpZHRoID0gdGhpcy5jYW52YXMud2lkdGggLyB3aWR0aDtcbiAgICAgICAgY29uc3QgY2VsbEhlaWdodCA9IHRoaXMuY2FudmFzLmhlaWdodCAvIGhlaWdodDtcblxuICAgICAgICBjb25zdCBjb2xvcnMgPSBuZXcgTWFwPG51bWJlciwgc3RyaW5nPigpO1xuICAgICAgICBjb25zdCBsZWdlbmRzID0gbmV3IE1hcDxudW1iZXIsIExlZ2VuZD4oKTtcbiAgICAgICAgZm9yIChsZXQgeCA9IDA7IHggPCB3aWR0aDsgeCsrKSB7XG4gICAgICAgICAgICBmb3IgKGxldCB5ID0gMDsgeSA8IGhlaWdodDsgeSsrKSB7XG4gICAgICAgICAgICAgICAgY29uc3QgY2VsbCA9IGJvYXJkLmF0KHgsIHkpO1xuICAgICAgICAgICAgICAgIGNvbnN0IGtpbmQgPSBjZWxsLmtpbmQ7XG4gICAgICAgICAgICAgICAgbGV0IGNvbG9yID0gY29sb3JzLmdldChraW5kKTtcbiAgICAgICAgICAgICAgICBpZiAoY29sb3IgPT09IHVuZGVmaW5lZCkge1xuICAgICAgICAgICAgICAgICAgICBjb2xvciA9IGNlbGwuY29sb3JfY29kZSgpO1xuICAgICAgICAgICAgICAgICAgICBpZiAoY29sb3IgIT09IHVuZGVmaW5lZCkge1xuICAgICAgICAgICAgICAgICAgICAgICAgY29sb3JzLnNldChraW5kLCBjb2xvcik7XG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgdGhpcy5jdHguZmlsbFN0eWxlID0gY29sb3I7XG4gICAgICAgICAgICAgICAgdGhpcy5jdHguZmlsbFJlY3QoeCAqIGNlbGxXaWR0aCwgeSAqIGNlbGxIZWlnaHQsIGNlbGxXaWR0aCwgY2VsbEhlaWdodCk7XG4gICAgICAgICAgICAgICAgaWYgKCFsZWdlbmRzLmhhcyhraW5kKSkge1xuICAgICAgICAgICAgICAgICAgICBjb25zdCB0ZXh0ID0gY2VsbC5sZWdlbmQoKTtcbiAgICAgICAgICAgICAgICAgICAgbGVnZW5kcy5zZXQoa2luZCwgeyB0ZXh0LCBjb2xvciB9KTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cblxuICAgICAgICB0aGlzLmN0eC5zdHJva2UoKTtcblxuICAgICAgICByZXR1cm4geyBsZWdlbmRzIH07XG4gICAgfVxufVxuIiwiaW1wb3J0IHsgUG9pbnQzRCwgUG9pbnQsIEN1YmVEaW1lbnNpb24sIEN1YmVDb2xvciwgQ3ViZSwgUGl4ZWxWaWV3IH0gZnJvbSAnb2JlbGlzay5qcyc7XG5pbXBvcnQgeyBMYW5kS2luZCwgQm9hcmQsIENlbGwgfSBmcm9tICd3b3JsZC1tYXAtZ2VuJztcbmltcG9ydCB7IFJlbmRlcmVyLCBSZW5kZXJlZCwgTGVnZW5kIH0gZnJvbSAnLi9yZW5kZXJlcic7XG5cbmV4cG9ydCBkZWZhdWx0IGNsYXNzIFJlbmRlcmVyM0QgaW1wbGVtZW50cyBSZW5kZXJlciB7XG4gICAgY2FudmFzOiBIVE1MQ2FudmFzRWxlbWVudDtcblxuICAgIGNvbnN0cnVjdG9yKHJvb3Q6IEhUTUxFbGVtZW50KSB7XG4gICAgICAgIHRoaXMuY2FudmFzID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudCgnY2FudmFzJyk7XG4gICAgICAgIHRoaXMuY2FudmFzLmNsYXNzTmFtZSA9ICdzY3JlZW4nO1xuICAgICAgICByb290LmFwcGVuZENoaWxkKHRoaXMuY2FudmFzKTtcbiAgICB9XG5cbiAgICBkZXRlcm1pbmVDZWxsU2l6ZSh3aWR0aDogbnVtYmVyLCBoZWlnaHQ6IG51bWJlcikge1xuICAgICAgICBjb25zdCBib3RoID0gaGVpZ2h0ICsgd2lkdGg7XG4gICAgICAgIGNvbnN0IGZyb21IZWlnaHQgPSAoKHRoaXMuY2FudmFzLmhlaWdodCAtIDIwMCkgLyBib3RoKSAqIDI7XG4gICAgICAgIGNvbnN0IGZyb21XaWR0aCA9ICgodGhpcy5jYW52YXMud2lkdGggLyBib3RoKSAqIDIpIC8gTWF0aC5zcXJ0KDMpO1xuICAgICAgICBsZXQgY2VsbFNpemUgPSBNYXRoLmZsb29yKGZyb21IZWlnaHQgPiBmcm9tV2lkdGggPyBmcm9tV2lkdGggOiBmcm9tSGVpZ2h0KTtcbiAgICAgICAgaWYgKGNlbGxTaXplICUgMiA9PT0gMSkge1xuICAgICAgICAgICAgY2VsbFNpemUtLTtcbiAgICAgICAgfVxuICAgICAgICByZXR1cm4gY2VsbFNpemUgPiA2ID8gY2VsbFNpemUgOiA2O1xuICAgIH1cblxuICAgIHJlbmRlcihib2FyZDogQm9hcmQpOiBSZW5kZXJlZCB7XG4gICAgICAgIGNvbnN0IGRwciA9IHdpbmRvdy5kZXZpY2VQaXhlbFJhdGlvIHx8IDE7XG4gICAgICAgIGNvbnN0IHJlY3QgPSB0aGlzLmNhbnZhcy5nZXRCb3VuZGluZ0NsaWVudFJlY3QoKTtcbiAgICAgICAgdGhpcy5jYW52YXMud2lkdGggPSByZWN0LndpZHRoICogZHByO1xuICAgICAgICB0aGlzLmNhbnZhcy5oZWlnaHQgPSByZWN0LmhlaWdodCAqIGRwcjtcblxuICAgICAgICBjb25zdCB3aWR0aCA9IGJvYXJkLndpZHRoKCk7XG4gICAgICAgIGNvbnN0IGhlaWdodCA9IGJvYXJkLmhlaWdodCgpO1xuICAgICAgICBjb25zdCBjZWxsU2l6ZSA9IHRoaXMuZGV0ZXJtaW5lQ2VsbFNpemUod2lkdGgsIGhlaWdodCk7XG5cbiAgICAgICAgY29uc3QgcG9pbnQgPSBuZXcgUG9pbnQodGhpcy5jYW52YXMud2lkdGggLyAyLCBjZWxsU2l6ZSArIDk5ICogMik7XG4gICAgICAgIGNvbnN0IHBpeGVsVmlldyA9IG5ldyBQaXhlbFZpZXcodGhpcy5jYW52YXMsIHBvaW50KTtcblxuICAgICAgICBjb25zdCBjYWNoZSA9IG5ldyBNYXA8bnVtYmVyLCBDdWJlPigpOyAvLyBBbHRpdHVkZSAtPiBDdWJlXG4gICAgICAgIGNvbnN0IGNvbG9ycyA9IG5ldyBNYXA8bnVtYmVyLCBDdWJlQ29sb3I+KCk7IC8vIGtpbmQgLT4gQ3ViZUNvbG9yXG4gICAgICAgIGNvbnN0IGxlZ2VuZHMgPSBuZXcgTWFwPG51bWJlciwgTGVnZW5kPigpOyAvLyBraW5kIC0+IExlZ2VuZFxuXG4gICAgICAgIGZ1bmN0aW9uIGtpbmRDb2xvcihraW5kOiBMYW5kS2luZCwgY2VsbDogQ2VsbCk6IEN1YmVDb2xvciB7XG4gICAgICAgICAgICBjb25zdCBjYWNoZWQgPSBjb2xvcnMuZ2V0KGtpbmQpO1xuICAgICAgICAgICAgaWYgKGNhY2hlZCAhPT0gdW5kZWZpbmVkKSB7XG4gICAgICAgICAgICAgICAgcmV0dXJuIGNhY2hlZDtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGxldCByZ2IgPSBjZWxsLnJnYl9jb2xvcigpO1xuICAgICAgICAgICAgaWYgKHJnYiA9PT0gdW5kZWZpbmVkKSB7XG4gICAgICAgICAgICAgICAgcmdiID0gMHhmZmZmZmY7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBjb25zdCBjb2xvciA9IG5ldyBDdWJlQ29sb3IoKS5nZXRCeUhvcml6b250YWxDb2xvcihyZ2IpO1xuICAgICAgICAgICAgY29sb3JzLnNldChraW5kLCBjb2xvcik7XG5cbiAgICAgICAgICAgIC8vIFJlbWVtYmVyIGxlZ2VuZCBvZiB0aGUga2luZCBhbHNvXG4gICAgICAgICAgICBsZWdlbmRzLnNldChraW5kLCB7IHRleHQ6IGNlbGwubGVnZW5kKCksIGNvbG9yOiBjZWxsLmNvbG9yX2NvZGUoKSB9KTtcblxuICAgICAgICAgICAgcmV0dXJuIGNvbG9yO1xuICAgICAgICB9XG5cbiAgICAgICAgZnVuY3Rpb24gY2FsY0N1YmUoa2luZDogTGFuZEtpbmQsIGFsdDogbnVtYmVyLCBjZWxsOiBDZWxsKTogQ3ViZSB7XG4gICAgICAgICAgICBjb25zdCBjb2xvciA9IGtpbmRDb2xvcihraW5kLCBjZWxsKTtcbiAgICAgICAgICAgIGNvbnN0IGhlaWdodCA9IGNlbGxTaXplICsgYWx0ICogMjtcbiAgICAgICAgICAgIGNvbnN0IGRpbSA9IG5ldyBDdWJlRGltZW5zaW9uKGNlbGxTaXplLCBjZWxsU2l6ZSwgaGVpZ2h0KTtcbiAgICAgICAgICAgIHJldHVybiBuZXcgQ3ViZShkaW0sIGNvbG9yLCAvKmJvcmRlcjoqLyBmYWxzZSk7XG4gICAgICAgIH1cblxuICAgICAgICBmdW5jdGlvbiBjdWJlQXQoY2VsbDogQ2VsbCk6IEN1YmUge1xuICAgICAgICAgICAgY29uc3Qga2luZCA9IGNlbGwua2luZDtcbiAgICAgICAgICAgIGNvbnN0IGFsdCA9IGNlbGwuYWx0aXR1ZGU7XG5cbiAgICAgICAgICAgIGlmICghbGVnZW5kcy5oYXMoa2luZCkpIHtcbiAgICAgICAgICAgICAgICAvLyBSZW1lbWJlciBsZWdlbmQgb2YgdGhlIGtpbmQgYWxzb1xuICAgICAgICAgICAgICAgIGxlZ2VuZHMuc2V0KGtpbmQsIHsgdGV4dDogY2VsbC5sZWdlbmQoKSwgY29sb3I6IGNlbGwuY29sb3JfY29kZSgpIH0pO1xuICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICBpZiAoa2luZCA9PT0gTGFuZEtpbmQuVG93biB8fCBraW5kID09PSBMYW5kS2luZC5QYXRoKSB7XG4gICAgICAgICAgICAgICAgcmV0dXJuIGNhbGNDdWJlKGtpbmQsIGFsdCwgY2VsbCk7XG4gICAgICAgICAgICB9XG5cbiAgICAgICAgICAgIGNvbnN0IGNhY2hlZCA9IGNhY2hlLmdldChhbHQpO1xuICAgICAgICAgICAgaWYgKGNhY2hlZCAhPT0gdW5kZWZpbmVkKSB7XG4gICAgICAgICAgICAgICAgcmV0dXJuIGNhY2hlZDtcbiAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgY29uc3QgY3ViZSA9IGNhbGNDdWJlKGtpbmQsIGFsdCwgY2VsbCk7XG4gICAgICAgICAgICBjYWNoZS5zZXQoYWx0LCBjdWJlKTtcbiAgICAgICAgICAgIHJldHVybiBjdWJlO1xuICAgICAgICB9XG5cbiAgICAgICAgZm9yIChsZXQgeCA9IDA7IHggPCB3aWR0aDsgeCsrKSB7XG4gICAgICAgICAgICBmb3IgKGxldCB5ID0gMDsgeSA8IGhlaWdodDsgeSsrKSB7XG4gICAgICAgICAgICAgICAgY29uc3QgY3ViZSA9IGN1YmVBdChib2FyZC5hdCh4LCB5KSk7XG4gICAgICAgICAgICAgICAgY29uc3QgcHQgPSBuZXcgUG9pbnQzRCh4ICogY2VsbFNpemUsIHkgKiBjZWxsU2l6ZSwgMCk7XG4gICAgICAgICAgICAgICAgcGl4ZWxWaWV3LnJlbmRlck9iamVjdChjdWJlLCBwdCk7XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cblxuICAgICAgICByZXR1cm4ge1xuICAgICAgICAgICAgbGVnZW5kcyxcbiAgICAgICAgfTtcbiAgICB9XG59XG4iLCJpbXBvcnQgeyBHZW5lcmF0b3IsIEJvYXJkIH0gZnJvbSAnd29ybGQtbWFwLWdlbic7XG5pbXBvcnQgeyBzYXZlQXMgfSBmcm9tICdmaWxlLXNhdmVyJztcbmltcG9ydCBSZW5kZXJlcjJEIGZyb20gJy4vMmQnO1xuaW1wb3J0IFJlbmRlcmVyM0QgZnJvbSAnLi8zZCc7XG5pbXBvcnQgeyBSZW5kZXJlciB9IGZyb20gJy4vcmVuZGVyZXInO1xuXG5jb25zdCBhcHAgPSBuZXcgY2xhc3Mge1xuICAgIHByaXZhdGUgZ2VuZXJhdG9yOiBHZW5lcmF0b3I7XG4gICAgcHJpdmF0ZSBkaW06IHN0cmluZztcbiAgICBwcml2YXRlIGN1cnJlbnRCb2FyZDogQm9hcmQgfCBudWxsO1xuICAgIHByaXZhdGUgd2lkdGhJbnB1dDogSFRNTElucHV0RWxlbWVudDtcbiAgICBwcml2YXRlIGhlaWdodElucHV0OiBIVE1MSW5wdXRFbGVtZW50O1xuICAgIHByaXZhdGUgc2NyZWVuUm9vdDogSFRNTEVsZW1lbnQ7XG4gICAgcHJpdmF0ZSBwYWludEJ1dHRvbjogSFRNTEJ1dHRvbkVsZW1lbnQ7XG4gICAgcHJpdmF0ZSBsZWdlbmRzOiBIVE1MRWxlbWVudDtcbiAgICBwcml2YXRlIHJlbmRlcmVyOiBSZW5kZXJlcjtcbiAgICBwcml2YXRlIGRvd25sb2FkSlNPTkJ1dHRvbjogSFRNTEJ1dHRvbkVsZW1lbnQ7XG5cbiAgICBjb25zdHJ1Y3RvcigpIHtcbiAgICAgICAgdGhpcy5nZW5lcmF0b3IgPSBHZW5lcmF0b3IubmV3KCk7XG4gICAgICAgIHRoaXMuY3VycmVudEJvYXJkID0gbnVsbDtcblxuICAgICAgICBjb25zdCBzZWxlY3RvciA9IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCdkaW1lbnNpb24tc2VsZWN0b3InKSBhcyBIVE1MU2VsZWN0RWxlbWVudDtcbiAgICAgICAgY29uc3Qgb3B0aW9uID0gc2VsZWN0b3Jbc2VsZWN0b3Iuc2VsZWN0ZWRJbmRleF0gYXMgSFRNTE9wdGlvbkVsZW1lbnQ7XG4gICAgICAgIHRoaXMuZGltID0gb3B0aW9uLnZhbHVlO1xuICAgICAgICBzZWxlY3Rvci5hZGRFdmVudExpc3RlbmVyKCdjaGFuZ2UnLCB0aGlzLm9uVmlzdWFsaXphdGlvbkNoYW5nZS5iaW5kKHRoaXMpKTtcblxuICAgICAgICB0aGlzLndpZHRoSW5wdXQgPSBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgnd2lkdGgtaW5wdXQnKSBhcyBIVE1MSW5wdXRFbGVtZW50O1xuICAgICAgICB0aGlzLmhlaWdodElucHV0ID0gZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoJ2hlaWdodC1pbnB1dCcpIGFzIEhUTUxJbnB1dEVsZW1lbnQ7XG4gICAgICAgIHRoaXMuc2NyZWVuUm9vdCA9IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCdzY3JlZW4tcm9vdCcpIGFzIEhUTUxFbGVtZW50O1xuXG4gICAgICAgIHRoaXMuaW5pdFJlbmRlcmVyKCk7XG5cbiAgICAgICAgdGhpcy5wYWludEJ1dHRvbiA9IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCdwYWludC1idXR0b24nKSBhcyBIVE1MQnV0dG9uRWxlbWVudDtcbiAgICAgICAgdGhpcy5wYWludEJ1dHRvbi5hZGRFdmVudExpc3RlbmVyKCdjbGljaycsICgpID0+IHtcbiAgICAgICAgICAgIHRoaXMucmVuZGVyKCk7XG4gICAgICAgIH0pO1xuXG4gICAgICAgIHRoaXMubGVnZW5kcyA9IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCdsZWdlbmRzJykgYXMgSFRNTEVsZW1lbnQ7XG5cbiAgICAgICAgdGhpcy5kb3dubG9hZEpTT05CdXR0b24gPSBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgnZG93bmxvYWQtanNvbi1idXR0b24nKSBhcyBIVE1MQnV0dG9uRWxlbWVudDtcbiAgICAgICAgdGhpcy5kb3dubG9hZEpTT05CdXR0b24uYWRkRXZlbnRMaXN0ZW5lcignY2xpY2snLCB0aGlzLm9uRG93bmxvYWRKU09OLmJpbmQodGhpcykpO1xuICAgIH1cblxuICAgIGdldFNpemUoKSB7XG4gICAgICAgIGNvbnN0IHdpZHRoID0gcGFyc2VJbnQodGhpcy53aWR0aElucHV0LnZhbHVlLCAxMCk7XG4gICAgICAgIGNvbnN0IGhlaWdodCA9IHBhcnNlSW50KHRoaXMuaGVpZ2h0SW5wdXQudmFsdWUsIDEwKTtcbiAgICAgICAgaWYgKCFpc05hTih3aWR0aCkgJiYgIWlzTmFOKGhlaWdodCkpIHtcbiAgICAgICAgICAgIHJldHVybiBbd2lkdGgsIGhlaWdodF07XG4gICAgICAgIH1cblxuICAgICAgICBpZiAodGhpcy5kaW0gPT09ICczZCcpIHtcbiAgICAgICAgICAgIHJldHVybiBbMTIwLCAxMjBdO1xuICAgICAgICB9XG5cbiAgICAgICAgY29uc3QgcmVjdCA9IHRoaXMuc2NyZWVuUm9vdC5nZXRCb3VuZGluZ0NsaWVudFJlY3QoKTtcblxuICAgICAgICBpZiAoIWlzTmFOKHdpZHRoKSkge1xuICAgICAgICAgICAgLy8gTm90ZTogaGVpZ2h0IGlzIE5hTlxuICAgICAgICAgICAgY29uc3QgY2VsbFBpeCA9IHJlY3Qud2lkdGggLyB3aWR0aDtcbiAgICAgICAgICAgIHJldHVybiBbd2lkdGgsIE1hdGguZmxvb3IocmVjdC5oZWlnaHQgLyBjZWxsUGl4KV07XG4gICAgICAgIH0gZWxzZSBpZiAoIWlzTmFOKGhlaWdodCkpIHtcbiAgICAgICAgICAgIC8vIE5vdGU6IHdpZHRoIGlzIE5hTlxuICAgICAgICAgICAgY29uc3QgY2VsbFBpeCA9IHJlY3QuaGVpZ2h0IC8gaGVpZ2h0O1xuICAgICAgICAgICAgcmV0dXJuIFtNYXRoLmZsb29yKHJlY3Qud2lkdGggLyBjZWxsUGl4KSwgaGVpZ2h0XTtcbiAgICAgICAgfSAvKiBsb25nZXIgc2lkZSBsZW5ndGggaXMgMjAwIGNlbGxzIGJ5IGRlZmF1bHQgKi8gZWxzZSB7XG4gICAgICAgICAgICBjb25zdCBtYXggPSByZWN0LmhlaWdodCA+IHJlY3Qud2lkdGggPyByZWN0LmhlaWdodCA6IHJlY3Qud2lkdGg7XG4gICAgICAgICAgICBjb25zdCBjZWxsUGl4ID0gbWF4IC8gMjAwO1xuICAgICAgICAgICAgcmV0dXJuIFtNYXRoLmZsb29yKHJlY3Qud2lkdGggLyBjZWxsUGl4KSwgTWF0aC5mbG9vcihyZWN0LmhlaWdodCAvIGNlbGxQaXgpXTtcbiAgICAgICAgfVxuICAgIH1cblxuICAgIGluaXRSZW5kZXJlcigpIHtcbiAgICAgICAgY29uc3QgcHJldiA9IHRoaXMuc2NyZWVuUm9vdC5maXJzdENoaWxkO1xuICAgICAgICBpZiAocHJldiAhPT0gbnVsbCkge1xuICAgICAgICAgICAgdGhpcy5zY3JlZW5Sb290LnJlbW92ZUNoaWxkKHByZXYpO1xuICAgICAgICB9XG4gICAgICAgIHRoaXMuY3VycmVudEJvYXJkID0gbnVsbDtcblxuICAgICAgICBzd2l0Y2ggKHRoaXMuZGltKSB7XG4gICAgICAgICAgICBjYXNlICcyZCc6XG4gICAgICAgICAgICAgICAgdGhpcy5yZW5kZXJlciA9IG5ldyBSZW5kZXJlcjJEKHRoaXMuc2NyZWVuUm9vdCk7XG4gICAgICAgICAgICAgICAgYnJlYWs7XG4gICAgICAgICAgICBjYXNlICczZCc6XG4gICAgICAgICAgICAgICAgdGhpcy5yZW5kZXJlciA9IG5ldyBSZW5kZXJlcjNEKHRoaXMuc2NyZWVuUm9vdCk7XG4gICAgICAgICAgICAgICAgYnJlYWs7XG4gICAgICAgICAgICBkZWZhdWx0OlxuICAgICAgICAgICAgICAgIHRocm93IG5ldyBFcnJvcihgVW5rbm93biBjb250ZXh0ICR7dGhpcy5kaW19YCk7XG4gICAgICAgIH1cbiAgICB9XG5cbiAgICBvbkRvd25sb2FkSlNPTihfOiBFdmVudCkge1xuICAgICAgICBpZiAodGhpcy5jdXJyZW50Qm9hcmQgPT09IG51bGwpIHtcbiAgICAgICAgICAgIHJldHVybjtcbiAgICAgICAgfVxuICAgICAgICBjb25zdCBibG9iID0gbmV3IEJsb2IoW3RoaXMuY3VycmVudEJvYXJkLmFzX2pzb24oKV0sIHsgdHlwZTogJ3RleHQvcGxhaW47Y2hhcnNldD11dGYtOCcgfSk7XG4gICAgICAgIHNhdmVBcyhibG9iLCAnYm9hcmQuanNvbicpO1xuICAgIH1cblxuICAgIG9uVmlzdWFsaXphdGlvbkNoYW5nZShldmVudDogRXZlbnQpIHtcbiAgICAgICAgY29uc3Qgc2VsZWN0b3IgPSBldmVudC50YXJnZXQgYXMgSFRNTFNlbGVjdEVsZW1lbnQ7XG4gICAgICAgIGNvbnN0IG9wdGlvbiA9IHNlbGVjdG9yW3NlbGVjdG9yLnNlbGVjdGVkSW5kZXhdIGFzIEhUTUxPcHRpb25FbGVtZW50O1xuICAgICAgICBjb25zdCBkaW0gPSBvcHRpb24udmFsdWU7XG4gICAgICAgIGlmICh0aGlzLmRpbSA9PT0gZGltKSB7XG4gICAgICAgICAgICByZXR1cm47XG4gICAgICAgIH1cbiAgICAgICAgdGhpcy5kaW0gPSBkaW07XG4gICAgICAgIHRoaXMuaW5pdFJlbmRlcmVyKCk7XG4gICAgICAgIHRoaXMucmVuZGVyKCk7XG4gICAgfVxuXG4gICAgcmVuZGVyKCkge1xuICAgICAgICAvLyBUT0RPOiBMb2FkaW5nIGluZGljYXRvciBjYW5ub3QgYmUgZGlzcGxheWVkIHNpbmNlIG1hcCBnZW5lcmF0aW9uIGlzIHJ1biBpbiBtYWluIHRocmVhZC5cbiAgICAgICAgLy8gV2hlbiBtYXAgc2l6ZSBpcyB2ZXJ5IGxhcmdlIGFuZCBpdCBjb25zdW1lcyB0aW1lLCBDUFUgY29yZSBpcyBhbHNvIGNvbnN1bWVkIGZvciBtYWluIHRocmVhZC5cbiAgICAgICAgLy8gSW4gdGhlIGNhc2UsIG5vIGFuaW1hdGlvbiBpcyBhY3R1YWxseSByZW5kZXJlZC5cbiAgICAgICAgLy8gVG8gcHJldmVudCB0aGlzLCBtYXAgZ2VuZXJhdGlvbiBtdXN0IGJlIHJ1biBpbiBhbm90aGVyIHRocmVhZCBhbmQgUnVzdCBjYW4gZG8gaXQuXG5cbiAgICAgICAgLy8gdGhpcy5wYWludEJ1dHRvbi5jbGFzc0xpc3QuYWRkKCdpcy1sb2FkaW5nJyk7XG4gICAgICAgIHRoaXMucGFpbnRCdXR0b24udGV4dENvbnRlbnQgPSAnUGFpbnRpbmcuLi4nO1xuICAgICAgICB0aGlzLnBhaW50QnV0dG9uLmNsYXNzTGlzdC5hZGQoJ2Rpc2FibGVkJyk7XG4gICAgICAgIHRoaXMuZG93bmxvYWRKU09OQnV0dG9uLmNsYXNzTGlzdC5hZGQoJ2Rpc2FibGVkJyk7XG4gICAgICAgIC8vIFdhaXQgbmV4dCB0aWNrIHRvIGNoYW5nZSB0ZXh0XG4gICAgICAgIHdpbmRvdy5zZXRUaW1lb3V0KCgpID0+IHtcbiAgICAgICAgICAgIGNvbnN0IHN0YXJ0ID0gRGF0ZS5ub3coKTtcbiAgICAgICAgICAgIGNvbnN0IFt3aWR0aCwgaGVpZ2h0XSA9IHRoaXMuZ2V0U2l6ZSgpO1xuICAgICAgICAgICAgY29uc3QgYm9hcmQgPSB0aGlzLmdlbmVyYXRvci5nZW5fYXV0byh3aWR0aCwgaGVpZ2h0KTtcbiAgICAgICAgICAgIGNvbnN0IHJlbmRlcmVkID0gdGhpcy5yZW5kZXJlci5yZW5kZXIoYm9hcmQpO1xuXG4gICAgICAgICAgICB0aGlzLmxlZ2VuZHMuaW5uZXJIVE1MID0gJyc7XG4gICAgICAgICAgICBmb3IgKGNvbnN0IGxlZ2VuZCBvZiByZW5kZXJlZC5sZWdlbmRzLnZhbHVlcygpKSB7XG4gICAgICAgICAgICAgICAgY29uc3QgaXRlbSA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoJ2RpdicpO1xuICAgICAgICAgICAgICAgIGl0ZW0uY2xhc3NOYW1lID0gJ2xlZ2VuZCc7XG5cbiAgICAgICAgICAgICAgICBjb25zdCBjb2xvciA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoJ2RpdicpO1xuICAgICAgICAgICAgICAgIGNvbG9yLmNsYXNzTmFtZSA9ICdsZWdlbmQtY29sb3InO1xuICAgICAgICAgICAgICAgIGNvbG9yLnN0eWxlLmJhY2tncm91bmRDb2xvciA9IGxlZ2VuZC5jb2xvciB8fCAnbm9uZSc7XG4gICAgICAgICAgICAgICAgaXRlbS5hcHBlbmRDaGlsZChjb2xvcik7XG5cbiAgICAgICAgICAgICAgICBjb25zdCBuYW1lID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudCgnZGl2Jyk7XG4gICAgICAgICAgICAgICAgbmFtZS5jbGFzc05hbWUgPSAnbGVnZW5kLW5hbWUnO1xuICAgICAgICAgICAgICAgIG5hbWUudGV4dENvbnRlbnQgPSBsZWdlbmQudGV4dDtcbiAgICAgICAgICAgICAgICBpdGVtLmFwcGVuZENoaWxkKG5hbWUpO1xuXG4gICAgICAgICAgICAgICAgdGhpcy5sZWdlbmRzLmFwcGVuZENoaWxkKGl0ZW0pO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgdGhpcy5jdXJyZW50Qm9hcmQgPSBib2FyZDtcblxuICAgICAgICAgICAgLy8gdGhpcy5wYWludEJ1dHRvbi5jbGFzc0xpc3QucmVtb3ZlKCdpcy1sb2FkaW5nJyk7XG4gICAgICAgICAgICB0aGlzLnBhaW50QnV0dG9uLmNsYXNzTGlzdC5yZW1vdmUoJ2Rpc2FibGVkJyk7XG4gICAgICAgICAgICB0aGlzLnBhaW50QnV0dG9uLnRleHRDb250ZW50ID0gJ0dlbmVyYXRlJztcbiAgICAgICAgICAgIHRoaXMuZG93bmxvYWRKU09OQnV0dG9uLmNsYXNzTGlzdC5yZW1vdmUoJ2Rpc2FibGVkJyk7XG4gICAgICAgICAgICBjb25zb2xlLmxvZygnQ29uc3VtZWQ6JywgRGF0ZS5ub3coKSAtIHN0YXJ0KTtcbiAgICAgICAgfSwgMCk7XG4gICAgfVxufSgpO1xuXG5hcHAucmVuZGVyKCk7XG4iLCIvKiB0c2xpbnQ6ZGlzYWJsZSAqL1xuaW1wb3J0ICogYXMgd2FzbSBmcm9tICcuL3dvcmxkX21hcF9nZW5fYmcnO1xuXG5sZXQgY2FjaGVkVGV4dERlY29kZXIgPSBuZXcgVGV4dERlY29kZXIoJ3V0Zi04Jyk7XG5cbmxldCBjYWNoZWdldFVpbnQ4TWVtb3J5ID0gbnVsbDtcbmZ1bmN0aW9uIGdldFVpbnQ4TWVtb3J5KCkge1xuICAgIGlmIChjYWNoZWdldFVpbnQ4TWVtb3J5ID09PSBudWxsIHx8IGNhY2hlZ2V0VWludDhNZW1vcnkuYnVmZmVyICE9PSB3YXNtLm1lbW9yeS5idWZmZXIpIHtcbiAgICAgICAgY2FjaGVnZXRVaW50OE1lbW9yeSA9IG5ldyBVaW50OEFycmF5KHdhc20ubWVtb3J5LmJ1ZmZlcik7XG4gICAgfVxuICAgIHJldHVybiBjYWNoZWdldFVpbnQ4TWVtb3J5O1xufVxuXG5mdW5jdGlvbiBnZXRTdHJpbmdGcm9tV2FzbShwdHIsIGxlbikge1xuICAgIHJldHVybiBjYWNoZWRUZXh0RGVjb2Rlci5kZWNvZGUoZ2V0VWludDhNZW1vcnkoKS5zdWJhcnJheShwdHIsIHB0ciArIGxlbikpO1xufVxuXG5sZXQgY2FjaGVkR2xvYmFsQXJndW1lbnRQdHIgPSBudWxsO1xuZnVuY3Rpb24gZ2xvYmFsQXJndW1lbnRQdHIoKSB7XG4gICAgaWYgKGNhY2hlZEdsb2JhbEFyZ3VtZW50UHRyID09PSBudWxsKSB7XG4gICAgICAgIGNhY2hlZEdsb2JhbEFyZ3VtZW50UHRyID0gd2FzbS5fX3diaW5kZ2VuX2dsb2JhbF9hcmd1bWVudF9wdHIoKTtcbiAgICB9XG4gICAgcmV0dXJuIGNhY2hlZEdsb2JhbEFyZ3VtZW50UHRyO1xufVxuXG5sZXQgY2FjaGVnZXRVaW50MzJNZW1vcnkgPSBudWxsO1xuZnVuY3Rpb24gZ2V0VWludDMyTWVtb3J5KCkge1xuICAgIGlmIChjYWNoZWdldFVpbnQzMk1lbW9yeSA9PT0gbnVsbCB8fCBjYWNoZWdldFVpbnQzMk1lbW9yeS5idWZmZXIgIT09IHdhc20ubWVtb3J5LmJ1ZmZlcikge1xuICAgICAgICBjYWNoZWdldFVpbnQzMk1lbW9yeSA9IG5ldyBVaW50MzJBcnJheSh3YXNtLm1lbW9yeS5idWZmZXIpO1xuICAgIH1cbiAgICByZXR1cm4gY2FjaGVnZXRVaW50MzJNZW1vcnk7XG59XG4vKipcbiogUmVzb2x1dGlvbiBvZiB0aGUgYm9hcmQuXG4qL1xuZXhwb3J0IGNvbnN0IFJlc29sdXRpb24gPSBPYmplY3QuZnJlZXplKHsgTG93OjAsTWlkZGxlOjEsSGlnaDoyLCB9KTtcbi8qKlxuKiBSZXByZXNlbnRzIHRoZSBraW5kIG9mIGNlbGwuIGBwcmVzZXQoKWAgbWV0aG9kIHJldHVybnMgYSBwcmVzZXQgY2VsbCBjb25zdGFudHMgZm9yXG4qIHRoZSBraW5kLlxuKi9cbmV4cG9ydCBjb25zdCBMYW5kS2luZCA9IE9iamVjdC5mcmVlemUoeyBTZWE6MCxNb3VudGFpbjoxLEZvcmVzdDoyLFBsYWluOjMsVG93bjo0LFRvcDo1LEhpZ2hsYW5kOjYsRGVlcFNlYTo3LFBhdGg6OCwgfSk7XG5cbmNvbnN0IGhlYXAgPSBuZXcgQXJyYXkoMzIpO1xuXG5oZWFwLmZpbGwodW5kZWZpbmVkKTtcblxuaGVhcC5wdXNoKHVuZGVmaW5lZCwgbnVsbCwgdHJ1ZSwgZmFsc2UpO1xuXG5sZXQgaGVhcF9uZXh0ID0gaGVhcC5sZW5ndGg7XG5cbmZ1bmN0aW9uIGFkZEhlYXBPYmplY3Qob2JqKSB7XG4gICAgaWYgKGhlYXBfbmV4dCA9PT0gaGVhcC5sZW5ndGgpIGhlYXAucHVzaChoZWFwLmxlbmd0aCArIDEpO1xuICAgIGNvbnN0IGlkeCA9IGhlYXBfbmV4dDtcbiAgICBoZWFwX25leHQgPSBoZWFwW2lkeF07XG5cbiAgICBoZWFwW2lkeF0gPSBvYmo7XG4gICAgcmV0dXJuIGlkeDtcbn1cblxuZXhwb3J0IGZ1bmN0aW9uIF9fd2JnX25ld19iYzg5MGRmM2U1ZTZhOTFkKGFyZzAsIGFyZzEpIHtcbiAgICBsZXQgdmFyZzAgPSBnZXRTdHJpbmdGcm9tV2FzbShhcmcwLCBhcmcxKTtcbiAgICByZXR1cm4gYWRkSGVhcE9iamVjdChuZXcgRnVuY3Rpb24odmFyZzApKTtcbn1cblxuZnVuY3Rpb24gZ2V0T2JqZWN0KGlkeCkgeyByZXR1cm4gaGVhcFtpZHhdOyB9XG5cbmV4cG9ydCBmdW5jdGlvbiBfX3diZ19jYWxsX2UxNWI2YWEwYzZkM2M5M2YoYXJnMCwgYXJnMSkge1xuICAgIHJldHVybiBhZGRIZWFwT2JqZWN0KGdldE9iamVjdChhcmcwKS5jYWxsKGdldE9iamVjdChhcmcxKSkpO1xufVxuXG5leHBvcnQgZnVuY3Rpb24gX193Ymdfc2VsZl85NWFkM2YxY2RkZDVhY2NjKGFyZzApIHtcbiAgICByZXR1cm4gYWRkSGVhcE9iamVjdChnZXRPYmplY3QoYXJnMCkuc2VsZik7XG59XG5cbmV4cG9ydCBmdW5jdGlvbiBfX3diZ19jcnlwdG9fYzkzY2M1YTE0N2UzNTQyMihhcmcwKSB7XG4gICAgcmV0dXJuIGFkZEhlYXBPYmplY3QoZ2V0T2JqZWN0KGFyZzApLmNyeXB0byk7XG59XG5cbmV4cG9ydCBmdW5jdGlvbiBfX3diZ19nZXRSYW5kb21WYWx1ZXNfNThiNDY0MTZlYTdhMzNhMihhcmcwKSB7XG4gICAgcmV0dXJuIGFkZEhlYXBPYmplY3QoZ2V0T2JqZWN0KGFyZzApLmdldFJhbmRvbVZhbHVlcyk7XG59XG5cbmZ1bmN0aW9uIGdldEFycmF5VThGcm9tV2FzbShwdHIsIGxlbikge1xuICAgIHJldHVybiBnZXRVaW50OE1lbW9yeSgpLnN1YmFycmF5KHB0ciAvIDEsIHB0ciAvIDEgKyBsZW4pO1xufVxuXG5leHBvcnQgZnVuY3Rpb24gX193YmdfZ2V0UmFuZG9tVmFsdWVzX2EzYTNjMmRkNTQ5NGZkMzkoYXJnMCwgYXJnMSwgYXJnMikge1xuICAgIGxldCB2YXJnMSA9IGdldEFycmF5VThGcm9tV2FzbShhcmcxLCBhcmcyKTtcbiAgICBnZXRPYmplY3QoYXJnMCkuZ2V0UmFuZG9tVmFsdWVzKHZhcmcxKTtcbn1cblxuZXhwb3J0IGZ1bmN0aW9uIF9fd2JnX3JlcXVpcmVfMzZhODk1ZjBhNGVhMDUyOShhcmcwLCBhcmcxKSB7XG4gICAgbGV0IHZhcmcwID0gZ2V0U3RyaW5nRnJvbVdhc20oYXJnMCwgYXJnMSk7XG4gICAgcmV0dXJuIGFkZEhlYXBPYmplY3QocmVxdWlyZSh2YXJnMCkpO1xufVxuXG5leHBvcnQgZnVuY3Rpb24gX193YmdfcmFuZG9tRmlsbFN5bmNfZjljYjc1MzFkOWMwYjE0NChhcmcwLCBhcmcxLCBhcmcyKSB7XG4gICAgbGV0IHZhcmcxID0gZ2V0QXJyYXlVOEZyb21XYXNtKGFyZzEsIGFyZzIpO1xuICAgIGdldE9iamVjdChhcmcwKS5yYW5kb21GaWxsU3luYyh2YXJnMSk7XG59XG5cbmZ1bmN0aW9uIGRyb3BPYmplY3QoaWR4KSB7XG4gICAgaWYgKGlkeCA8IDM2KSByZXR1cm47XG4gICAgaGVhcFtpZHhdID0gaGVhcF9uZXh0O1xuICAgIGhlYXBfbmV4dCA9IGlkeDtcbn1cblxuZXhwb3J0IGZ1bmN0aW9uIF9fd2JpbmRnZW5fb2JqZWN0X2Ryb3BfcmVmKGkpIHsgZHJvcE9iamVjdChpKTsgfVxuXG5leHBvcnQgZnVuY3Rpb24gX193YmluZGdlbl9pc191bmRlZmluZWQoaWR4KSB7XG4gICAgcmV0dXJuIGdldE9iamVjdChpZHgpID09PSB1bmRlZmluZWQgPyAxIDogMDtcbn1cblxuZXhwb3J0IGZ1bmN0aW9uIF9fd2JpbmRnZW5fanN2YWxfZXEoYSwgYikge1xuICAgIHJldHVybiBnZXRPYmplY3QoYSkgPT09IGdldE9iamVjdChiKSA/IDEgOiAwO1xufVxuXG5mdW5jdGlvbiBmcmVlQm9hcmQocHRyKSB7XG5cbiAgICB3YXNtLl9fd2JnX2JvYXJkX2ZyZWUocHRyKTtcbn1cbi8qKlxuKiBSZXByZXNlbnRzIG9uZSBib2FyZCBnZW5lcmF0ZWQgYnkgcmFuZG9tIG1hcCBnZW5lcmF0b3IuXG4qL1xuZXhwb3J0IGNsYXNzIEJvYXJkIHtcblxuICAgIHN0YXRpYyBfX3dyYXAocHRyKSB7XG4gICAgICAgIGNvbnN0IG9iaiA9IE9iamVjdC5jcmVhdGUoQm9hcmQucHJvdG90eXBlKTtcbiAgICAgICAgb2JqLnB0ciA9IHB0cjtcblxuICAgICAgICByZXR1cm4gb2JqO1xuICAgIH1cblxuICAgIGZyZWUoKSB7XG4gICAgICAgIGNvbnN0IHB0ciA9IHRoaXMucHRyO1xuICAgICAgICB0aGlzLnB0ciA9IDA7XG4gICAgICAgIGZyZWVCb2FyZChwdHIpO1xuICAgIH1cblxuICAgIC8qKlxuICAgICogUmV0dXJucyB3aWR0aCBhcyBudW1iZXIgb2YgY2VsbHMgaW4gbnVtYmVyXG4gICAgKiBAcmV0dXJucyB7bnVtYmVyfVxuICAgICovXG4gICAgd2lkdGgoKSB7XG4gICAgICAgIHJldHVybiB3YXNtLmJvYXJkX3dpZHRoKHRoaXMucHRyKTtcbiAgICB9XG4gICAgLyoqXG4gICAgKiBSZXR1cm5zIGhlaWdodCBhcyBudW1iZXIgb2YgY2VsbHMgaW4gbnVtYmVyXG4gICAgKiBAcmV0dXJucyB7bnVtYmVyfVxuICAgICovXG4gICAgaGVpZ2h0KCkge1xuICAgICAgICByZXR1cm4gd2FzbS5ib2FyZF9oZWlnaHQodGhpcy5wdHIpO1xuICAgIH1cbiAgICAvKipcbiAgICAqIFJldHVybnMgY2VsbCBhdCBwb3NpdGlvbiAoeCwgeSkuXG4gICAgKiBAcGFyYW0ge251bWJlcn0gYXJnMFxuICAgICogQHBhcmFtIHtudW1iZXJ9IGFyZzFcbiAgICAqIEByZXR1cm5zIHtDZWxsfVxuICAgICovXG4gICAgYXQoYXJnMCwgYXJnMSkge1xuICAgICAgICByZXR1cm4gQ2VsbC5fX3dyYXAod2FzbS5ib2FyZF9hdCh0aGlzLnB0ciwgYXJnMCwgYXJnMSkpO1xuICAgIH1cbiAgICAvKipcbiAgICAqIFJldHVybnMgYSBib2FyZCBieSBzZXJpYWxpemluZyBhcyBKU09OLiBPbiBmYWlsdXJlLCBpdCByZXR1cm5zIGBOb25lYCAoYHVuZGVmaW5lZGAgaW5cbiAgICAqIEphdmFTY3JpcHQpXG4gICAgKiBAcmV0dXJucyB7c3RyaW5nfVxuICAgICovXG4gICAgYXNfanNvbigpIHtcbiAgICAgICAgY29uc3QgcmV0cHRyID0gZ2xvYmFsQXJndW1lbnRQdHIoKTtcbiAgICAgICAgd2FzbS5ib2FyZF9hc19qc29uKHJldHB0ciwgdGhpcy5wdHIpO1xuICAgICAgICBjb25zdCBtZW0gPSBnZXRVaW50MzJNZW1vcnkoKTtcbiAgICAgICAgY29uc3QgcnVzdHB0ciA9IG1lbVtyZXRwdHIgLyA0XTtcbiAgICAgICAgY29uc3QgcnVzdGxlbiA9IG1lbVtyZXRwdHIgLyA0ICsgMV07XG4gICAgICAgIGlmIChydXN0cHRyID09PSAwKSByZXR1cm47XG4gICAgICAgIGNvbnN0IHJlYWxSZXQgPSBnZXRTdHJpbmdGcm9tV2FzbShydXN0cHRyLCBydXN0bGVuKS5zbGljZSgpO1xuICAgICAgICB3YXNtLl9fd2JpbmRnZW5fZnJlZShydXN0cHRyLCBydXN0bGVuICogMSk7XG4gICAgICAgIHJldHVybiByZWFsUmV0O1xuXG4gICAgfVxufVxuXG5mdW5jdGlvbiBmcmVlQ2VsbChwdHIpIHtcblxuICAgIHdhc20uX193YmdfY2VsbF9mcmVlKHB0cik7XG59XG4vKipcbiogUmVwcmVzZW50cyBvbmUgY2VsbCBpbiBib2FyZC4gSW4gY29udHJhc3QgdG8gYGxhbmQ6OkxhbmRgLCBpdCBvbmx5IGNvbnRhaW5zIGl0cyBsYW5kIGtpbmQgYW5kXG4qIGFsdGl0dWRlIGluIG9yZGVyIHRvIHJlZHVjZSB0b3RhbCBtZW1vcnkgc2l6ZS5cbiovXG5leHBvcnQgY2xhc3MgQ2VsbCB7XG5cbiAgICBzdGF0aWMgX193cmFwKHB0cikge1xuICAgICAgICBjb25zdCBvYmogPSBPYmplY3QuY3JlYXRlKENlbGwucHJvdG90eXBlKTtcbiAgICAgICAgb2JqLnB0ciA9IHB0cjtcblxuICAgICAgICByZXR1cm4gb2JqO1xuICAgIH1cblxuICAgIGZyZWUoKSB7XG4gICAgICAgIGNvbnN0IHB0ciA9IHRoaXMucHRyO1xuICAgICAgICB0aGlzLnB0ciA9IDA7XG4gICAgICAgIGZyZWVDZWxsKHB0cik7XG4gICAgfVxuXG4gICAgLyoqXG4gICAgKiBAcmV0dXJucyB7bnVtYmVyfVxuICAgICovXG4gICAgZ2V0IGtpbmQoKSB7XG4gICAgICAgIHJldHVybiB3YXNtLl9fd2JnX2dldF9jZWxsX2tpbmQodGhpcy5wdHIpO1xuICAgIH1cbiAgICBzZXQga2luZChhcmcwKSB7XG4gICAgICAgIHJldHVybiB3YXNtLl9fd2JnX3NldF9jZWxsX2tpbmQodGhpcy5wdHIsIGFyZzApO1xuICAgIH1cbiAgICAvKipcbiAgICAqIEByZXR1cm5zIHtudW1iZXJ9XG4gICAgKi9cbiAgICBnZXQgYWx0aXR1ZGUoKSB7XG4gICAgICAgIHJldHVybiB3YXNtLl9fd2JnX2dldF9jZWxsX2FsdGl0dWRlKHRoaXMucHRyKTtcbiAgICB9XG4gICAgc2V0IGFsdGl0dWRlKGFyZzApIHtcbiAgICAgICAgcmV0dXJuIHdhc20uX193Ymdfc2V0X2NlbGxfYWx0aXR1ZGUodGhpcy5wdHIsIGFyZzApO1xuICAgIH1cbiAgICAvKipcbiAgICAqIFJldHVybnMgY29sb3IgY29kZSBvZiBsYW5kIGFzIGAjcnJnZ2JiYCBmb3JtYXQgc3RyaW5nIGZyb20gbGFuZCBraW5kLlxuICAgICogV2hlbiBubyBjb2xvciBpcyBzZXQsIHJldHVybnMgYE5vbmVgLiBJdCBtZWFucyBgdW5kZWZpbmVkYCBpbiBKYXZhU2NyaXB0IHNpZGUuXG4gICAgKiBAcmV0dXJucyB7c3RyaW5nfVxuICAgICovXG4gICAgY29sb3JfY29kZSgpIHtcbiAgICAgICAgY29uc3QgcmV0cHRyID0gZ2xvYmFsQXJndW1lbnRQdHIoKTtcbiAgICAgICAgd2FzbS5jZWxsX2NvbG9yX2NvZGUocmV0cHRyLCB0aGlzLnB0cik7XG4gICAgICAgIGNvbnN0IG1lbSA9IGdldFVpbnQzMk1lbW9yeSgpO1xuICAgICAgICBjb25zdCBydXN0cHRyID0gbWVtW3JldHB0ciAvIDRdO1xuICAgICAgICBjb25zdCBydXN0bGVuID0gbWVtW3JldHB0ciAvIDQgKyAxXTtcbiAgICAgICAgaWYgKHJ1c3RwdHIgPT09IDApIHJldHVybjtcbiAgICAgICAgY29uc3QgcmVhbFJldCA9IGdldFN0cmluZ0Zyb21XYXNtKHJ1c3RwdHIsIHJ1c3RsZW4pLnNsaWNlKCk7XG4gICAgICAgIHdhc20uX193YmluZGdlbl9mcmVlKHJ1c3RwdHIsIHJ1c3RsZW4gKiAxKTtcbiAgICAgICAgcmV0dXJuIHJlYWxSZXQ7XG5cbiAgICB9XG4gICAgLyoqXG4gICAgKiBSZXR1cm5zIFJHQiBjb2xvciBhcyB1MzIuIDB+OCBiaXRzIGZvciBCLCA5fjE2IGJpdHMgZm9yIEcsIDE3fjI0IGJpdHMgZm9yIFIuXG4gICAgKiBXaGVuIG5vIGNvbG9yIGlzIHNldCwgcmV0dXJucyBgTm9uZWAuIEl0IG1lYW5zIGB1bmRlZmluZWRgIGluIEphdmFTY3JpcHQgc2lkZS5cbiAgICAqIEByZXR1cm5zIHtudW1iZXIgfCB1bmRlZmluZWR9XG4gICAgKi9cbiAgICByZ2JfY29sb3IoKSB7XG4gICAgICAgIGNvbnN0IHJldHB0ciA9IGdsb2JhbEFyZ3VtZW50UHRyKCk7XG5cbiAgICAgICAgd2FzbS5jZWxsX3JnYl9jb2xvcihyZXRwdHIsIHRoaXMucHRyKTtcbiAgICAgICAgY29uc3QgcHJlc2VudCA9IGdldFVpbnQzMk1lbW9yeSgpW3JldHB0ciAvIDRdO1xuICAgICAgICBjb25zdCB2YWx1ZSA9IGdldFVpbnQzMk1lbW9yeSgpW3JldHB0ciAvIDQgKyAxXTtcbiAgICAgICAgcmV0dXJuIHByZXNlbnQgPT09IDAgPyB1bmRlZmluZWQgOiB2YWx1ZTtcblxuICAgIH1cbiAgICAvKipcbiAgICAqIFJldHVybnMgbGVnZW5kIG9mIGxhbmQgYXMgc3RyaW5nIGZyb20gbGFuZCBraW5kLlxuICAgICogQHJldHVybnMge3N0cmluZ31cbiAgICAqL1xuICAgIGxlZ2VuZCgpIHtcbiAgICAgICAgY29uc3QgcmV0cHRyID0gZ2xvYmFsQXJndW1lbnRQdHIoKTtcbiAgICAgICAgd2FzbS5jZWxsX2xlZ2VuZChyZXRwdHIsIHRoaXMucHRyKTtcbiAgICAgICAgY29uc3QgbWVtID0gZ2V0VWludDMyTWVtb3J5KCk7XG4gICAgICAgIGNvbnN0IHJ1c3RwdHIgPSBtZW1bcmV0cHRyIC8gNF07XG4gICAgICAgIGNvbnN0IHJ1c3RsZW4gPSBtZW1bcmV0cHRyIC8gNCArIDFdO1xuXG4gICAgICAgIGNvbnN0IHJlYWxSZXQgPSBnZXRTdHJpbmdGcm9tV2FzbShydXN0cHRyLCBydXN0bGVuKS5zbGljZSgpO1xuICAgICAgICB3YXNtLl9fd2JpbmRnZW5fZnJlZShydXN0cHRyLCBydXN0bGVuICogMSk7XG4gICAgICAgIHJldHVybiByZWFsUmV0O1xuXG4gICAgfVxufVxuXG5mdW5jdGlvbiBmcmVlR2VuZXJhdG9yKHB0cikge1xuXG4gICAgd2FzbS5fX3diZ19nZW5lcmF0b3JfZnJlZShwdHIpO1xufVxuLyoqXG4qIFJlcHJlc2VudHMgcmFuZG9tIG1hcCBnZW5lcmF0b3IuIEluIGNvbnRyYXN0IHRvIGBnZW46OlJhbmRvbUJvYXJkR2VuYCwgaXQgb25seSBwcm92aWRlcyBsaW1pdGVkXG4qIGZ1bmN0aW9uYWxpdHkuIEl0IGNhbm5vdCBiZSBpbml0aWFsaXplZCB3aXRoIHNwZWNpZmljIHNlZWQuIEFuZCBtYXAgcmVzb2x1dGlvbiBpcyBhbHdheXMgZGV0ZWN0ZWRcbiogZnJvbSBpdHMgc2l6ZS5cbiovXG5leHBvcnQgY2xhc3MgR2VuZXJhdG9yIHtcblxuICAgIHN0YXRpYyBfX3dyYXAocHRyKSB7XG4gICAgICAgIGNvbnN0IG9iaiA9IE9iamVjdC5jcmVhdGUoR2VuZXJhdG9yLnByb3RvdHlwZSk7XG4gICAgICAgIG9iai5wdHIgPSBwdHI7XG5cbiAgICAgICAgcmV0dXJuIG9iajtcbiAgICB9XG5cbiAgICBmcmVlKCkge1xuICAgICAgICBjb25zdCBwdHIgPSB0aGlzLnB0cjtcbiAgICAgICAgdGhpcy5wdHIgPSAwO1xuICAgICAgICBmcmVlR2VuZXJhdG9yKHB0cik7XG4gICAgfVxuXG4gICAgLyoqXG4gICAgKiBAcmV0dXJucyB7R2VuZXJhdG9yfVxuICAgICovXG4gICAgc3RhdGljIG5ldygpIHtcbiAgICAgICAgcmV0dXJuIEdlbmVyYXRvci5fX3dyYXAod2FzbS5nZW5lcmF0b3JfbmV3KCkpO1xuICAgIH1cbiAgICAvKipcbiAgICAqIEdlbmVyYXRlcyByYW5kb20gbWFwIGJvYXJkIHdpdGggZ2l2ZW4gd2lkdGggYW5kIGhlaWdodC4gUGFyYW1ldGVycyBhcmUgaW4gbnVtYmVyIG9mIGNlbGxzLlxuICAgICogQHBhcmFtIHtudW1iZXJ9IGFyZzBcbiAgICAqIEBwYXJhbSB7bnVtYmVyfSBhcmcxXG4gICAgKiBAcmV0dXJucyB7Qm9hcmR9XG4gICAgKi9cbiAgICBnZW5fYXV0byhhcmcwLCBhcmcxKSB7XG4gICAgICAgIHJldHVybiBCb2FyZC5fX3dyYXAod2FzbS5nZW5lcmF0b3JfZ2VuX2F1dG8odGhpcy5wdHIsIGFyZzAsIGFyZzEpKTtcbiAgICB9XG4gICAgLyoqXG4gICAgKiBHZW5lcmF0ZXMgcmFuZG9tIG1hcCBib2FyZCB3aXRoIGdpdmVuIHJlc29sdXRpb24sIHdpZHRoIGFuZCBoZWlnaHQuIFdpZHRoIGFuZCBoZWlnaHQgYXJlXG4gICAgKiBpbiBudW1iZXIgb2YgY2VsbHMuXG4gICAgKiBAcGFyYW0ge251bWJlcn0gYXJnMFxuICAgICogQHBhcmFtIHtudW1iZXJ9IGFyZzFcbiAgICAqIEBwYXJhbSB7bnVtYmVyfSBhcmcyXG4gICAgKiBAcmV0dXJucyB7Qm9hcmR9XG4gICAgKi9cbiAgICBnZW4oYXJnMCwgYXJnMSwgYXJnMikge1xuICAgICAgICByZXR1cm4gQm9hcmQuX193cmFwKHdhc20uZ2VuZXJhdG9yX2dlbih0aGlzLnB0ciwgYXJnMCwgYXJnMSwgYXJnMikpO1xuICAgIH1cbn1cblxuZXhwb3J0IGZ1bmN0aW9uIF9fd2JpbmRnZW5fdGhyb3cocHRyLCBsZW4pIHtcbiAgICB0aHJvdyBuZXcgRXJyb3IoZ2V0U3RyaW5nRnJvbVdhc20ocHRyLCBsZW4pKTtcbn1cblxuIiwiZnVuY3Rpb24gd2VicGFja0VtcHR5Q29udGV4dChyZXEpIHtcblx0dmFyIGUgPSBuZXcgRXJyb3IoXCJDYW5ub3QgZmluZCBtb2R1bGUgJ1wiICsgcmVxICsgXCInXCIpO1xuXHRlLmNvZGUgPSAnTU9EVUxFX05PVF9GT1VORCc7XG5cdHRocm93IGU7XG59XG53ZWJwYWNrRW1wdHlDb250ZXh0LmtleXMgPSBmdW5jdGlvbigpIHsgcmV0dXJuIFtdOyB9O1xud2VicGFja0VtcHR5Q29udGV4dC5yZXNvbHZlID0gd2VicGFja0VtcHR5Q29udGV4dDtcbm1vZHVsZS5leHBvcnRzID0gd2VicGFja0VtcHR5Q29udGV4dDtcbndlYnBhY2tFbXB0eUNvbnRleHQuaWQgPSA0NjsiXSwic291cmNlUm9vdCI6IiJ9