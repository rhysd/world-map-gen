(window.webpackJsonp=window.webpackJsonp||[]).push([[2],{1:function(t,n,e){"use strict";e.r(n);var i=e(2);class r{constructor(t){this.canvas=document.createElement("canvas"),this.canvas.className="screen",t.appendChild(this.canvas),this.ctx=this.canvas.getContext("2d")}render(t){const n=window.devicePixelRatio||1,e=this.canvas.getBoundingClientRect();this.canvas.width=e.width*n,this.canvas.height=e.height*n,this.ctx.clearRect(0,0,this.canvas.width,this.canvas.height),this.ctx.beginPath();const i=t.width,r=t.height,s=this.canvas.width/i,o=this.canvas.height/r,c=new Map;for(let n=0;n<i;n++)for(let e=0;e<r;e++){const i=t.at(n,e).kind;let r=c.get(i);void 0===r&&(r=t.land_color_code(i),c.set(i,r)),this.ctx.fillStyle=r,this.ctx.fillRect(n*s,e*o,s,o)}this.ctx.stroke()}}var s=e(30);class o{constructor(t){this.canvas=document.createElement("canvas"),this.canvas.className="screen",t.appendChild(this.canvas)}determineCellSize(t,n){const e=n+t,i=(this.canvas.height-200)/e*2,r=this.canvas.width/e*2/Math.sqrt(3);let s=Math.floor(i>r?r:i);return s%2==1&&s--,s>6?s:6}render(t){const n=window.devicePixelRatio||1,e=this.canvas.getBoundingClientRect();this.canvas.width=e.width*n,this.canvas.height=e.height*n;const r=t.width,o=t.height,c=this.determineCellSize(r,o),u=new s.Point(this.canvas.width/2,c+99),a=new s.PixelView(this.canvas,u),h=new Map,d=new Map;function l(n,e){const i=function(n){const e=d.get(n);if(void 0!==e)return e;let i=t.land_rgb_color(n);void 0===i&&(i=16777215);const r=(new s.CubeColor).getByHorizontalColor(i);return d.set(n,r),r}(n),r=c+2*e,o=new s.CubeDimension(c,c,r);return new s.Cube(o,i,!1)}function f(t){const n=t.kind,e=t.altitude;if(n===i.b.Town||n===i.b.Path)return l(n,e);const r=h.get(e);if(void 0!==r)return r;const s=l(n,e);return h.set(e,s),s}for(let n=0;n<r;n++)for(let e=0;e<o;e++){const i=f(t.at(n,e)),r=new s.Point3D(n*c,e*c,0);a.renderObject(i,r)}}}(new class{constructor(){this.generator=i.a.new();const t=document.getElementById("dimension-selector"),n=t[t.selectedIndex];this.dim=n.value,t.addEventListener("change",this.onVisualizationChange.bind(this)),this.widthInput=document.getElementById("width-input"),this.heightInput=document.getElementById("height-input"),this.screenRoot=document.getElementById("screen-root"),this.initRenderer(),this.paintButton=document.getElementById("paint-button"),this.paintButton.addEventListener("click",()=>{this.render()})}getSize(){const t=parseInt(this.widthInput.value,10),n=parseInt(this.heightInput.value,10);if(!isNaN(t)&&!isNaN(n))return[t,n];if("3d"===this.dim)return[120,120];const e=this.screenRoot.getBoundingClientRect();if(isNaN(t)){if(isNaN(n)){const t=(e.height>e.width?e.height:e.width)/200;return[Math.floor(e.width/t),Math.floor(e.height/t)]}{const t=e.height/n;return[Math.floor(e.width/t),n]}}{const n=e.width/t;return[t,Math.floor(e.height/n)]}}initRenderer(){const t=this.screenRoot.firstChild;switch(null!==t&&this.screenRoot.removeChild(t),this.dim){case"2d":this.renderer=new r(this.screenRoot);break;case"3d":this.renderer=new o(this.screenRoot);break;default:throw new Error(`Unknown context ${this.dim}`)}}onVisualizationChange(t){const n=t.target,e=n[n.selectedIndex].value;this.dim!==e&&(this.dim=e,this.initRenderer(),this.render())}render(){this.paintButton.textContent="Painting...",this.paintButton.classList.add("disabled"),window.setTimeout(()=>{const t=Date.now(),[n,e]=this.getSize(),i=this.generator.gen_auto(n,e);this.renderer.render(i),this.paintButton.classList.remove("disabled"),this.paintButton.textContent="Paint",console.log("Consumed:",Date.now()-t)},0)}}).render()},2:function(t,n,e){"use strict";e.d(n,"b",function(){return l}),e.d(n,"g",function(){return g}),e.d(n,"c",function(){return m}),e.d(n,"j",function(){return b}),e.d(n,"d",function(){return _}),e.d(n,"e",function(){return C}),e.d(n,"f",function(){return y}),e.d(n,"i",function(){return R}),e.d(n,"h",function(){return B}),e.d(n,"m",function(){return k}),e.d(n,"k",function(){return E}),e.d(n,"l",function(){return I}),e.d(n,"a",function(){return N}),e.d(n,"n",function(){return z});var i=e(43);Object.freeze({Low:0,Middle:1,High:2});let r=new TextDecoder("utf-8"),s=null;function o(){return null!==s&&s.buffer===i.u.buffer||(s=new Uint8Array(i.u.buffer)),s}function c(t,n){return r.decode(o().subarray(t,t+n))}let u=null;function a(){return null===u&&(u=i.m()),u}let h=null;function d(){return null!==h&&h.buffer===i.u.buffer||(h=new Uint32Array(i.u.buffer)),h}const l=Object.freeze({Sea:0,Mountain:1,Forest:2,Plain:3,Town:4,Top:5,Highland:6,DeepSea:7,Path:8}),f=new Array(32);f.fill(void 0),f.push(void 0,null,!0,!1);let w=f.length;function p(t){w===f.length&&f.push(f.length+1);const n=w;return w=f[n],f[n]=t,n}function g(t,n){let e=c(t,n);return p(new Function(e))}function v(t){return f[t]}function m(t,n){return p(v(t).call(v(n)))}function b(t){return p(v(t).self)}function _(t){return p(v(t).crypto)}function C(t){return p(v(t).getRandomValues)}function x(t,n){return o().subarray(t/1,t/1+n)}function y(t,n,e){let i=x(n,e);v(t).getRandomValues(i)}function R(t,n){let i=c(t,n);return p(e(44)(i))}function B(t,n,e){let i=x(n,e);v(t).randomFillSync(i)}function k(t){var n;(n=t)<36||(f[n]=w,w=n)}function E(t){return void 0===v(t)?1:0}function I(t,n){return v(t)===v(n)?1:0}class M{static __wrap(t){const n=Object.create(M.prototype);return n.ptr=t,n}free(){const t=this.ptr;this.ptr=0,function(t){i.b(t)}(t)}get kind(){return i.g(this.ptr)}set kind(t){return i.k(this.ptr,t)}get altitude(){return i.f(this.ptr)}set altitude(t){return i.j(this.ptr,t)}}class N{static __wrap(t){const n=Object.create(N.prototype);return n.ptr=t,n}free(){const t=this.ptr;this.ptr=0,function(t){i.c(t)}(t)}static new(){return N.__wrap(i.t())}gen_auto(t,n){return P.__wrap(i.s(this.ptr,t,n))}gen(t,n,e){return P.__wrap(i.r(this.ptr,t,n,e))}}class P{static __wrap(t){const n=Object.create(P.prototype);return n.ptr=t,n}free(){const t=this.ptr;this.ptr=0,function(t){i.a(t)}(t)}get width(){return i.e(this.ptr)}set width(t){return i.i(this.ptr,t)}get height(){return i.d(this.ptr)}set height(t){return i.h(this.ptr,t)}at(t,n){return M.__wrap(i.n(this.ptr,t,n))}land_color_code(t){const n=a();i.o(n,this.ptr,t);const e=d(),r=e[n/4],s=e[n/4+1],o=c(r,s).slice();return i.l(r,1*s),o}land_rgb_color(t){const n=a();i.q(n,this.ptr,t);const e=d()[n/4],r=d()[n/4+1];return 0===e?void 0:r}land_legend(t){const n=a();i.p(n,this.ptr,t);const e=d(),r=e[n/4],s=e[n/4+1],o=c(r,s).slice();return i.l(r,1*s),o}}function z(t,n){throw new Error(c(t,n))}},43:function(t,n,e){"use strict";var i=e.w[t.i];t.exports=i;e(2);i.v()},44:function(t,n){function e(t){var n=new Error("Cannot find module '"+t+"'");throw n.code="MODULE_NOT_FOUND",n}e.keys=function(){return[]},e.resolve=e,t.exports=e,e.id=44}}]);
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIndlYnBhY2s6Ly8vLi8yZC50cyIsIndlYnBhY2s6Ly8vLi8zZC50cyIsIndlYnBhY2s6Ly8vLi9pbmRleC50cyIsIndlYnBhY2s6Ly8vLi4vcGtnL3dvcmxkX21hcF9nZW4uanMiLCJ3ZWJwYWNrOi8vLy4uL3BrZyBzeW5jIl0sIm5hbWVzIjpbIlJlbmRlcmVyMkQiLCJbb2JqZWN0IE9iamVjdF0iLCJyb290IiwidGhpcyIsImNhbnZhcyIsImRvY3VtZW50IiwiY3JlYXRlRWxlbWVudCIsImNsYXNzTmFtZSIsImFwcGVuZENoaWxkIiwiY3R4IiwiZ2V0Q29udGV4dCIsImJvYXJkIiwiZHByIiwid2luZG93IiwiZGV2aWNlUGl4ZWxSYXRpbyIsInJlY3QiLCJnZXRCb3VuZGluZ0NsaWVudFJlY3QiLCJ3aWR0aCIsImhlaWdodCIsImNsZWFyUmVjdCIsImJlZ2luUGF0aCIsImNlbGxXaWR0aCIsImNlbGxIZWlnaHQiLCJjb2xvcnMiLCJNYXAiLCJ4IiwieSIsImtpbmQiLCJhdCIsImNvbG9yIiwiZ2V0IiwidW5kZWZpbmVkIiwibGFuZF9jb2xvcl9jb2RlIiwic2V0IiwiZmlsbFN0eWxlIiwiZmlsbFJlY3QiLCJzdHJva2UiLCJfM2RfUmVuZGVyZXIzRCIsImJvdGgiLCJmcm9tSGVpZ2h0IiwiZnJvbVdpZHRoIiwiTWF0aCIsInNxcnQiLCJjZWxsU2l6ZSIsImZsb29yIiwiZGV0ZXJtaW5lQ2VsbFNpemUiLCJwb2ludCIsIm9iZWxpc2siLCJwaXhlbFZpZXciLCJjYWNoZSIsImNhbGNDdWJlIiwiYWx0IiwiY2FjaGVkIiwicmdiIiwibGFuZF9yZ2JfY29sb3IiLCJnZXRCeUhvcml6b250YWxDb2xvciIsImtpbmRDb2xvciIsImRpbSIsImN1YmVBdCIsImNlbGwiLCJhbHRpdHVkZSIsIndvcmxkX21hcF9nZW4iLCJUb3duIiwiUGF0aCIsImN1YmUiLCJwdCIsInJlbmRlck9iamVjdCIsImdlbmVyYXRvciIsIm5ldyIsInNlbGVjdG9yIiwiZ2V0RWxlbWVudEJ5SWQiLCJvcHRpb24iLCJzZWxlY3RlZEluZGV4IiwidmFsdWUiLCJhZGRFdmVudExpc3RlbmVyIiwib25WaXN1YWxpemF0aW9uQ2hhbmdlIiwiYmluZCIsIndpZHRoSW5wdXQiLCJoZWlnaHRJbnB1dCIsInNjcmVlblJvb3QiLCJpbml0UmVuZGVyZXIiLCJwYWludEJ1dHRvbiIsInJlbmRlciIsInBhcnNlSW50IiwiaXNOYU4iLCJjZWxsUGl4IiwicHJldiIsImZpcnN0Q2hpbGQiLCJyZW1vdmVDaGlsZCIsInJlbmRlcmVyIiwiRXJyb3IiLCJldmVudCIsInRhcmdldCIsInRleHRDb250ZW50IiwiY2xhc3NMaXN0IiwiYWRkIiwic2V0VGltZW91dCIsInN0YXJ0IiwiRGF0ZSIsIm5vdyIsImdldFNpemUiLCJnZW5fYXV0byIsInJlbW92ZSIsImNvbnNvbGUiLCJsb2ciLCJfX3dlYnBhY2tfcmVxdWlyZV9fIiwiZCIsIl9fd2VicGFja19leHBvcnRzX18iLCJMYW5kS2luZCIsIl9fd2JnX25ld19iYzg5MGRmM2U1ZTZhOTFkIiwiX193YmdfY2FsbF9lMTViNmFhMGM2ZDNjOTNmIiwiX193Ymdfc2VsZl85NWFkM2YxY2RkZDVhY2NjIiwiX193YmdfY3J5cHRvX2M5M2NjNWExNDdlMzU0MjIiLCJfX3diZ19nZXRSYW5kb21WYWx1ZXNfNThiNDY0MTZlYTdhMzNhMiIsIl9fd2JnX2dldFJhbmRvbVZhbHVlc19hM2EzYzJkZDU0OTRmZDM5IiwiX193YmdfcmVxdWlyZV8zNmE4OTVmMGE0ZWEwNTI5IiwiX193YmdfcmFuZG9tRmlsbFN5bmNfZjljYjc1MzFkOWMwYjE0NCIsIl9fd2JpbmRnZW5fb2JqZWN0X2Ryb3BfcmVmIiwiX193YmluZGdlbl9pc191bmRlZmluZWQiLCJfX3diaW5kZ2VuX2pzdmFsX2VxIiwiR2VuZXJhdG9yIiwiX193YmluZGdlbl90aHJvdyIsIl93b3JsZF9tYXBfZ2VuX2JnX19XRUJQQUNLX0lNUE9SVEVEX01PRFVMRV8wX18iLCJPYmplY3QiLCJmcmVlemUiLCJMb3ciLCJNaWRkbGUiLCJIaWdoIiwiY2FjaGVkVGV4dERlY29kZXIiLCJUZXh0RGVjb2RlciIsImNhY2hlZ2V0VWludDhNZW1vcnkiLCJnZXRVaW50OE1lbW9yeSIsImJ1ZmZlciIsIlVpbnQ4QXJyYXkiLCJnZXRTdHJpbmdGcm9tV2FzbSIsInB0ciIsImxlbiIsImRlY29kZSIsInN1YmFycmF5IiwiY2FjaGVkR2xvYmFsQXJndW1lbnRQdHIiLCJnbG9iYWxBcmd1bWVudFB0ciIsImNhY2hlZ2V0VWludDMyTWVtb3J5IiwiZ2V0VWludDMyTWVtb3J5IiwiVWludDMyQXJyYXkiLCJTZWEiLCJNb3VudGFpbiIsIkZvcmVzdCIsIlBsYWluIiwiVG9wIiwiSGlnaGxhbmQiLCJEZWVwU2VhIiwiaGVhcCIsIkFycmF5IiwiZmlsbCIsInB1c2giLCJoZWFwX25leHQiLCJsZW5ndGgiLCJhZGRIZWFwT2JqZWN0Iiwib2JqIiwiaWR4IiwiYXJnMCIsImFyZzEiLCJ2YXJnMCIsIkZ1bmN0aW9uIiwiZ2V0T2JqZWN0IiwiY2FsbCIsInNlbGYiLCJjcnlwdG8iLCJnZXRSYW5kb21WYWx1ZXMiLCJnZXRBcnJheVU4RnJvbVdhc20iLCJhcmcyIiwidmFyZzEiLCJyYW5kb21GaWxsU3luYyIsImkiLCJhIiwiYiIsIkNlbGwiLCJjcmVhdGUiLCJwcm90b3R5cGUiLCJmcmVlQ2VsbCIsImZyZWVHZW5lcmF0b3IiLCJfX3dyYXAiLCJCb2FyZCIsImZyZWVCb2FyZCIsInJldHB0ciIsIm1lbSIsInJ1c3RwdHIiLCJydXN0bGVuIiwicmVhbFJldCIsInNsaWNlIiwicHJlc2VudCIsIndlYnBhY2tFbXB0eUNvbnRleHQiLCJyZXEiLCJlIiwiY29kZSIsImtleXMiLCJyZXNvbHZlIiwibW9kdWxlIiwiZXhwb3J0cyIsImlkIl0sIm1hcHBpbmdzIjoiMEdBR2UsTUFBTUEsRUFJakJDLFlBQVlDLEdBQ1JDLEtBQUtDLE9BQVNDLFNBQVNDLGNBQWMsVUFDckNILEtBQUtDLE9BQU9HLFVBQVksU0FDeEJMLEVBQUtNLFlBQVlMLEtBQUtDLFFBRXRCRCxLQUFL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b250ZW50IjpbImltcG9ydCB7IEJvYXJkIH0gZnJvbSAnd29ybGQtbWFwLWdlbic7XG5pbXBvcnQgUmVuZGVyZXIgZnJvbSAnLi9yZW5kZXJlcic7XG5cbmV4cG9ydCBkZWZhdWx0IGNsYXNzIFJlbmRlcmVyMkQgaW1wbGVtZW50cyBSZW5kZXJlciB7XG4gICAgY2FudmFzOiBIVE1MQ2FudmFzRWxlbWVudDtcbiAgICBjdHg6IENhbnZhc1JlbmRlcmluZ0NvbnRleHQyRDtcblxuICAgIGNvbnN0cnVjdG9yKHJvb3Q6IEhUTUxFbGVtZW50KSB7XG4gICAgICAgIHRoaXMuY2FudmFzID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudCgnY2FudmFzJyk7XG4gICAgICAgIHRoaXMuY2FudmFzLmNsYXNzTmFtZSA9ICdzY3JlZW4nO1xuICAgICAgICByb290LmFwcGVuZENoaWxkKHRoaXMuY2FudmFzKTtcblxuICAgICAgICB0aGlzLmN0eCA9IHRoaXMuY2FudmFzLmdldENvbnRleHQoJzJkJykhO1xuICAgIH1cblxuICAgIHJlbmRlcihib2FyZDogQm9hcmQpIHtcbiAgICAgICAgY29uc3QgZHByID0gd2luZG93LmRldmljZVBpeGVsUmF0aW8gfHwgMTtcbiAgICAgICAgY29uc3QgcmVjdCA9IHRoaXMuY2FudmFzLmdldEJvdW5kaW5nQ2xpZW50UmVjdCgpO1xuICAgICAgICB0aGlzLmNhbnZhcy53aWR0aCA9IHJlY3Qud2lkdGggKiBkcHI7XG4gICAgICAgIHRoaXMuY2FudmFzLmhlaWdodCA9IHJlY3QuaGVpZ2h0ICogZHByO1xuXG4gICAgICAgIC8vIENsZWFyIGF0IGZpcnN0XG4gICAgICAgIHRoaXMuY3R4LmNsZWFyUmVjdCgwLCAwLCB0aGlzLmNhbnZhcy53aWR0aCwgdGhpcy5jYW52YXMuaGVpZ2h0KTtcblxuICAgICAgICB0aGlzLmN0eC5iZWdpblBhdGgoKTtcblxuICAgICAgICBjb25zdCB3aWR0aCA9IGJvYXJkLndpZHRoO1xuICAgICAgICBjb25zdCBoZWlnaHQgPSBib2FyZC5oZWlnaHQ7XG4gICAgICAgIGNvbnN0IGNlbGxXaWR0aCA9IHRoaXMuY2FudmFzLndpZHRoIC8gd2lkdGg7XG4gICAgICAgIGNvbnN0IGNlbGxIZWlnaHQgPSB0aGlzLmNhbnZhcy5oZWlnaHQgLyBoZWlnaHQ7XG5cbiAgICAgICAgY29uc3QgY29sb3JzID0gbmV3IE1hcCgpO1xuICAgICAgICBmb3IgKGxldCB4ID0gMDsgeCA8IHdpZHRoOyB4KyspIHtcbiAgICAgICAgICAgIGZvciAobGV0IHkgPSAwOyB5IDwgaGVpZ2h0OyB5KyspIHtcbiAgICAgICAgICAgICAgICBjb25zdCBjZWxsID0gYm9hcmQuYXQoeCwgeSk7XG4gICAgICAgICAgICAgICAgY29uc3Qga2luZCA9IGNlbGwua2luZDtcbiAgICAgICAgICAgICAgICBsZXQgY29sb3IgPSBjb2xvcnMuZ2V0KGtpbmQpO1xuICAgICAgICAgICAgICAgIGlmIChjb2xvciA9PT0gdW5kZWZpbmVkKSB7XG4gICAgICAgICAgICAgICAgICAgIGNvbG9yID0gYm9hcmQubGFuZF9jb2xvcl9jb2RlKGtpbmQpO1xuICAgICAgICAgICAgICAgICAgICBjb2xvcnMuc2V0KGtpbmQsIGNvbG9yKTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgdGhpcy5jdHguZmlsbFN0eWxlID0gY29sb3I7XG4gICAgICAgICAgICAgICAgdGhpcy5jdHguZmlsbFJlY3QoeCAqIGNlbGxXaWR0aCwgeSAqIGNlbGxIZWlnaHQsIGNlbGxXaWR0aCwgY2VsbEhlaWdodCk7XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cblxuICAgICAgICB0aGlzLmN0eC5zdHJva2UoKTtcbiAgICB9XG59XG4iLCJpbXBvcnQgeyBQb2ludDNELCBQb2ludCwgQ3ViZURpbWVuc2lvbiwgQ3ViZUNvbG9yLCBDdWJlLCBQaXhlbFZpZXcgfSBmcm9tICdvYmVsaXNrLmpzJztcbmltcG9ydCB7IExhbmRLaW5kLCBCb2FyZCwgQ2VsbCB9IGZyb20gJ3dvcmxkLW1hcC1nZW4nO1xuXG5leHBvcnQgZGVmYXVsdCBjbGFzcyBSZW5kZXJlcjNEIHtcbiAgICBjYW52YXM6IEhUTUxDYW52YXNFbGVtZW50O1xuXG4gICAgY29uc3RydWN0b3Iocm9vdDogSFRNTEVsZW1lbnQpIHtcbiAgICAgICAgdGhpcy5jYW52YXMgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KCdjYW52YXMnKTtcbiAgICAgICAgdGhpcy5jYW52YXMuY2xhc3NOYW1lID0gJ3NjcmVlbic7XG4gICAgICAgIHJvb3QuYXBwZW5kQ2hpbGQodGhpcy5jYW52YXMpO1xuICAgIH1cblxuICAgIGRldGVybWluZUNlbGxTaXplKHdpZHRoOiBudW1iZXIsIGhlaWdodDogbnVtYmVyKSB7XG4gICAgICAgIGNvbnN0IGJvdGggPSBoZWlnaHQgKyB3aWR0aDtcbiAgICAgICAgY29uc3QgZnJvbUhlaWdodCA9ICgodGhpcy5jYW52YXMuaGVpZ2h0IC0gMjAwKSAvIGJvdGgpICogMjtcbiAgICAgICAgY29uc3QgZnJvbVdpZHRoID0gKCh0aGlzLmNhbnZhcy53aWR0aCAvIGJvdGgpICogMikgLyBNYXRoLnNxcnQoMyk7XG4gICAgICAgIGxldCBjZWxsU2l6ZSA9IE1hdGguZmxvb3IoZnJvbUhlaWdodCA+IGZyb21XaWR0aCA/IGZyb21XaWR0aCA6IGZyb21IZWlnaHQpO1xuICAgICAgICBpZiAoY2VsbFNpemUgJSAyID09PSAxKSB7XG4gICAgICAgICAgICBjZWxsU2l6ZS0tO1xuICAgICAgICB9XG4gICAgICAgIHJldHVybiBjZWxsU2l6ZSA+IDYgPyBjZWxsU2l6ZSA6IDY7XG4gICAgfVxuXG4gICAgcmVuZGVyKGJvYXJkOiBCb2FyZCkge1xuICAgICAgICBjb25zdCBkcHIgPSB3aW5kb3cuZGV2aWNlUGl4ZWxSYXRpbyB8fCAxO1xuICAgICAgICBjb25zdCByZWN0ID0gdGhpcy5jYW52YXMuZ2V0Qm91bmRpbmdDbGllbnRSZWN0KCk7XG4gICAgICAgIHRoaXMuY2FudmFzLndpZHRoID0gcmVjdC53aWR0aCAqIGRwcjtcbiAgICAgICAgdGhpcy5jYW52YXMuaGVpZ2h0ID0gcmVjdC5oZWlnaHQgKiBkcHI7XG5cbiAgICAgICAgY29uc3Qgd2lkdGggPSBib2FyZC53aWR0aDtcbiAgICAgICAgY29uc3QgaGVpZ2h0ID0gYm9hcmQuaGVpZ2h0O1xuICAgICAgICBjb25zdCBjZWxsU2l6ZSA9IHRoaXMuZGV0ZXJtaW5lQ2VsbFNpemUod2lkdGgsIGhlaWdodCk7XG5cbiAgICAgICAgY29uc3QgcG9pbnQgPSBuZXcgUG9pbnQodGhpcy5jYW52YXMud2lkdGggLyAyLCBjZWxsU2l6ZSArIDk5KTtcbiAgICAgICAgY29uc3QgcGl4ZWxWaWV3ID0gbmV3IFBpeGVsVmlldyh0aGlzLmNhbnZhcywgcG9pbnQpO1xuXG4gICAgICAgIGNvbnN0IGNhY2hlID0gbmV3IE1hcCgpO1xuICAgICAgICBjb25zdCBjb2xvcnMgPSBuZXcgTWFwKCk7XG5cbiAgICAgICAgZnVuY3Rpb24ga2luZENvbG9yKGtpbmQ6IExhbmRLaW5kKTogQ3ViZUNvbG9yIHtcbiAgICAgICAgICAgIGNvbnN0IGNhY2hlZCA9IGNvbG9ycy5nZXQoa2luZCk7XG4gICAgICAgICAgICBpZiAoY2FjaGVkICE9PSB1bmRlZmluZWQpIHtcbiAgICAgICAgICAgICAgICByZXR1cm4gY2FjaGVkO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgbGV0IHJnYiA9IGJvYXJkLmxhbmRfcmdiX2NvbG9yKGtpbmQpO1xuICAgICAgICAgICAgaWYgKHJnYiA9PT0gdW5kZWZpbmVkKSB7XG4gICAgICAgICAgICAgICAgcmdiID0gMHhmZmZmZmY7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBjb25zdCBjb2xvciA9IG5ldyBDdWJlQ29sb3IoKS5nZXRCeUhvcml6b250YWxDb2xvcihyZ2IpO1xuICAgICAgICAgICAgY29sb3JzLnNldChraW5kLCBjb2xvcik7XG4gICAgICAgICAgICByZXR1cm4gY29sb3I7XG4gICAgICAgIH1cblxuICAgICAgICBmdW5jdGlvbiBjYWxjQ3ViZShraW5kOiBMYW5kS2luZCwgYWx0OiBudW1iZXIpOiBDdWJlIHtcbiAgICAgICAgICAgIGNvbnN0IGNvbG9yID0ga2luZENvbG9yKGtpbmQpO1xuICAgICAgICAgICAgY29uc3QgaGVpZ2h0ID0gY2VsbFNpemUgKyBhbHQgKiAyO1xuICAgICAgICAgICAgY29uc3QgZGltID0gbmV3IEN1YmVEaW1lbnNpb24oY2VsbFNpemUsIGNlbGxTaXplLCBoZWlnaHQpO1xuICAgICAgICAgICAgcmV0dXJuIG5ldyBDdWJlKGRpbSwgY29sb3IsIC8qYm9yZGVyOiovIGZhbHNlKTtcbiAgICAgICAgfVxuXG4gICAgICAgIGZ1bmN0aW9uIGN1YmVBdChjZWxsOiBDZWxsKTogQ3ViZSB7XG4gICAgICAgICAgICBjb25zdCBraW5kID0gY2VsbC5raW5kO1xuICAgICAgICAgICAgY29uc3QgYWx0ID0gY2VsbC5hbHRpdHVkZTtcblxuICAgICAgICAgICAgaWYgKGtpbmQgPT09IExhbmRLaW5kLlRvd24gfHwga2luZCA9PT0gTGFuZEtpbmQuUGF0aCkge1xuICAgICAgICAgICAgICAgIHJldHVybiBjYWxjQ3ViZShraW5kLCBhbHQpO1xuICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICBjb25zdCBjYWNoZWQgPSBjYWNoZS5nZXQoYWx0KTtcbiAgICAgICAgICAgIGlmIChjYWNoZWQgIT09IHVuZGVmaW5lZCkge1xuICAgICAgICAgICAgICAgIHJldHVybiBjYWNoZWQ7XG4gICAgICAgICAgICB9XG5cbiAgICAgICAgICAgIGNvbnN0IGN1YmUgPSBjYWxjQ3ViZShraW5kLCBhbHQpO1xuICAgICAgICAgICAgY2FjaGUuc2V0KGFsdCwgY3ViZSk7XG4gICAgICAgICAgICByZXR1cm4gY3ViZTtcbiAgICAgICAgfVxuXG4gICAgICAgIGZvciAobGV0IHggPSAwOyB4IDwgd2lkdGg7IHgrKykge1xuICAgICAgICAgICAgZm9yIChsZXQgeSA9IDA7IHkgPCBoZWlnaHQ7IHkrKykge1xuICAgICAgICAgICAgICAgIGNvbnN0IGN1YmUgPSBjdWJlQXQoYm9hcmQuYXQoeCwgeSkpO1xuICAgICAgICAgICAgICAgIGNvbnN0IHB0ID0gbmV3IFBvaW50M0QoeCAqIGNlbGxTaXplLCB5ICogY2VsbFNpemUsIDApO1xuICAgICAgICAgICAgICAgIHBpeGVsVmlldy5yZW5kZXJPYmplY3QoY3ViZSwgcHQpO1xuICAgICAgICAgICAgfVxuICAgICAgICB9XG4gICAgfVxufVxuIiwiaW1wb3J0IHsgR2VuZXJhdG9yIH0gZnJvbSAnd29ybGQtbWFwLWdlbic7XG5pbXBvcnQgUmVuZGVyZXIyRCBmcm9tICcuLzJkJztcbmltcG9ydCBSZW5kZXJlcjNEIGZyb20gJy4vM2QnO1xuaW1wb3J0IFJlbmRlcmVyIGZyb20gJy4vcmVuZGVyZXInO1xuXG5jb25zdCBhcHAgPSBuZXcgY2xhc3Mge1xuICAgIHByaXZhdGUgZ2VuZXJhdG9yOiBHZW5lcmF0b3I7XG4gICAgcHJpdmF0ZSBkaW06IHN0cmluZztcbiAgICBwcml2YXRlIHdpZHRoSW5wdXQ6IEhUTUxJbnB1dEVsZW1lbnQ7XG4gICAgcHJpdmF0ZSBoZWlnaHRJbnB1dDogSFRNTElucHV0RWxlbWVudDtcbiAgICBwcml2YXRlIHNjcmVlblJvb3Q6IEhUTUxFbGVtZW50O1xuICAgIHByaXZhdGUgcGFpbnRCdXR0b246IEhUTUxCdXR0b25FbGVtZW50O1xuICAgIHByaXZhdGUgcmVuZGVyZXI6IFJlbmRlcmVyO1xuXG4gICAgY29uc3RydWN0b3IoKSB7XG4gICAgICAgIHRoaXMuZ2VuZXJhdG9yID0gR2VuZXJhdG9yLm5ldygpO1xuXG4gICAgICAgIGNvbnN0IHNlbGVjdG9yID0gZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoJ2RpbWVuc2lvbi1zZWxlY3RvcicpIGFzIEhUTUxTZWxlY3RFbGVtZW50O1xuICAgICAgICBjb25zdCBvcHRpb24gPSBzZWxlY3RvcltzZWxlY3Rvci5zZWxlY3RlZEluZGV4XSBhcyBIVE1MT3B0aW9uRWxlbWVudDtcbiAgICAgICAgdGhpcy5kaW0gPSBvcHRpb24udmFsdWU7XG4gICAgICAgIHNlbGVjdG9yLmFkZEV2ZW50TGlzdGVuZXIoJ2NoYW5nZScsIHRoaXMub25WaXN1YWxpemF0aW9uQ2hhbmdlLmJpbmQodGhpcykpO1xuXG4gICAgICAgIHRoaXMud2lkdGhJbnB1dCA9IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCd3aWR0aC1pbnB1dCcpIGFzIEhUTUxJbnB1dEVsZW1lbnQ7XG4gICAgICAgIHRoaXMuaGVpZ2h0SW5wdXQgPSBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgnaGVpZ2h0LWlucHV0JykgYXMgSFRNTElucHV0RWxlbWVudDtcbiAgICAgICAgdGhpcy5zY3JlZW5Sb290ID0gZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoJ3NjcmVlbi1yb290JykgYXMgSFRNTEVsZW1lbnQ7XG5cbiAgICAgICAgdGhpcy5pbml0UmVuZGVyZXIoKTtcblxuICAgICAgICB0aGlzLnBhaW50QnV0dG9uID0gZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoJ3BhaW50LWJ1dHRvbicpIGFzIEhUTUxCdXR0b25FbGVtZW50O1xuICAgICAgICB0aGlzLnBhaW50QnV0dG9uLmFkZEV2ZW50TGlzdGVuZXIoJ2NsaWNrJywgKCkgPT4ge1xuICAgICAgICAgICAgdGhpcy5yZW5kZXIoKTtcbiAgICAgICAgfSk7XG4gICAgfVxuXG4gICAgZ2V0U2l6ZSgpIHtcbiAgICAgICAgY29uc3Qgd2lkdGggPSBwYXJzZUludCh0aGlzLndpZHRoSW5wdXQudmFsdWUsIDEwKTtcbiAgICAgICAgY29uc3QgaGVpZ2h0ID0gcGFyc2VJbnQodGhpcy5oZWlnaHRJbnB1dC52YWx1ZSwgMTApO1xuICAgICAgICBpZiAoIWlzTmFOKHdpZHRoKSAmJiAhaXNOYU4oaGVpZ2h0KSkge1xuICAgICAgICAgICAgcmV0dXJuIFt3aWR0aCwgaGVpZ2h0XTtcbiAgICAgICAgfVxuXG4gICAgICAgIGlmICh0aGlzLmRpbSA9PT0gJzNkJykge1xuICAgICAgICAgICAgcmV0dXJuIFsxMjAsIDEyMF07XG4gICAgICAgIH1cblxuICAgICAgICBjb25zdCByZWN0ID0gdGhpcy5zY3JlZW5Sb290LmdldEJvdW5kaW5nQ2xpZW50UmVjdCgpO1xuXG4gICAgICAgIGlmICghaXNOYU4od2lkdGgpKSB7XG4gICAgICAgICAgICAvLyBOb3RlOiBoZWlnaHQgaXMgTmFOXG4gICAgICAgICAgICBjb25zdCBjZWxsUGl4ID0gcmVjdC53aWR0aCAvIHdpZHRoO1xuICAgICAgICAgICAgcmV0dXJuIFt3aWR0aCwgTWF0aC5mbG9vcihyZWN0LmhlaWdodCAvIGNlbGxQaXgpXTtcbiAgICAgICAgfSBlbHNlIGlmICghaXNOYU4oaGVpZ2h0KSkge1xuICAgICAgICAgICAgLy8gTm90ZTogd2lkdGggaXMgTmFOXG4gICAgICAgICAgICBjb25zdCBjZWxsUGl4ID0gcmVjdC5oZWlnaHQgLyBoZWlnaHQ7XG4gICAgICAgICAgICByZXR1cm4gW01hdGguZmxvb3IocmVjdC53aWR0aCAvIGNlbGxQaXgpLCBoZWlnaHRdO1xuICAgICAgICB9IC8qIGxvbmdlciBzaWRlIGxlbmd0aCBpcyAyMDAgY2VsbHMgYnkgZGVmYXVsdCAqLyBlbHNlIHtcbiAgICAgICAgICAgIGNvbnN0IG1heCA9IHJlY3QuaGVpZ2h0ID4gcmVjdC53aWR0aCA/IHJlY3QuaGVpZ2h0IDogcmVjdC53aWR0aDtcbiAgICAgICAgICAgIGNvbnN0IGNlbGxQaXggPSBtYXggLyAyMDA7XG4gICAgICAgICAgICByZXR1cm4gW01hdGguZmxvb3IocmVjdC53aWR0aCAvIGNlbGxQaXgpLCBNYXRoLmZsb29yKHJlY3QuaGVpZ2h0IC8gY2VsbFBpeCldO1xuICAgICAgICB9XG4gICAgfVxuXG4gICAgaW5pdFJlbmRlcmVyKCkge1xuICAgICAgICBjb25zdCBwcmV2ID0gdGhpcy5zY3JlZW5Sb290LmZpcnN0Q2hpbGQ7XG4gICAgICAgIGlmIChwcmV2ICE9PSBudWxsKSB7XG4gICAgICAgICAgICB0aGlzLnNjcmVlblJvb3QucmVtb3ZlQ2hpbGQocHJldik7XG4gICAgICAgIH1cblxuICAgICAgICBzd2l0Y2ggKHRoaXMuZGltKSB7XG4gICAgICAgICAgICBjYXNlICcyZCc6XG4gICAgICAgICAgICAgICAgdGhpcy5yZW5kZXJlciA9IG5ldyBSZW5kZXJlcjJEKHRoaXMuc2NyZWVuUm9vdCk7XG4gICAgICAgICAgICAgICAgYnJlYWs7XG4gICAgICAgICAgICBjYXNlICczZCc6XG4gICAgICAgICAgICAgICAgdGhpcy5yZW5kZXJlciA9IG5ldyBSZW5kZXJlcjNEKHRoaXMuc2NyZWVuUm9vdCk7XG4gICAgICAgICAgICAgICAgYnJlYWs7XG4gICAgICAgICAgICBkZWZhdWx0OlxuICAgICAgICAgICAgICAgIHRocm93IG5ldyBFcnJvcihgVW5rbm93biBjb250ZXh0ICR7dGhpcy5kaW19YCk7XG4gICAgICAgIH1cbiAgICB9XG5cbiAgICBvblZpc3VhbGl6YXRpb25DaGFuZ2UoZXZlbnQ6IEV2ZW50KSB7XG4gICAgICAgIGNvbnN0IHNlbGVjdG9yID0gZXZlbnQudGFyZ2V0IGFzIEhUTUxTZWxlY3RFbGVtZW50O1xuICAgICAgICBjb25zdCBvcHRpb24gPSBzZWxlY3RvcltzZWxlY3Rvci5zZWxlY3RlZEluZGV4XSBhcyBIVE1MT3B0aW9uRWxlbWVudDtcbiAgICAgICAgY29uc3QgZGltID0gb3B0aW9uLnZhbHVlO1xuICAgICAgICBpZiAodGhpcy5kaW0gPT09IGRpbSkge1xuICAgICAgICAgICAgcmV0dXJuO1xuICAgICAgICB9XG4gICAgICAgIHRoaXMuZGltID0gZGltO1xuICAgICAgICB0aGlzLmluaXRSZW5kZXJlcigpO1xuICAgICAgICB0aGlzLnJlbmRlcigpO1xuICAgIH1cblxuICAgIHJlbmRlcigpIHtcbiAgICAgICAgLy8gVE9ETzogTG9hZGluZyBpbmRpY2F0b3IgY2Fubm90IGJlIGRpc3BsYXllZCBzaW5jZSBtYXAgZ2VuZXJhdGlvbiBpcyBydW4gaW4gbWFpbiB0aHJlYWQuXG4gICAgICAgIC8vIFdoZW4gbWFwIHNpemUgaXMgdmVyeSBsYXJnZSBhbmQgaXQgY29uc3VtZXMgdGltZSwgQ1BVIGNvcmUgaXMgYWxzbyBjb25zdW1lZCBmb3IgbWFpbiB0aHJlYWQuXG4gICAgICAgIC8vIEluIHRoZSBjYXNlLCBubyBhbmltYXRpb24gaXMgYWN0dWFsbHkgcmVuZGVyZWQuXG4gICAgICAgIC8vIFRvIHByZXZlbnQgdGhpcywgbWFwIGdlbmVyYXRpb24gbXVzdCBiZSBydW4gaW4gYW5vdGhlciB0aHJlYWQgYW5kIFJ1c3QgY2FuIGRvIGl0LlxuXG4gICAgICAgIC8vIHRoaXMucGFpbnRCdXR0b24uY2xhc3NMaXN0LmFkZCgnaXMtbG9hZGluZycpO1xuICAgICAgICB0aGlzLnBhaW50QnV0dG9uLnRleHRDb250ZW50ID0gJ1BhaW50aW5nLi4uJztcbiAgICAgICAgdGhpcy5wYWludEJ1dHRvbi5jbGFzc0xpc3QuYWRkKCdkaXNhYmxlZCcpO1xuICAgICAgICAvLyBXYWl0IG5leHQgdGljayB0byBjaGFuZ2UgdGV4dFxuICAgICAgICB3aW5kb3cuc2V0VGltZW91dCgoKSA9PiB7XG4gICAgICAgICAgICBjb25zdCBzdGFydCA9IERhdGUubm93KCk7XG4gICAgICAgICAgICBjb25zdCBbd2lkdGgsIGhlaWdodF0gPSB0aGlzLmdldFNpemUoKTtcbiAgICAgICAgICAgIGNvbnN0IGJvYXJkID0gdGhpcy5nZW5lcmF0b3IuZ2VuX2F1dG8od2lkdGgsIGhlaWdodCk7XG4gICAgICAgICAgICB0aGlzLnJlbmRlcmVyLnJlbmRlcihib2FyZCk7XG4gICAgICAgICAgICAvLyB0aGlzLnBhaW50QnV0dG9uLmNsYXNzTGlzdC5yZW1vdmUoJ2lzLWxvYWRpbmcnKTtcbiAgICAgICAgICAgIHRoaXMucGFpbnRCdXR0b24uY2xhc3NMaXN0LnJlbW92ZSgnZGlzYWJsZWQnKTtcbiAgICAgICAgICAgIHRoaXMucGFpbnRCdXR0b24udGV4dENvbnRlbnQgPSAnUGFpbnQnO1xuICAgICAgICAgICAgY29uc29sZS5sb2coJ0NvbnN1bWVkOicsIERhdGUubm93KCkgLSBzdGFydCk7XG4gICAgICAgIH0sIDApO1xuICAgIH1cbn0oKTtcblxuYXBwLnJlbmRlcigpO1xuIiwiLyogdHNsaW50OmRpc2FibGUgKi9cbmltcG9ydCAqIGFzIHdhc20gZnJvbSAnLi93b3JsZF9tYXBfZ2VuX2JnJztcblxuLyoqXG4qIFJlc29sdXRpb24gb2YgdGhlIGJvYXJkLlxuKi9cbmV4cG9ydCBjb25zdCBSZXNvbHV0aW9uID0gT2JqZWN0LmZyZWV6ZSh7IExvdzowLE1pZGRsZToxLEhpZ2g6MiwgfSk7XG5cbmxldCBjYWNoZWRUZXh0RGVjb2RlciA9IG5ldyBUZXh0RGVjb2RlcigndXRmLTgnKTtcblxubGV0IGNhY2hlZ2V0VWludDhNZW1vcnkgPSBudWxsO1xuZnVuY3Rpb24gZ2V0VWludDhNZW1vcnkoKSB7XG4gICAgaWYgKGNhY2hlZ2V0VWludDhNZW1vcnkgPT09IG51bGwgfHwgY2FjaGVnZXRVaW50OE1lbW9yeS5idWZmZXIgIT09IHdhc20ubWVtb3J5LmJ1ZmZlcikge1xuICAgICAgICBjYWNoZWdldFVpbnQ4TWVtb3J5ID0gbmV3IFVpbnQ4QXJyYXkod2FzbS5tZW1vcnkuYnVmZmVyKTtcbiAgICB9XG4gICAgcmV0dXJuIGNhY2hlZ2V0VWludDhNZW1vcnk7XG59XG5cbmZ1bmN0aW9uIGdldFN0cmluZ0Zyb21XYXNtKHB0ciwgbGVuKSB7XG4gICAgcmV0dXJuIGNhY2hlZFRleHREZWNvZGVyLmRlY29kZShnZXRVaW50OE1lbW9yeSgpLnN1YmFycmF5KHB0ciwgcHRyICsgbGVuKSk7XG59XG5cbmxldCBjYWNoZWRHbG9iYWxBcmd1bWVudFB0ciA9IG51bGw7XG5mdW5jdGlvbiBnbG9iYWxBcmd1bWVudFB0cigpIHtcbiAgICBpZiAoY2FjaGVkR2xvYmFsQXJndW1lbnRQdHIgPT09IG51bGwpIHtcbiAgICAgICAgY2FjaGVkR2xvYmFsQXJndW1lbnRQdHIgPSB3YXNtLl9fd2JpbmRnZW5fZ2xvYmFsX2FyZ3VtZW50X3B0cigpO1xuICAgIH1cbiAgICByZXR1cm4gY2FjaGVkR2xvYmFsQXJndW1lbnRQdHI7XG59XG5cbmxldCBjYWNoZWdldFVpbnQzMk1lbW9yeSA9IG51bGw7XG5mdW5jdGlvbiBnZXRVaW50MzJNZW1vcnkoKSB7XG4gICAgaWYgKGNhY2hlZ2V0VWludDMyTWVtb3J5ID09PSBudWxsIHx8IGNhY2hlZ2V0VWludDMyTWVtb3J5LmJ1ZmZlciAhPT0gd2FzbS5tZW1vcnkuYnVmZmVyKSB7XG4gICAgICAgIGNhY2hlZ2V0VWludDMyTWVtb3J5ID0gbmV3IFVpbnQzMkFycmF5KHdhc20ubWVtb3J5LmJ1ZmZlcik7XG4gICAgfVxuICAgIHJldHVybiBjYWNoZWdldFVpbnQzMk1lbW9yeTtcbn1cbi8qKlxuKiBSZXByZXNlbnRzIHRoZSBraW5kIG9mIGNlbGwuIGBwcmVzZXQoKWAgbWV0aG9kIHJldHVybnMgYSBwcmVzZXQgY2VsbCBjb25zdGFudHMgZm9yXG4qIHRoZSBraW5kLlxuKi9cbmV4cG9ydCBjb25zdCBMYW5kS2luZCA9IE9iamVjdC5mcmVlemUoeyBTZWE6MCxNb3VudGFpbjoxLEZvcmVzdDoyLFBsYWluOjMsVG93bjo0LFRvcDo1LEhpZ2hsYW5kOjYsRGVlcFNlYTo3LFBhdGg6OCwgfSk7XG5cbmNvbnN0IGhlYXAgPSBuZXcgQXJyYXkoMzIpO1xuXG5oZWFwLmZpbGwodW5kZWZpbmVkKTtcblxuaGVhcC5wdXNoKHVuZGVmaW5lZCwgbnVsbCwgdHJ1ZSwgZmFsc2UpO1xuXG5sZXQgaGVhcF9uZXh0ID0gaGVhcC5sZW5ndGg7XG5cbmZ1bmN0aW9uIGFkZEhlYXBPYmplY3Qob2JqKSB7XG4gICAgaWYgKGhlYXBfbmV4dCA9PT0gaGVhcC5sZW5ndGgpIGhlYXAucHVzaChoZWFwLmxlbmd0aCArIDEpO1xuICAgIGNvbnN0IGlkeCA9IGhlYXBfbmV4dDtcbiAgICBoZWFwX25leHQgPSBoZWFwW2lkeF07XG5cbiAgICBoZWFwW2lkeF0gPSBvYmo7XG4gICAgcmV0dXJuIGlkeDtcbn1cblxuZXhwb3J0IGZ1bmN0aW9uIF9fd2JnX25ld19iYzg5MGRmM2U1ZTZhOTFkKGFyZzAsIGFyZzEpIHtcbiAgICBsZXQgdmFyZzAgPSBnZXRTdHJpbmdGcm9tV2FzbShhcmcwLCBhcmcxKTtcbiAgICByZXR1cm4gYWRkSGVhcE9iamVjdChuZXcgRnVuY3Rpb24odmFyZzApKTtcbn1cblxuZnVuY3Rpb24gZ2V0T2JqZWN0KGlkeCkgeyByZXR1cm4gaGVhcFtpZHhdOyB9XG5cbmV4cG9ydCBmdW5jdGlvbiBfX3diZ19jYWxsX2UxNWI2YWEwYzZkM2M5M2YoYXJnMCwgYXJnMSkge1xuICAgIHJldHVybiBhZGRIZWFwT2JqZWN0KGdldE9iamVjdChhcmcwKS5jYWxsKGdldE9iamVjdChhcmcxKSkpO1xufVxuXG5leHBvcnQgZnVuY3Rpb24gX193Ymdfc2VsZl85NWFkM2YxY2RkZDVhY2NjKGFyZzApIHtcbiAgICByZXR1cm4gYWRkSGVhcE9iamVjdChnZXRPYmplY3QoYXJnMCkuc2VsZik7XG59XG5cbmV4cG9ydCBmdW5jdGlvbiBfX3diZ19jcnlwdG9fYzkzY2M1YTE0N2UzNTQyMihhcmcwKSB7XG4gICAgcmV0dXJuIGFkZEhlYXBPYmplY3QoZ2V0T2JqZWN0KGFyZzApLmNyeXB0byk7XG59XG5cbmV4cG9ydCBmdW5jdGlvbiBfX3diZ19nZXRSYW5kb21WYWx1ZXNfNThiNDY0MTZlYTdhMzNhMihhcmcwKSB7XG4gICAgcmV0dXJuIGFkZEhlYXBPYmplY3QoZ2V0T2JqZWN0KGFyZzApLmdldFJhbmRvbVZhbHVlcyk7XG59XG5cbmZ1bmN0aW9uIGdldEFycmF5VThGcm9tV2FzbShwdHIsIGxlbikge1xuICAgIHJldHVybiBnZXRVaW50OE1lbW9yeSgpLnN1YmFycmF5KHB0ciAvIDEsIHB0ciAvIDEgKyBsZW4pO1xufVxuXG5leHBvcnQgZnVuY3Rpb24gX193YmdfZ2V0UmFuZG9tVmFsdWVzX2EzYTNjMmRkNTQ5NGZkMzkoYXJnMCwgYXJnMSwgYXJnMikge1xuICAgIGxldCB2YXJnMSA9IGdldEFycmF5VThGcm9tV2FzbShhcmcxLCBhcmcyKTtcbiAgICBnZXRPYmplY3QoYXJnMCkuZ2V0UmFuZG9tVmFsdWVzKHZhcmcxKTtcbn1cblxuZXhwb3J0IGZ1bmN0aW9uIF9fd2JnX3JlcXVpcmVfMzZhODk1ZjBhNGVhMDUyOShhcmcwLCBhcmcxKSB7XG4gICAgbGV0IHZhcmcwID0gZ2V0U3RyaW5nRnJvbVdhc20oYXJnMCwgYXJnMSk7XG4gICAgcmV0dXJuIGFkZEhlYXBPYmplY3QocmVxdWlyZSh2YXJnMCkpO1xufVxuXG5leHBvcnQgZnVuY3Rpb24gX193YmdfcmFuZG9tRmlsbFN5bmNfZjljYjc1MzFkOWMwYjE0NChhcmcwLCBhcmcxLCBhcmcyKSB7XG4gICAgbGV0IHZhcmcxID0gZ2V0QXJyYXlVOEZyb21XYXNtKGFyZzEsIGFyZzIpO1xuICAgIGdldE9iamVjdChhcmcwKS5yYW5kb21GaWxsU3luYyh2YXJnMSk7XG59XG5cbmZ1bmN0aW9uIGRyb3BPYmplY3QoaWR4KSB7XG4gICAgaWYgKGlkeCA8IDM2KSByZXR1cm47XG4gICAgaGVhcFtpZHhdID0gaGVhcF9uZXh0O1xuICAgIGhlYXBfbmV4dCA9IGlkeDtcbn1cblxuZXhwb3J0IGZ1bmN0aW9uIF9fd2JpbmRnZW5fb2JqZWN0X2Ryb3BfcmVmKGkpIHsgZHJvcE9iamVjdChpKTsgfVxuXG5leHBvcnQgZnVuY3Rpb24gX193YmluZGdlbl9pc191bmRlZmluZWQoaWR4KSB7XG4gICAgcmV0dXJuIGdldE9iamVjdChpZHgpID09PSB1bmRlZmluZWQgPyAxIDogMDtcbn1cblxuZXhwb3J0IGZ1bmN0aW9uIF9fd2JpbmRnZW5fanN2YWxfZXEoYSwgYikge1xuICAgIHJldHVybiBnZXRPYmplY3QoYSkgPT09IGdldE9iamVjdChiKSA/IDEgOiAwO1xufVxuXG5mdW5jdGlvbiBmcmVlQ2VsbChwdHIpIHtcblxuICAgIHdhc20uX193YmdfY2VsbF9mcmVlKHB0cik7XG59XG4vKipcbiogUmVwcmVzZW50cyBvbmUgY2VsbCBpbiBib2FyZC4gSW4gY29udHJhc3QgdG8gYGxhbmQ6OkxhbmRgLCBpdCBvbmx5IGNvbnRhaW5zIGl0cyBsYW5kIGtpbmQgYW5kXG4qIGFsdGl0dWRlIGluIG9yZGVyIHRvIHJlZHVjZSB0b3RhbCBtZW1vcnkgc2l6ZS5cbiovXG5leHBvcnQgY2xhc3MgQ2VsbCB7XG5cbiAgICBzdGF0aWMgX193cmFwKHB0cikge1xuICAgICAgICBjb25zdCBvYmogPSBPYmplY3QuY3JlYXRlKENlbGwucHJvdG90eXBlKTtcbiAgICAgICAgb2JqLnB0ciA9IHB0cjtcblxuICAgICAgICByZXR1cm4gb2JqO1xuICAgIH1cblxuICAgIGZyZWUoKSB7XG4gICAgICAgIGNvbnN0IHB0ciA9IHRoaXMucHRyO1xuICAgICAgICB0aGlzLnB0ciA9IDA7XG4gICAgICAgIGZyZWVDZWxsKHB0cik7XG4gICAgfVxuXG4gICAgLyoqXG4gICAgKiBAcmV0dXJucyB7bnVtYmVyfVxuICAgICovXG4gICAgZ2V0IGtpbmQoKSB7XG4gICAgICAgIHJldHVybiB3YXNtLl9fd2JnX2dldF9jZWxsX2tpbmQodGhpcy5wdHIpO1xuICAgIH1cbiAgICBzZXQga2luZChhcmcwKSB7XG4gICAgICAgIHJldHVybiB3YXNtLl9fd2JnX3NldF9jZWxsX2tpbmQodGhpcy5wdHIsIGFyZzApO1xuICAgIH1cbiAgICAvKipcbiAgICAqIEByZXR1cm5zIHtudW1iZXJ9XG4gICAgKi9cbiAgICBnZXQgYWx0aXR1ZGUoKSB7XG4gICAgICAgIHJldHVybiB3YXNtLl9fd2JnX2dldF9jZWxsX2FsdGl0dWRlKHRoaXMucHRyKTtcbiAgICB9XG4gICAgc2V0IGFsdGl0dWRlKGFyZzApIHtcbiAgICAgICAgcmV0dXJuIHdhc20uX193Ymdfc2V0X2NlbGxfYWx0aXR1ZGUodGhpcy5wdHIsIGFyZzApO1xuICAgIH1cbn1cblxuZnVuY3Rpb24gZnJlZUdlbmVyYXRvcihwdHIpIHtcblxuICAgIHdhc20uX193YmdfZ2VuZXJhdG9yX2ZyZWUocHRyKTtcbn1cbi8qKlxuKiBSZXByZXNlbnRzIHJhbmRvbSBtYXAgZ2VuZXJhdG9yLiBJbiBjb250cmFzdCB0byBgZ2VuOjpSYW5kb21Cb2FyZEdlbmAsIGl0IG9ubHkgcHJvdmlkZXMgbGltaXRlZFxuKiBmdW5jdGlvbmFsaXR5LiBJdCBjYW5ub3QgYmUgaW5pdGlhbGl6ZWQgd2l0aCBzcGVjaWZpYyBzZWVkLiBBbmQgbWFwIHJlc29sdXRpb24gaXMgYWx3YXlzIGRldGVjdGVkXG4qIGZyb20gaXRzIHNpemUuXG4qL1xuZXhwb3J0IGNsYXNzIEdlbmVyYXRvciB7XG5cbiAgICBzdGF0aWMgX193cmFwKHB0cikge1xuICAgICAgICBjb25zdCBvYmogPSBPYmplY3QuY3JlYXRlKEdlbmVyYXRvci5wcm90b3R5cGUpO1xuICAgICAgICBvYmoucHRyID0gcHRyO1xuXG4gICAgICAgIHJldHVybiBvYmo7XG4gICAgfVxuXG4gICAgZnJlZSgpIHtcbiAgICAgICAgY29uc3QgcHRyID0gdGhpcy5wdHI7XG4gICAgICAgIHRoaXMucHRyID0gMDtcbiAgICAgICAgZnJlZUdlbmVyYXRvcihwdHIpO1xuICAgIH1cblxuICAgIC8qKlxuICAgICogQHJldHVybnMge0dlbmVyYXRvcn1cbiAgICAqL1xuICAgIHN0YXRpYyBuZXcoKSB7XG4gICAgICAgIHJldHVybiBHZW5lcmF0b3IuX193cmFwKHdhc20uZ2VuZXJhdG9yX25ldygpKTtcbiAgICB9XG4gICAgLyoqXG4gICAgKiBHZW5lcmF0ZXMgcmFuZG9tIG1hcCBib2FyZCB3aXRoIGdpdmVuIHdpZHRoIGFuZCBoZWlnaHQuIFBhcmFtZXRlcnMgYXJlIGluIG51bWJlciBvZiBjZWxscy5cbiAgICAqIEBwYXJhbSB7bnVtYmVyfSBhcmcwXG4gICAgKiBAcGFyYW0ge251bWJlcn0gYXJnMVxuICAgICogQHJldHVybnMge0JvYXJkfVxuICAgICovXG4gICAgZ2VuX2F1dG8oYXJnMCwgYXJnMSkge1xuICAgICAgICByZXR1cm4gQm9hcmQuX193cmFwKHdhc20uZ2VuZXJhdG9yX2dlbl9hdXRvKHRoaXMucHRyLCBhcmcwLCBhcmcxKSk7XG4gICAgfVxuICAgIC8qKlxuICAgICogR2VuZXJhdGVzIHJhbmRvbSBtYXAgYm9hcmQgd2l0aCBnaXZlbiByZXNvbHV0aW9uLCB3aWR0aCBhbmQgaGVpZ2h0LiBXaWR0aCBhbmQgaGVpZ2h0IGFyZVxuICAgICogaW4gbnVtYmVyIG9mIGNlbGxzLlxuICAgICogQHBhcmFtIHtudW1iZXJ9IGFyZzBcbiAgICAqIEBwYXJhbSB7bnVtYmVyfSBhcmcxXG4gICAgKiBAcGFyYW0ge251bWJlcn0gYXJnMlxuICAgICogQHJldHVybnMge0JvYXJkfVxuICAgICovXG4gICAgZ2VuKGFyZzAsIGFyZzEsIGFyZzIpIHtcbiAgICAgICAgcmV0dXJuIEJvYXJkLl9fd3JhcCh3YXNtLmdlbmVyYXRvcl9nZW4odGhpcy5wdHIsIGFyZzAsIGFyZzEsIGFyZzIpKTtcbiAgICB9XG59XG5cbmZ1bmN0aW9uIGZyZWVCb2FyZChwdHIpIHtcblxuICAgIHdhc20uX193YmdfYm9hcmRfZnJlZShwdHIpO1xufVxuLyoqXG4qIFJlcHJlc2VudHMgb25lIGJvYXJkIGdlbmVyYXRlZCBieSByYW5kb20gbWFwIGdlbmVyYXRvci5cbiovXG5leHBvcnQgY2xhc3MgQm9hcmQge1xuXG4gICAgc3RhdGljIF9fd3JhcChwdHIpIHtcbiAgICAgICAgY29uc3Qgb2JqID0gT2JqZWN0LmNyZWF0ZShCb2FyZC5wcm90b3R5cGUpO1xuICAgICAgICBvYmoucHRyID0gcHRyO1xuXG4gICAgICAgIHJldHVybiBvYmo7XG4gICAgfVxuXG4gICAgZnJlZSgpIHtcbiAgICAgICAgY29uc3QgcHRyID0gdGhpcy5wdHI7XG4gICAgICAgIHRoaXMucHRyID0gMDtcbiAgICAgICAgZnJlZUJvYXJkKHB0cik7XG4gICAgfVxuXG4gICAgLyoqXG4gICAgKiBAcmV0dXJucyB7bnVtYmVyfVxuICAgICovXG4gICAgZ2V0IHdpZHRoKCkge1xuICAgICAgICByZXR1cm4gd2FzbS5fX3diZ19nZXRfYm9hcmRfd2lkdGgodGhpcy5wdHIpO1xuICAgIH1cbiAgICBzZXQgd2lkdGgoYXJnMCkge1xuICAgICAgICByZXR1cm4gd2FzbS5fX3diZ19zZXRfYm9hcmRfd2lkdGgodGhpcy5wdHIsIGFyZzApO1xuICAgIH1cbiAgICAvKipcbiAgICAqIEByZXR1cm5zIHtudW1iZXJ9XG4gICAgKi9cbiAgICBnZXQgaGVpZ2h0KCkge1xuICAgICAgICByZXR1cm4gd2FzbS5fX3diZ19nZXRfYm9hcmRfaGVpZ2h0KHRoaXMucHRyKTtcbiAgICB9XG4gICAgc2V0IGhlaWdodChhcmcwKSB7XG4gICAgICAgIHJldHVybiB3YXNtLl9fd2JnX3NldF9ib2FyZF9oZWlnaHQodGhpcy5wdHIsIGFyZzApO1xuICAgIH1cbiAgICAvKipcbiAgICAqIFJldHVybnMgY2VsbCBhdCBwb3NpdGlvbiAoeCwgeSkuXG4gICAgKiBAcGFyYW0ge251bWJlcn0gYXJnMFxuICAgICogQHBhcmFtIHtudW1iZXJ9IGFyZzFcbiAgICAqIEByZXR1cm5zIHtDZWxsfVxuICAgICovXG4gICAgYXQoYXJnMCwgYXJnMSkge1xuICAgICAgICByZXR1cm4gQ2VsbC5fX3dyYXAod2FzbS5ib2FyZF9hdCh0aGlzLnB0ciwgYXJnMCwgYXJnMSkpO1xuICAgIH1cbiAgICAvKipcbiAgICAqIFJldHVybnMgY29sb3IgY29kZSBvZiBsYW5kIGFzIGAjcnJnZ2JiYCBmb3JtYXQgc3RyaW5nIGZyb20gbGFuZCBraW5kLlxuICAgICogQHBhcmFtIHtudW1iZXJ9IGFyZzBcbiAgICAqIEByZXR1cm5zIHtzdHJpbmd9XG4gICAgKi9cbiAgICBsYW5kX2NvbG9yX2NvZGUoYXJnMCkge1xuICAgICAgICBjb25zdCByZXRwdHIgPSBnbG9iYWxBcmd1bWVudFB0cigpO1xuICAgICAgICB3YXNtLmJvYXJkX2xhbmRfY29sb3JfY29kZShyZXRwdHIsIHRoaXMucHRyLCBhcmcwKTtcbiAgICAgICAgY29uc3QgbWVtID0gZ2V0VWludDMyTWVtb3J5KCk7XG4gICAgICAgIGNvbnN0IHJ1c3RwdHIgPSBtZW1bcmV0cHRyIC8gNF07XG4gICAgICAgIGNvbnN0IHJ1c3RsZW4gPSBtZW1bcmV0cHRyIC8gNCArIDFdO1xuXG4gICAgICAgIGNvbnN0IHJlYWxSZXQgPSBnZXRTdHJpbmdGcm9tV2FzbShydXN0cHRyLCBydXN0bGVuKS5zbGljZSgpO1xuICAgICAgICB3YXNtLl9fd2JpbmRnZW5fZnJlZShydXN0cHRyLCBydXN0bGVuICogMSk7XG4gICAgICAgIHJldHVybiByZWFsUmV0O1xuXG4gICAgfVxuICAgIC8qKlxuICAgICogUmV0dXJucyBSR0IgY29sb3IgYXMgdTMyLiAwfjggYml0cyBmb3IgQiwgOX4xNiBiaXRzIGZvciBHLCAxN34yNCBiaXRzIGZvciBSLlxuICAgICogV2hlbiBubyBjb2xvciBpcyBzZXQsIHJldHVybnMgYE5vbmVgLiBJdCBtZWFucyBgdW5kZWZpbmVkYCBpbiBKYXZhU2NyaXB0IHNpZGUuXG4gICAgKiBAcGFyYW0ge251bWJlcn0gYXJnMFxuICAgICogQHJldHVybnMge251bWJlciB8IHVuZGVmaW5lZH1cbiAgICAqL1xuICAgIGxhbmRfcmdiX2NvbG9yKGFyZzApIHtcbiAgICAgICAgY29uc3QgcmV0cHRyID0gZ2xvYmFsQXJndW1lbnRQdHIoKTtcblxuICAgICAgICB3YXNtLmJvYXJkX2xhbmRfcmdiX2NvbG9yKHJldHB0ciwgdGhpcy5wdHIsIGFyZzApO1xuICAgICAgICBjb25zdCBwcmVzZW50ID0gZ2V0VWludDMyTWVtb3J5KClbcmV0cHRyIC8gNF07XG4gICAgICAgIGNvbnN0IHZhbHVlID0gZ2V0VWludDMyTWVtb3J5KClbcmV0cHRyIC8gNCArIDFdO1xuICAgICAgICByZXR1cm4gcHJlc2VudCA9PT0gMCA/IHVuZGVmaW5lZCA6IHZhbHVlO1xuXG4gICAgfVxuICAgIC8qKlxuICAgICogUmV0dXJucyBsZWdlbmQgb2YgbGFuZCBhcyBzdHJpbmcgZnJvbSBsYW5kIGtpbmQuXG4gICAgKiBAcGFyYW0ge251bWJlcn0gYXJnMFxuICAgICogQHJldHVybnMge3N0cmluZ31cbiAgICAqL1xuICAgIGxhbmRfbGVnZW5kKGFyZzApIHtcbiAgICAgICAgY29uc3QgcmV0cHRyID0gZ2xvYmFsQXJndW1lbnRQdHIoKTtcbiAgICAgICAgd2FzbS5ib2FyZF9sYW5kX2xlZ2VuZChyZXRwdHIsIHRoaXMucHRyLCBhcmcwKTtcbiAgICAgICAgY29uc3QgbWVtID0gZ2V0VWludDMyTWVtb3J5KCk7XG4gICAgICAgIGNvbnN0IHJ1c3RwdHIgPSBtZW1bcmV0cHRyIC8gNF07XG4gICAgICAgIGNvbnN0IHJ1c3RsZW4gPSBtZW1bcmV0cHRyIC8gNCArIDFdO1xuXG4gICAgICAgIGNvbnN0IHJlYWxSZXQgPSBnZXRTdHJpbmdGcm9tV2FzbShydXN0cHRyLCBydXN0bGVuKS5zbGljZSgpO1xuICAgICAgICB3YXNtLl9fd2JpbmRnZW5fZnJlZShydXN0cHRyLCBydXN0bGVuICogMSk7XG4gICAgICAgIHJldHVybiByZWFsUmV0O1xuXG4gICAgfVxufVxuXG5leHBvcnQgZnVuY3Rpb24gX193YmluZGdlbl90aHJvdyhwdHIsIGxlbikge1xuICAgIHRocm93IG5ldyBFcnJvcihnZXRTdHJpbmdGcm9tV2FzbShwdHIsIGxlbikpO1xufVxuXG4iLCJmdW5jdGlvbiB3ZWJwYWNrRW1wdHlDb250ZXh0KHJlcSkge1xuXHR2YXIgZSA9IG5ldyBFcnJvcihcIkNhbm5vdCBmaW5kIG1vZHVsZSAnXCIgKyByZXEgKyBcIidcIik7XG5cdGUuY29kZSA9ICdNT0RVTEVfTk9UX0ZPVU5EJztcblx0dGhyb3cgZTtcbn1cbndlYnBhY2tFbXB0eUNvbnRleHQua2V5cyA9IGZ1bmN0aW9uKCkgeyByZXR1cm4gW107IH07XG53ZWJwYWNrRW1wdHlDb250ZXh0LnJlc29sdmUgPSB3ZWJwYWNrRW1wdHlDb250ZXh0O1xubW9kdWxlLmV4cG9ydHMgPSB3ZWJwYWNrRW1wdHlDb250ZXh0O1xud2VicGFja0VtcHR5Q29udGV4dC5pZCA9IDQ0OyJdLCJzb3VyY2VSb290IjoiIn0=